<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-diy.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-diy.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-diy.png"><link rel="mask-icon" href="/images/logo-diy.svg" color="#222"><meta name="baidu-site-verification" content="y1cfESbTt9nd3LsA"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/lib/pace/pace-theme-flash.min.css"><script src="/lib/pace/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"githubwyb.github.io",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!0,color:"#ff0000",save:"auto"},fancybox:!1,mediumzoom:!0,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="一、语法相关1. 进制数字表示12# 二进制转十进制输出，其他同理echo $((2#100100))  2. 目录特殊符号 上一级 .. 当前目录 . 当前用户目录 ~ 根目录 &#x2F;  3. 常用语法详解3.1. &lt;&gt; 输入出重定向123456789101112131415161718192021ls .&#x2F; &gt;a.text           # 正确输出到a.txt(覆盖)ls"><meta property="og:type" content="article"><meta property="og:title" content="shell学习笔记"><meta property="og:url" content="https://githubwyb.github.io/blogs/2018-09-16-shellStudy/index.html"><meta property="og:site_name" content="技术的路上奔跑"><meta property="og:description" content="一、语法相关1. 进制数字表示12# 二进制转十进制输出，其他同理echo $((2#100100))  2. 目录特殊符号 上一级 .. 当前目录 . 当前用户目录 ~ 根目录 &#x2F;  3. 常用语法详解3.1. &lt;&gt; 输入出重定向123456789101112131415161718192021ls .&#x2F; &gt;a.text           # 正确输出到a.txt(覆盖)ls"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2018-09-16T05:23:55.000Z"><meta property="article:modified_time" content="2024-01-09T08:05:44.000Z"><meta property="article:author" content="王钰博"><meta property="article:tag" content="Linux"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://githubwyb.github.io/blogs/2018-09-16-shellStudy/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>shell学习笔记 | 技术的路上奔跑</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">技术的路上奔跑</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">入门</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-fw fa-sitemap"></i>站点地图</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a> <a href="https://github.com/Githubwyb" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://githubwyb.github.io/blogs/2018-09-16-shellStudy/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/12.jpg"><meta itemprop="name" content="王钰博"><meta itemprop="description" content="个人博客"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="技术的路上奔跑"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">shell学习笔记</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2018-09-16 13:23:55" itemprop="dateCreated datePublished" datetime="2018-09-16T13:23:55+08:00">2018-09-16</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2024-01-09 16:05:44" itemprop="dateModified" datetime="2024-01-09T16:05:44+08:00">2024-01-09</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Program/" itemprop="url" rel="index"><span itemprop="name">Program</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Program/Shell/" itemprop="url" rel="index"><span itemprop="name">Shell</span></a> </span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span id="busuanzi_value_page_pv"></span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><span class="post-meta-item-text">Valine：</span> <a title="valine" href="/blogs/2018-09-16-shellStudy/#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/blogs/2018-09-16-shellStudy/" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>47k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>43 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="一、语法相关"><a href="#一、语法相关" class="headerlink" title="一、语法相关"></a>一、语法相关</h1><h2 id="1-进制数字表示"><a href="#1-进制数字表示" class="headerlink" title="1. 进制数字表示"></a>1. 进制数字表示</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">二进制转十进制输出，其他同理</span></span><br><span class="line">echo $((2#100100))</span><br></pre></td></tr></table></figure><h2 id="2-目录特殊符号"><a href="#2-目录特殊符号" class="headerlink" title="2. 目录特殊符号"></a>2. 目录特殊符号</h2><ul><li>上一级 <code>..</code></li><li>当前目录 <code>.</code></li><li>当前用户目录 <code>~</code></li><li>根目录 <code>/</code></li></ul><h2 id="3-常用语法详解"><a href="#3-常用语法详解" class="headerlink" title="3. 常用语法详解"></a>3. 常用语法详解</h2><h3 id="3-1-输入出重定向"><a href="#3-1-输入出重定向" class="headerlink" title="3.1. &lt;&gt; 输入出重定向"></a>3.1. <code>&lt;&gt;</code> 输入出重定向</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">ls ./ &gt;a.text           # 正确输出到a.txt(覆盖)</span><br><span class="line">ls ./ 1&gt;a.text          # 正确输出到a.txt(覆盖)</span><br><span class="line">ls ./ 2&gt;a.txt           # 错误输出到a.txt(覆盖)</span><br><span class="line">ls ./ 2&gt;a.txt           # 错误输出到a.txt(覆盖)</span><br><span class="line">ls ./ &gt;a.txt 2&gt;&amp;1       # 标准输出和标准错误输出到a.txt(覆盖)</span><br><span class="line">ls ./ &amp;&gt;a.txt           # 标准输出和标准错误输出到a.txt(覆盖)</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">追加使用&gt;&gt;</span></span><br><span class="line">ls ./ &gt;&gt;a.text          # 正确输出到a.txt(追加)</span><br><span class="line"></span><br><span class="line">ls ./ 2&gt;&amp;1              # 错误输出到标准输出</span><br><span class="line"></span><br><span class="line">echo &quot;test&quot; &gt;&amp;2         # 将字符串输出到stderr</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">&lt; 将文件内容作为标准输入</span></span><br><span class="line">while read -r line; do</span><br><span class="line">    echo &quot;$line&quot;</span><br><span class="line">done &lt; test.txt</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">&lt;&lt;&lt;的含义，相当于管道，把字符串当作标准输入传给命令</span></span><br><span class="line">echo &quot;$a&quot; | grep &quot;xxx&quot;</span><br><span class="line">grep &quot;xxx&quot; &lt;&lt;&lt; &quot;$a&quot;</span><br></pre></td></tr></table></figure><h3 id="3-2-意义"><a href="#3-2-意义" class="headerlink" title="3.2. $ 意义"></a>3.2. $ 意义</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">$</span><span class="language-bash">$      <span class="comment"># Shell本身的PID（ProcessID）</span></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">!      <span class="comment"># Shell最后运行的后台Process的PID</span></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">UID    <span class="comment"># 当前用户的id</span></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">PPID   <span class="comment"># 父进程id</span></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">?      <span class="comment"># 最后运行的命令的结束代码（返回值）</span></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">-      <span class="comment"># 使用Set命令设定的Flag一览</span></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">*      <span class="comment"># 所有参数列表。如*所有参数列表。如&quot;*“用「”」括起来的情况、以&quot;$1 $2 … $n&quot;的形式输出所有参数。</span></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">@      <span class="comment"># 所有参数列表。如@所有参数列表。如&quot;@“用「”」括起来的情况、以&quot;$1 $2 … $n&quot; 的形式输出所有参数。</span></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash"><span class="comment">#      # 添加到Shell的参数个数</span></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">0      <span class="comment"># Shell本身的文件名</span></span></span><br><span class="line"><span class="meta prompt_">$</span><span class="language-bash">1～n   <span class="comment"># 添加到Shell的各参数值。$1是第1参数、$2是第2参数…</span></span></span><br></pre></td></tr></table></figure><h3 id="3-3-cd-跳转目录命令"><a href="#3-3-cd-跳转目录命令" class="headerlink" title="3.3. cd 跳转目录命令"></a>3.3. cd 跳转目录命令</h3><p><strong>特殊跳转</strong></p><ul><li>跳转上一级 <code>..</code></li><li>跳转当前目录 <code>.</code></li><li>跳转当前用户目录 <code>~</code></li><li>跳转根目录 <code>/</code></li><li>跳转上一个目录 <code>cd -</code></li><li>跳转前n目录 <code>cd -n</code></li><li>跳转后n目录 <code>cd +n</code></li></ul><h3 id="3-4-if-条件判断"><a href="#3-4-if-条件判断" class="headerlink" title="3.4. if 条件判断"></a>3.4. if 条件判断</h3><p><strong>文件表达式</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">if [ -e file ]      # 如果文件或者目录存在，不管有没有权限</span><br><span class="line">if [ -f file ]      # 如果文件是普通文件，不是目录或者设备文件</span><br><span class="line">if [ -b file ]      # 如果文件是块设备文件</span><br><span class="line">if [ -c file ]      # 如果文件是字符设备文件</span><br><span class="line">if [ -L file ]      # 如果文件是符号文件</span><br><span class="line">if [ -d ...  ]      # 如果目录存在</span><br><span class="line">if [ -s file ]      # 如果文件存在且非空</span><br><span class="line">if [ -r file ]      # 如果文件存在且可读</span><br><span class="line">if [ -w file ]      # 如果文件存在且可写</span><br><span class="line">if [ -x file ]      # 如果文件存在且可执行</span><br></pre></td></tr></table></figure><p><strong>整数变量表达式</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if [ int1 -eq int2 ]        # 如果int1等于int2</span><br><span class="line">if [ int1 -ne int2 ]        # 如果不等于</span><br><span class="line">if [ int1 -ge int2 ]        # 如果&gt;=</span><br><span class="line">if [ int1 -gt int2 ]        # 如果&gt;</span><br><span class="line">if [ int1 -le int2 ]        # 如果&lt;=</span><br><span class="line">if [ int1 -lt int2 ]        # 如果&lt;</span><br></pre></td></tr></table></figure><p><strong>字符串变量表达式</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">if  [ $a = $b ]                     # 如果string1等于string2</span><br><span class="line">                                    # 字符串允许使用赋值号做等号</span><br><span class="line">if  [ $string1 != $string2 ]        # 如果string1不等于string2</span><br><span class="line">if  [ -n $string ]                  # 如果string 非空(非0），返回0(true)</span><br><span class="line">if  [ -z $string ]                  # 如果string 为空</span><br><span class="line">if  [ $sting ]                      # 如果string 非空，返回0 (和-n类似)</span><br></pre></td></tr></table></figure><h3 id="3-5-for-循环"><a href="#3-5-for-循环" class="headerlink" title="3.5. for 循环"></a>3.5. for 循环</h3><h4 id="1-文件遍历"><a href="#1-文件遍历" class="headerlink" title="(1) 文件遍历"></a>(1) 文件遍历</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">此行代表以换行符为分割，默认为空格、\t和\n</span></span><br><span class="line">IFS=$&#x27;\n&#x27;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将test.txt的内容按行分割到value输出</span></span><br><span class="line">for value in $(cat test.txt)</span><br><span class="line">do</span><br><span class="line">    echo &quot;$value&quot;</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h4 id="2-index递增形式"><a href="#2-index递增形式" class="headerlink" title="(2) index递增形式"></a>(2) index递增形式</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for ((i=0;i&lt;2;i++)); do</span><br><span class="line">    echo &quot;$i&quot;</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h3 id="3-6-while-循环"><a href="#3-6-while-循环" class="headerlink" title="3.6. while 循环"></a>3.6. while 循环</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">按行读取文件内容</span></span><br><span class="line">while IFS= read -r value</span><br><span class="line">do</span><br><span class="line">    echo &quot;$value&quot;</span><br><span class="line">done &lt; &quot;test.txt&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">按行读取变量内容</span></span><br><span class="line">while IFS= read -r value</span><br><span class="line">do</span><br><span class="line">    echo &quot;$value&quot;</span><br><span class="line">done &lt;&lt;&lt; &quot;$test&quot;</span><br></pre></td></tr></table></figure><h3 id="3-7-switch-语句"><a href="#3-7-switch-语句" class="headerlink" title="3.7. switch 语句"></a>3.7. switch 语句</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">case &quot;$1&quot; in</span><br><span class="line">start)</span><br><span class="line">    check_start &quot;$@&quot;</span><br><span class="line">    ;;</span><br><span class="line">stop)</span><br><span class="line">    check_stop &quot;$@&quot;</span><br><span class="line">    ;;</span><br><span class="line">check)</span><br><span class="line">    check_service &quot;$@&quot;</span><br><span class="line">    ;;</span><br><span class="line">*)</span><br><span class="line">    echo &quot;Usage: check_handle_service.sh start|stop|check [service]&quot;</span><br><span class="line">    exit 1</span><br><span class="line">    ;;</span><br><span class="line">esac</span><br></pre></td></tr></table></figure><h2 id="4-函数调用"><a href="#4-函数调用" class="headerlink" title="4. 函数调用"></a>4. 函数调用</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">abc() &#123;</span><br><span class="line">    # ...</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">abc</span><br></pre></td></tr></table></figure><p>函数调用不加括号</p><h2 id="5-字符串操作"><a href="#5-字符串操作" class="headerlink" title="5. 字符串操作"></a>5. 字符串操作</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">string=&quot;12348213&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">字符串长度</span></span><br><span class="line">echo $&#123;#string&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">字符串最后一个字符，注意中间有一个空格</span></span><br><span class="line">echo &quot;$&#123;string: -1&#125;&quot;</span><br></pre></td></tr></table></figure><h3 id="5-1-字符串替换"><a href="#5-1-字符串替换" class="headerlink" title="5.1. 字符串替换"></a>5.1. 字符串替换</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo $&#123;string/23/bb&#125;   # 替换一次</span><br><span class="line">echo $&#123;string//23/bb&#125;  # 双斜杠替换所有匹配</span><br></pre></td></tr></table></figure><h3 id="5-2-字符串截取"><a href="#5-2-字符串截取" class="headerlink" title="5.2. 字符串截取"></a>5.2. 字符串截取</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">删除最后一个/及前面所有。作用是删除路径，只留文件名</span></span><br><span class="line">echo $&#123;string##*/&#125;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">删除最后一个/及后面所有。作用是删除文件名，只留路径名</span></span><br><span class="line">echo $&#123;string%/*&#125;</span><br></pre></td></tr></table></figure><ul><li>#:表示从左开始算起，并且截取第一个匹配的字符</li><li>##:表示从左开始算起，并且截取最后一个匹配的字符</li><li>%:表示从右开始算起，并且截取第一个匹配的字符</li><li>%%:表示从右开始算起，并且截取最后一个匹配的字符</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">截取给定一段，m开始截取n个</span></span><br><span class="line">echo &quot;$&#123;str:m:n&#125;&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">截取给定一段，m开始到结尾</span></span><br><span class="line">echo &quot;$&#123;str:m&#125;&quot;</span><br></pre></td></tr></table></figure><h3 id="5-3-字符串遍历"><a href="#5-3-字符串遍历" class="headerlink" title="5.3. 字符串遍历"></a>5.3. 字符串遍历</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">string=&quot;abc</span><br><span class="line">b c     d&quot;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这样会根据空格、换行和制表符分开</span></span><br><span class="line">for item in $string; do</span><br><span class="line">    echo &quot;s $item e&quot;</span><br><span class="line">done</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">加了引号会认为整个字符串为一个</span></span><br><span class="line">for item in &quot;$string&quot;; do</span><br><span class="line">    echo &quot;s $item e&quot;</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h2 id="6-数组"><a href="#6-数组" class="headerlink" title="6. 数组"></a>6. 数组</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">数组声明</span></span><br><span class="line">test_arr=(</span><br><span class="line">    &quot;abc&quot;</span><br><span class="line">    &quot;dce&quot;</span><br><span class="line">)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">数组长度，bash 5.0不用加[@]，但是4.2就需要</span></span><br><span class="line">len=&quot;$&#123;#test_arr[@]&#125;&quot;</span><br></pre></td></tr></table></figure><h3 id="6-1-数组遍历"><a href="#6-1-数组遍历" class="headerlink" title="6.1. 数组遍历"></a>6.1. 数组遍历</h3><p>数组遍历分为几种形式</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">service_list=(</span><br><span class="line">    &quot;abc&quot;</span><br><span class="line">    &quot;ddd&quot;</span><br><span class="line">    &quot;dd d&quot;</span><br><span class="line">)</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="keyword">for</span> <span class="keyword">in</span> 形式，在脚本中，不加双引号，第三个元素会拆分成两个元素</span></span><br><span class="line">for sv in &quot;$&#123;service_list[@]&#125;&quot;; do</span><br><span class="line">    echo &quot;$sv&quot;</span><br><span class="line">done</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">i遍历的形式</span></span><br><span class="line">len=&quot;$&#123;#service_list[@]&#125;&quot;</span><br><span class="line">for ((i=0;i&lt;&quot;$len&quot;;i++)); do</span><br><span class="line">    echo &quot;a $&#123;service_list[i]&#125; b&quot;</span><br><span class="line">done</span><br></pre></td></tr></table></figure><ul><li>低版本shell中，local不能修饰数组</li></ul><h3 id="6-2-数组拷贝"><a href="#6-2-数组拷贝" class="headerlink" title="6.2. 数组拷贝"></a>6.2. 数组拷贝</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">service_list=(</span><br><span class="line">    &quot;abc&quot;</span><br><span class="line">    &quot;ddd&quot;</span><br><span class="line">    &quot;dd d&quot;</span><br><span class="line">)</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这样拿到的是原数组</span></span><br><span class="line">arr_cp=(&quot;$&#123;service_list[@]&#125;&quot;)</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这样拿到的是数组转字符串再次根据空格、换行和制表符再次分割的数组</span></span><br><span class="line">arr1_cp=(&#123;service_list[@]&#125;)</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这样拿到的是个字符串</span></span><br><span class="line">arr2_cp=&quot;$&#123;service_list[@]&#125;&quot;</span><br></pre></td></tr></table></figure><h2 id="7-eval"><a href="#7-eval" class="headerlink" title="7. eval"></a>7. eval</h2><ul><li>eval是将字符串转成命令执行</li><li>可用于在脚本中将字符串转成变量名执行</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">service_list=(</span><br><span class="line">    &quot;abc&quot;</span><br><span class="line">    &quot;ddd&quot;</span><br><span class="line">    &quot;dd d&quot;</span><br><span class="line">)</span><br><span class="line"></span><br><span class="line">str=&quot;service_list&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下面这句话将转成 <span class="built_in">test</span>=(<span class="string">&quot;<span class="variable">$&#123;service_list[@]&#125;</span>&quot;</span>) 执行，即拷贝数组</span></span><br><span class="line">eval &quot;test=(\&quot;\$&#123;$&#123;str&#125;[@]&#125;\&quot;)&quot;</span><br><span class="line"></span><br><span class="line">for item in &quot;$&#123;test[@]&#125;&quot;; do</span><br><span class="line">    echo &quot;s $item e&quot;</span><br><span class="line">done</span><br></pre></td></tr></table></figure><h2 id="8-bash和source、-的区别"><a href="#8-bash和source、-的区别" class="headerlink" title="8. bash和source、.的区别"></a>8. bash和source、<code>.</code>的区别</h2><ul><li>source和<code>.</code>是一样的</li><li>三者都可以不需要文件有可执行权限</li><li>bash类似于fork了一个子进程，内部变量和父进程没关系，但是父进程会等待子进程结果</li><li>source和<code>.</code>更像直接把文件内容拷贝到位置上执行，主要用于导入变量和函数</li></ul><h2 id="9-算术表达式"><a href="#9-算术表达式" class="headerlink" title="9. 算术表达式"></a>9. 算术表达式</h2><h3 id="9-1-i-表示"><a href="#9-1-i-表示" class="headerlink" title="9.1. i++表示"></a>9.1. i++表示</h3><h4 id="1-使用let表示"><a href="#1-使用let表示" class="headerlink" title="(1) 使用let表示"></a>(1) 使用let表示</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">i=0</span><br><span class="line"></span><br><span class="line">let i+=1</span><br><span class="line">let &#x27;i+=1&#x27;</span><br></pre></td></tr></table></figure><h4 id="2-用-，这种用法常见于for循环中"><a href="#2-用-，这种用法常见于for循环中" class="headerlink" title="(2) 用(())，这种用法常见于for循环中"></a>(2) 用<code>(())</code>，这种用法常见于for循环中</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">((i++))</span><br></pre></td></tr></table></figure><h4 id="3-用expr"><a href="#3-用expr" class="headerlink" title="(3) 用expr"></a>(3) 用expr</h4><ul><li>中间要有空格，否则就成字符串拼接了</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">i=0</span><br><span class="line">i=`expr $i + 1`</span><br><span class="line">echo &quot;$i&quot;       # 1</span><br><span class="line">i=`expr $i+1`</span><br><span class="line">echo &quot;$i&quot;       # 1+1</span><br></pre></td></tr></table></figure><h4 id="4-用如下模式"><a href="#4-用如下模式" class="headerlink" title="(4) 用如下模式"></a>(4) 用如下模式</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">i=$[$i+1];      # 分号不能少</span><br><span class="line">i=$(($i+1))     # 中间可以加空格</span><br></pre></td></tr></table></figure><h1 id="二、系统命令详解"><a href="#二、系统命令详解" class="headerlink" title="二、系统命令详解"></a>二、系统命令详解</h1><h2 id="1-find-文件查找"><a href="#1-find-文件查找" class="headerlink" title="1. find 文件查找"></a>1. find 文件查找</h2><h3 id="1-1-选项"><a href="#1-1-选项" class="headerlink" title="1.1. 选项"></a>1.1. 选项</h3><ul><li><code>-type</code>: 类型，d为文件夹，f为文件</li><li><code>-name</code>: 文件名称，支持<code>*</code></li><li><code>-atime</code>: 访问时间，后跟参数，查看示例</li><li><code>-mtime</code>: 修改时间，后跟参数，查看示例</li><li><code>-ctime</code>: 元数据修改时间，后跟参数，查看示例</li></ul><h3 id="1-2-实例"><a href="#1-2-实例" class="headerlink" title="1.2. 实例"></a>1.2. 实例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查找当前目录下文件类型的，修改时间在0.5天以内的文件</span></span><br><span class="line">find ./ -type f -mtime -0.5</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查找当前目录下文件类型的所有php文件</span></span><br><span class="line">find ./ -type f -name &quot;*.php&quot;</span><br></pre></td></tr></table></figure><h3 id="1-3-统计代码行数"><a href="#1-3-统计代码行数" class="headerlink" title="1.3. 统计代码行数"></a>1.3. 统计代码行数</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">统计所有go文件，排除单测文件的代码行数，去除空行</span></span><br><span class="line">=&gt; find /path/to/xxx -type f \( -name &quot;*.go&quot; -a -not -name &quot;*_test.go&quot; \) -exec grep -v &#x27;^$&#x27; &#123;&#125; \; | wc -l</span><br><span class="line">1374</span><br><span class="line">=&gt; find /path/to/xxx -type f \( -name &quot;*.go&quot; -a -not -name &quot;*_test.go&quot; \)</span><br><span class="line">/path/to/xxx/aaa.go</span><br><span class="line">/path/to/xxx/bbb.go</span><br><span class="line">/path/to/xxx/ccc.go</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">统计所有单测文件的代码行数，去除空行</span></span><br><span class="line">=&gt; find /path/to/xxx -type f \( -name &quot;*_test.go&quot; \) -exec grep -v &#x27;^$&#x27; &#123;&#125; \; | wc -l</span><br><span class="line">1795</span><br></pre></td></tr></table></figure><h2 id="2-file"><a href="#2-file" class="headerlink" title="2. file"></a>2. file</h2><h3 id="2-1-实例"><a href="#2-1-实例" class="headerlink" title="2.1. 实例"></a>2.1. 实例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看文件类型，不显示文件名</span></span><br><span class="line">=&gt; file -b test.txt</span><br><span class="line">ASCII text</span><br></pre></td></tr></table></figure><h2 id="3-tr"><a href="#3-tr" class="headerlink" title="3. tr"></a>3. tr</h2><h3 id="3-1-实例"><a href="#3-1-实例" class="headerlink" title="3.1. 实例"></a>3.1. 实例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">大小写转化</span></span><br><span class="line">echo &quot;HELLO&quot; | tr &#x27;[:upper:]&#x27; &#x27;[:lower:]&#x27;</span><br><span class="line">echo &quot;hello&quot; | tr &#x27;[:lower:]&#x27; &#x27;[:upper:]&#x27;</span><br></pre></td></tr></table></figure><h2 id="4-watch"><a href="#4-watch" class="headerlink" title="4. watch"></a>4. watch</h2><p>watch命令以周期性的方式执行给定的指令，指令输出以全屏方式显示。watch是一个非常实用的命令，基本所有的Linux发行版都带有这个小工具，如同名字一样，watch可以帮你监测一个命令的运行结果，省得你一遍遍的手动运行。</p><h3 id="4-1-选项"><a href="#4-1-选项" class="headerlink" title="4.1. 选项"></a>4.1. 选项</h3><ul><li>-n：指定指令执行的间隔时间（秒）；</li><li>-d：高亮显示指令输出信息不同之处；</li><li>-t：不显示标题。</li></ul><h3 id="4-2-参数"><a href="#4-2-参数" class="headerlink" title="4.2. 参数"></a>4.2. 参数</h3><p>指令：需要周期性执行的指令。</p><h3 id="4-3-实例"><a href="#4-3-实例" class="headerlink" title="4.3. 实例"></a>4.3. 实例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">watch uptime</span><br><span class="line">watch -t uptime</span><br><span class="line">watch -d -n 1 netstat -ntlp</span><br><span class="line">watch -d &#x27;ls -l | fgrep goface&#x27;     //监测goface的文件</span><br><span class="line">watch -t -differences=cumulative uptime</span><br><span class="line">watch -n 60 from            //监控mail</span><br><span class="line">watch -n 1 &quot;df -i;df&quot;       //监测磁盘inode和block数目变化情况</span><br></pre></td></tr></table></figure><h2 id="5-tail-实时查看文件内容（可用于查看log文件）"><a href="#5-tail-实时查看文件内容（可用于查看log文件）" class="headerlink" title="5. tail 实时查看文件内容（可用于查看log文件）"></a>5. tail 实时查看文件内容（可用于查看log文件）</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tail -f (fileName)</span><br></pre></td></tr></table></figure><h3 id="5-1-tail显示高亮"><a href="#5-1-tail显示高亮" class="headerlink" title="5.1. tail显示高亮"></a>5.1. tail显示高亮</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">tail -f sys.log | perl -pe &#x27;s/(关键词1)|(关键词2)|(关键词3)/\e[1;颜色1$1\e[0m\e[1;颜色2$2\e[0m\e[1;颜色3$3\e[0m/g&#x27;</span><br></pre></td></tr></table></figure><p><strong>两个示例</strong></p><ul><li>黄字，高亮加粗显示 <code>[1;33m</code></li><li>红底黄字，高亮加粗显示 <code>[1;41;33m</code></li></ul><p><strong>效果配置列举</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">前景色</span><br><span class="line">30m：黑</span><br><span class="line">31m：红</span><br><span class="line">32m：绿</span><br><span class="line">33m：黄</span><br><span class="line">34m：蓝</span><br><span class="line">35m：紫</span><br><span class="line">36m：青</span><br><span class="line">37m：白</span><br><span class="line"></span><br><span class="line">背景色</span><br><span class="line">40：黑</span><br><span class="line">41：红</span><br><span class="line">42：绿</span><br><span class="line">43：黄</span><br><span class="line">44：蓝</span><br><span class="line">45：紫</span><br><span class="line">46：青</span><br><span class="line">47：白</span><br><span class="line"></span><br><span class="line">动效设置</span><br><span class="line">[1; 设置高亮加粗</span><br><span class="line">[4; 下划线</span><br><span class="line">[5; 闪烁</span><br></pre></td></tr></table></figure><h2 id="6-sort-排序"><a href="#6-sort-排序" class="headerlink" title="6. sort 排序"></a>6. sort 排序</h2><h3 id="6-1-选项解释"><a href="#6-1-选项解释" class="headerlink" title="6.1. 选项解释"></a>6.1. 选项解释</h3><ul><li><code>-u</code>: 排序后去重</li><li><code>-V</code>: 版本号类型排序，如<code>2.1.10</code></li><li><code>-n</code>: 数字排序而非字典序</li></ul><h3 id="6-2-一些基本操作"><a href="#6-2-一些基本操作" class="headerlink" title="6.2. 一些基本操作"></a>6.2. 一些基本操作</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将test.txt中排序并去重，但是只输出到控制台，可以用&gt;写到文件</span></span><br><span class="line">cat test.txt | sort -u</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="built_in">sort</span> -V 可以排序版本号类型，如判断 2.1.9和2.1.10</span></span><br><span class="line">xxx | sort -V</span><br></pre></td></tr></table></figure><h2 id="7-grep-查找内容"><a href="#7-grep-查找内容" class="headerlink" title="7. grep 查找内容"></a>7. grep 查找内容</h2><ul><li><code>-r</code>: 遍历子目录</li><li><code>-n</code>: 遍历行数</li><li><code>-i</code>: 大小写无关</li><li><code>-v</code>: 排除</li><li><code>-E</code>: 衍生为正则表达式（用|代表或等）</li><li><code>-o</code>: 正则只输出PATTERN部分</li><li><code>-c</code>: 统计行数</li><li><code>--include=&quot;*.c&quot;</code>: 包含某个后缀的文件，可以多次设置<code>--include</code></li></ul><h3 id="7-1-内容匹配"><a href="#7-1-内容匹配" class="headerlink" title="7.1. 内容匹配"></a>7.1. 内容匹配</h3><ul><li>查找字符串用<code>^</code>代表开头，用<code>$</code>代表结束，可以使用<code>^xxx$</code>进行全匹配</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">匹配ab开头的字符串</span></span><br><span class="line">grep &quot;^ab&quot; test.txt</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">匹配bc结束的字符串</span></span><br><span class="line">grep &quot;ab$&quot; test.txt</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">全匹配abc</span></span><br><span class="line">grep &quot;^abc$&quot; test.txt</span><br></pre></td></tr></table></figure><h3 id="7-2-查找进程排除grep"><a href="#7-2-查找进程排除grep" class="headerlink" title="7.2. 查找进程排除grep"></a>7.2. 查找进程排除grep</h3><ul><li>通常使用<code>ps + grep</code>查找进程，但是会多出一行当前查找的grep进程</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -aux | grep xxx | grep -v grep</span><br></pre></td></tr></table></figure><h3 id="7-3-查找包含内容的有几行"><a href="#7-3-查找包含内容的有几行" class="headerlink" title="7.3. 查找包含内容的有几行"></a>7.3. 查找包含内容的有几行</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">相当于 <span class="built_in">cat</span> test.txt | grep <span class="string">&quot;test&quot;</span> | <span class="built_in">wc</span> -l</span></span><br><span class="line">grep -c &quot;test&quot; test.txt</span><br></pre></td></tr></table></figure><h3 id="7-4-查找目录下所有文件匹配对应字符串"><a href="#7-4-查找目录下所有文件匹配对应字符串" class="headerlink" title="7.4. 查找目录下所有文件匹配对应字符串"></a>7.4. 查找目录下所有文件匹配对应字符串</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">grep -nr &quot;test&quot; ./</span><br></pre></td></tr></table></figure><h3 id="7-5-正则查找，只显示匹配段"><a href="#7-5-正则查找，只显示匹配段" class="headerlink" title="7.5. 正则查找，只显示匹配段"></a>7.5. 正则查找，只显示匹配段</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">显示 APPVERSION=abc 到|停止，即所有非|都匹配，匹配多个</span></span><br><span class="line">echo &quot;APPVERSION=abc|ddd&quot; | grep -o &quot;APPVERSION=[^|]*&quot;</span><br></pre></td></tr></table></figure><h2 id="8-wc-查看文件或者内容行数"><a href="#8-wc-查看文件或者内容行数" class="headerlink" title="8. wc 查看文件或者内容行数"></a>8. wc 查看文件或者内容行数</h2><ul><li>结合查找进程可以返回匹配的进程个数</li><li><font color="red"><code>wc -l</code>返回的是<code>\n</code>的个数，如果最后一行没有换行，将不会统计最后一行</font></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ps -aux | grep xxx | grep -v grep | wc -l</span><br></pre></td></tr></table></figure><h2 id="9-addr2line-根据地址定位代码位置"><a href="#9-addr2line-根据地址定位代码位置" class="headerlink" title="9. addr2line 根据地址定位代码位置"></a>9. addr2line 根据地址定位代码位置</h2><p>示例</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">=&gt; addr2line 0x2026 -e run -f</span><br><span class="line">main</span><br><span class="line">/xxxx/xxxx/xxxx/xxxx/main.cpp:39</span><br></pre></td></tr></table></figure><ul><li><code>-e</code>: 指定可执行文件</li><li><code>-f</code>: 显示函数名</li></ul><h3 id="9-1-注意事项"><a href="#9-1-注意事项" class="headerlink" title="9.1. 注意事项"></a>9.1. 注意事项</h3><ul><li>gcc编译需要添加<code>-g</code>参数</li><li>不加<code>-g</code>放到生产环境，加<code>-g</code>的用于找代码位置</li></ul><h2 id="10-date-时间工具"><a href="#10-date-时间工具" class="headerlink" title="10. date 时间工具"></a>10. date 时间工具</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 时间计算 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">时间戳转正常时间格式</span></span><br><span class="line">=&gt; date -d @1587536520</span><br><span class="line">2020年 04月 22日 星期三 14:22:00 CST</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">时间字符串转时间戳</span></span><br><span class="line">=&gt; date -d &quot;20200422&quot; +%s</span><br><span class="line">1587536520</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 查看当前时间 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">时间格式化</span></span><br><span class="line">=&gt; date +&#x27;%Y-%m-%d %A %H:%M:%S&#x27;</span><br><span class="line">2020-05-08 Friday 19:12:22</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">当前时间戳</span></span><br><span class="line">=&gt; date +&#x27;%s&#x27;</span><br><span class="line">1644981572</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 设置当前时间 ##########</span></span></span><br><span class="line">=&gt; date -s @1587536520</span><br></pre></td></tr></table></figure><h2 id="11-dd-批量拷贝命令"><a href="#11-dd-批量拷贝命令" class="headerlink" title="11. dd 批量拷贝命令"></a>11. dd 批量拷贝命令</h2><h3 id="11-1-实例"><a href="#11-1-实例" class="headerlink" title="11.1. 实例"></a>11.1. 实例</h3><p><strong>1. 生成大文件</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">生成指定大小文件，1M一个单位，120个单位，生成到/sftmpfs/test</span></span><br><span class="line">dd if=/dev/zero of=/sftmpfs/test bs=1M count=120</span><br></pre></td></tr></table></figure><h2 id="12-watch-监听命令"><a href="#12-watch-监听命令" class="headerlink" title="12. watch 监听命令"></a>12. watch 监听命令</h2><h3 id="12-1-实例"><a href="#12-1-实例" class="headerlink" title="12.1. 实例"></a>12.1. 实例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">监听内存变化，每秒刷新一次</span></span><br><span class="line">watch -n 1 free -h</span><br></pre></td></tr></table></figure><h2 id="13-iptables-防火墙"><a href="#13-iptables-防火墙" class="headerlink" title="13. iptables 防火墙"></a>13. iptables 防火墙</h2><h3 id="13-1-知识填充"><a href="#13-1-知识填充" class="headerlink" title="13.1. 知识填充"></a>13.1. 知识填充</h3><p>查看 <a href="/bookPages/docs/linux/linux-kernel/net/iptables/">iptables原理和源码分析</a></p><h3 id="13-2-实例"><a href="#13-2-实例" class="headerlink" title="13.2. 实例"></a>13.2. 实例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 插入规则 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-I插入到前面，-A插入到后面</span></span><br><span class="line">iptables -I INPUT -i eth0 -s 200.200.87.48 -p tcp --dport 22 -j ACCEPT</span><br><span class="line">iptables -A INPUT -p tcp --dport 22 -j DROP</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加输出日志</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">INPUT、OUTPUT、FORWARD都可以在filter表添加日志</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">--log-prefix 输出的前缀，可以用来查询</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">--log-level 输出级别 0是emerg,1是alert，2是crit，3是err，4是warning，5是notice，6是info，7是debug</span></span><br><span class="line">iptables -I INPUT -i eth0 -p udp --dport 53 -j LOG --log-prefix &quot;input dns: &quot; --log-level 7</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">PREROUTING和POSTROUTING可以在raw或mangle表添加日志，nat添加日志无输出</span></span><br><span class="line">iptables -t raw -A PREROUTING -i eth0 -p udp --dport 53 -j LOG --log-prefix &quot;prerouting dns: &quot; --log-level 7</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 查询规则 ##########</span></span></span><br><span class="line">iptables -t filter -vL INPUT --line-numbers</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 删除规则 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">line_number是上面查出来的</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这种方式可以删除filter表</span></span><br><span class="line">iptables -t filter -D INPUT [line_number]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">INPUT的nat表可以用下面进行全清</span></span><br><span class="line">iptables -t nat -F INPUT</span><br></pre></td></tr></table></figure><h3 id="踩坑记"><a href="#踩坑记" class="headerlink" title="踩坑记"></a>踩坑记</h3><h4 id="1-iptables报错iptables-v1-8-4-nf-tables-Could-not-fetch-rule-set-generation-id-Invalid-argument"><a href="#1-iptables报错iptables-v1-8-4-nf-tables-Could-not-fetch-rule-set-generation-id-Invalid-argument" class="headerlink" title="1) iptables报错iptables v1.8.4 (nf_tables): Could not fetch rule set generation id: Invalid argument"></a>1) iptables报错<code>iptables v1.8.4 (nf_tables): Could not fetch rule set generation id: Invalid argument</code></h4><ul><li>是iptables使用了nft模式，修改为legacy就好了，执行命令</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">=&gt; update-alternatives --config iptables</span><br><span class="line">There are 2 choices for the alternative iptables (providing /usr/sbin/iptables).</span><br><span class="line"></span><br><span class="line">  Selection    Path                       Priority   Status</span><br><span class="line">------------------------------------------------------------</span><br><span class="line">  0            /usr/sbin/iptables-nft      20        auto mode</span><br><span class="line">* 1            /usr/sbin/iptables-legacy   10        manual mode</span><br><span class="line">  2            /usr/sbin/iptables-nft      20        manual mode</span><br></pre></td></tr></table></figure><ul><li>选择legacy即可</li></ul><h2 id="14-ls-列举目录"><a href="#14-ls-列举目录" class="headerlink" title="14. ls 列举目录"></a>14. ls 列举目录</h2><h3 id="13-1-选项"><a href="#13-1-选项" class="headerlink" title="13.1. 选项"></a>13.1. 选项</h3><ul><li><code>-l</code>: 列表显示详细信息</li><li><code>-h</code>: 目录大小加上单位</li><li><code>-t</code>: 按照时间排序</li><li><code>-S</code>: 按照大小排序</li><li><code>-r</code>: 反向排序</li></ul><h3 id="13-2-时间显示格式修改"><a href="#13-2-时间显示格式修改" class="headerlink" title="13.2. 时间显示格式修改"></a>13.2. 时间显示格式修改</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">=&gt; export TIME_STYLE=&#x27;+%Y-%m-%d %H:%M:%S&#x27;</span><br><span class="line">=&gt; ls -l test.js</span><br><span class="line">-rw-r--r-- 1 xxx xxx 87 2022-03-07 16:02:09 test.js</span><br></pre></td></tr></table></figure><h2 id="15-netstat-网络状态查看"><a href="#15-netstat-网络状态查看" class="headerlink" title="15. netstat 网络状态查看"></a>15. netstat 网络状态查看</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">usage: netstat [-vWeenNcCF] [&lt;Af&gt;] -r         netstat &#123;-V|--version|-h|--help&#125;</span><br><span class="line">       netstat [-vWnNcaeol] [&lt;Socket&gt; ...]</span><br><span class="line">       netstat &#123; [-vWeenNac] -i | [-cnNe] -M | -s [-6tuw] &#125;</span><br></pre></td></tr></table></figure><ul><li><code>-a</code>: 显示所有连接，包括正在连接的</li><li><code>-l</code>: 显示监听的连接，只显示被监听的端口和套接字文件</li><li><code>-p</code>: 显示进程名</li><li><code>-n</code>: 不把端口自动推测成服务，显示原始端口</li><li><code>-t</code>: tcp</li><li><code>-u</code>: udp</li></ul><h3 id="实例"><a href="#实例" class="headerlink" title="实例"></a>实例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">显示所有tcp监听的端口，显示对应进程，按照数字显示端口</span></span><br><span class="line">netstat -tnlp | grep 1234</span><br></pre></td></tr></table></figure><h2 id="16-sed-文件查找替换打印"><a href="#16-sed-文件查找替换打印" class="headerlink" title="16. sed 文件查找替换打印"></a>16. sed 文件查找替换打印</h2><ul><li>sed命令有点复杂，一直不会用，但是很强大</li></ul><h3 id="16-1-选项"><a href="#16-1-选项" class="headerlink" title="16.1. 选项"></a>16.1. 选项</h3><ul><li><code>-i[suffix]</code>: 替换文件内容，如果定义了suffix，会备份一份到<code>xxxsuffix</code></li></ul><h3 id="16-2-示例"><a href="#16-2-示例" class="headerlink" title="16.2. 示例"></a>16.2. 示例</h3><p><strong>1. 添加一行</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sed -i &quot;/^start()/a\</span><br><span class="line">	if ! &quot;$&#123;script&#125;&quot; check &quot;$&#123;proc_name&#125;&quot;; then exit 0; fi</span><br><span class="line">&quot; &quot;$&#123;file_name&#125;&quot;</span><br></pre></td></tr></table></figure><p><strong>2. 添加多行</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">sed -i &quot;/^start()/a\</span><br><span class="line">	if ! \&quot;$&#123;script&#125;\&quot; check \&quot;$&#123;proc_name&#125;\&quot;; then\n\</span><br><span class="line">		/bin/run.sh \&quot;$&#123;file&#125;\&quot; &amp;\n\</span><br><span class="line">		exit 0\n\</span><br><span class="line">	fi</span><br><span class="line">&quot; &quot;$&#123;file_name&#125;&quot;</span><br></pre></td></tr></table></figure><p><strong>3. 替换</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将aaa替换成bbb</span></span><br><span class="line">sed -i &quot;s/aaa/bbb/&quot; &quot;$&#123;file_name&#125;&quot;</span><br></pre></td></tr></table></figure><p><strong>3. 删除所有的html标签</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/&lt;[^&gt;]*&gt;//g&#x27; &quot;$&#123;file_name&#125;&quot;</span><br></pre></td></tr></table></figure><p><strong>4. 截取文件中间部分</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -n &#x27;15,20p&#x27; test.txt</span><br></pre></td></tr></table></figure><h3 id="16-3-正则"><a href="#16-3-正则" class="headerlink" title="16.3. 正则"></a>16.3. 正则</h3><ul><li><code>*</code>: 匹配空格零次或多次</li><li><code>\?</code>: 匹配空格零次或一次</li><li><code>\+</code>: 匹配空格一次或多次</li></ul><h3 id="特殊用法"><a href="#特殊用法" class="headerlink" title="特殊用法"></a>特殊用法</h3><p><strong>1. pattern带大括号，需要转义</strong></p><ul><li>将大括号单独用单引号包裹，两边闭合单引号</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sed -i &#x27;s/aaa&#x27;&#x27;&#123;&#x27;&#x27;/bbb&#x27;&#x27;&#123;&#x27;&#x27;/&#x27; aaa.txt</span><br></pre></td></tr></table></figure><h2 id="17-echo-输出"><a href="#17-echo-输出" class="headerlink" title="17. echo 输出"></a>17. echo 输出</h2><ul><li><code>-n</code>: 不换行</li><li><code>-e</code>: 解析<code>\n</code>等字符，默认不解析</li></ul><h2 id="18-diff-patch-差异输出和应用"><a href="#18-diff-patch-差异输出和应用" class="headerlink" title="18. diff &amp; patch 差异输出和应用"></a>18. diff &amp; patch 差异输出和应用</h2><p><strong>diff</strong></p><ul><li><code>-r</code>: 递归对比文件夹改动</li><li><code>-u</code>: 合并的方式输出，类似git diff，用于生成patch</li></ul><p><strong>git diff</strong></p><ul><li><code>-w</code>: 忽略空格改动</li><li><code>--relative</code>: 相对目录，不使用git绝对目录</li></ul><p><strong>patch</strong></p><ul><li><code>-p&lt;n&gt;</code>: 裁剪前导<code>/</code>和目录，p1忽略第一个<code>/</code>，以此类推</li><li><code>-l</code>: 忽略空格</li><li><code>-i &lt;patch_path&gt;</code>: 输入patch文件</li><li><code>--no-backup-if-mismatch</code>: 如果改动不完全，不要备份文件</li></ul><h3 id="18-1-git改动应用到某个目录上（非git标准目录）"><a href="#18-1-git改动应用到某个目录上（非git标准目录）" class="headerlink" title="18.1 git改动应用到某个目录上（非git标准目录）"></a>18.1 git改动应用到某个目录上（非git标准目录）</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">和某个提交做diff，输出到patch文件</span></span><br><span class="line">git diff 09e99a0b6273c26007c16dae48822a6d107eadef -w --relative . &gt; ~/temp/patch</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将patch文件应用到当前目录下</span></span><br><span class="line">patch -p1 -l --no-backup-if-mismatch -i ~/temp/patch</span><br></pre></td></tr></table></figure><h3 id="18-2-文件夹改动应用到另一个文件夹"><a href="#18-2-文件夹改动应用到另一个文件夹" class="headerlink" title="18.2 文件夹改动应用到另一个文件夹"></a>18.2 文件夹改动应用到另一个文件夹</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">两个同级目录对比（必须同级，不然应用差异时目录会有问题）</span></span><br><span class="line">diff -ru dir1 dir2 &gt; ~/temp/patch</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">进入到目录里面，不然patch删除目录会不识别</span></span><br><span class="line">cd dir3</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将patch文件应用到当前目录下</span></span><br><span class="line">patch -p1 -l --no-backup-if-mismatch -i ~/temp/patch</span><br></pre></td></tr></table></figure><h2 id="19-fallocate-创建大文件"><a href="#19-fallocate-创建大文件" class="headerlink" title="19. fallocate 创建大文件"></a>19. fallocate 创建大文件</h2><p>fallocate创建的文件仅仅是占用磁盘，没有内容，所以只有很少的I&#x2F;O操作，比dd快很多</p><h3 id="19-1-几种基本用法"><a href="#19-1-几种基本用法" class="headerlink" title="19.1. 几种基本用法"></a>19.1. 几种基本用法</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建一个10G的文件</span></span><br><span class="line">fallocate -l 10G test.img</span><br></pre></td></tr></table></figure><p><strong><font color="red">不知道为什么，fallocate不能重复对一个文件执行，想要重新分配需要手动删除前一个文件</font></strong></p><h2 id="20-lsof-查看系统文件占用（包括端口）"><a href="#20-lsof-查看系统文件占用（包括端口）" class="headerlink" title="20. lsof 查看系统文件占用（包括端口）"></a>20. lsof 查看系统文件占用（包括端口）</h2><h3 id="20-1-几种基本用法"><a href="#20-1-几种基本用法" class="headerlink" title="20.1. 几种基本用法"></a>20.1. 几种基本用法</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">根据进程号查看端口占用</span></span><br><span class="line">lsof -i | grep [pid]</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">根据文件名查看文件占用</span></span><br><span class="line">lsof /path/to/file</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">根据路径查看目录下（不包含子目录）文件占用</span></span><br><span class="line">lsof +d /path/to/dir/</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">根据路径查看目录下（包含子目录）文件占用</span></span><br><span class="line">lsof +D /path/to/dir/</span><br></pre></td></tr></table></figure><h2 id="21-top-查看系统占用"><a href="#21-top-查看系统占用" class="headerlink" title="21. top 查看系统占用"></a>21. top 查看系统占用</h2><h3 id="21-1-几个快捷键"><a href="#21-1-几个快捷键" class="headerlink" title="21.1. 几个快捷键"></a>21.1. 几个快捷键</h3><ul><li><code>Shift + E</code>: 调整内存单位</li><li><code>1</code>: 切换cpu统计模式，所有&#x2F;详细</li><li><code>Shift + P</code>: cpu占用排序</li><li><code>Shift + M</code>: 内存占用排序</li><li><code>m</code>: 切换内存显示样式</li><li><code>c</code>: 显示进程详细命令</li></ul><h3 id="21-2-进程状态解析"><a href="#21-2-进程状态解析" class="headerlink" title="21.2. 进程状态解析"></a>21.2. <span id="process_status">进程状态解析</span></h3><ul><li>R——Runnable（运行）: 正在运行或在运行队列中等待</li><li>S——sleeping（中断）: 休眠中，受阻，在等待某个条件的形成或接收到信号</li><li>D——uninterruptible sleep(不可中断): 收到信号不唤醒和不可运行，进程必须等待直到有中断发生</li><li>Z——zombie（僵死）: 进程已终止，但进程描述还在，直到父进程调用wait4()系统调用后释放</li><li>T——traced or stoppd(停止): 进程收到SIGSTOP,SIGSTP,SIGTOU信号后停止运行</li></ul><p><strong>后缀表示</strong></p><ul><li>&lt;: 优先级高的进程</li><li>N: 优先级低的进程</li><li>L: 有些页被锁进内存</li><li>s: 进程的领导者（在它之下有子进程）</li><li>l: ismulti-threaded (using CLONE_THREAD, like NPTL pthreads do)</li><li>+: 位于后台的进程组</li></ul><h2 id="22-awk-逐行处理显示"><a href="#22-awk-逐行处理显示" class="headerlink" title="22. awk 逐行处理显示"></a>22. awk 逐行处理显示</h2><h3 id="22-1-几种基本用法"><a href="#22-1-几种基本用法" class="headerlink" title="22.1. 几种基本用法"></a>22.1. 几种基本用法</h3><h3 id="22-2-骚操作实例"><a href="#22-2-骚操作实例" class="headerlink" title="22.2. 骚操作实例"></a>22.2. 骚操作实例</h3><p><strong>1. git计算代码行数</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git diff xxxx --numstat | awk &#x27;&#123;add+=$1;del+=$2&#125; END &#123;print &quot;Add =&quot;,add,&quot;Delete =&quot;,del&#125;&#x27;</span><br></pre></td></tr></table></figure><h2 id="23-md5sum-计算MD5"><a href="#23-md5sum-计算MD5" class="headerlink" title="23. md5sum 计算MD5"></a>23. md5sum 计算MD5</h2><h3 id="23-1-几种基本用法"><a href="#23-1-几种基本用法" class="headerlink" title="23.1. 几种基本用法"></a>23.1. 几种基本用法</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">计算字符串的md5</span></span><br><span class="line">echo -n &quot;xxx&quot; | md5sum</span><br></pre></td></tr></table></figure><h2 id="24-udevadm-系统usb管理"><a href="#24-udevadm-系统usb管理" class="headerlink" title="24. udevadm 系统usb管理"></a>24. udevadm 系统usb管理</h2><h3 id="24-1-几种基本用法"><a href="#24-1-几种基本用法" class="headerlink" title="24.1 几种基本用法"></a>24.1 几种基本用法</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">监听usb事件，查看详细信息可以添加选项</span></span><br><span class="line">udevadm monitor --environment --udev</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置日志级别</span></span><br><span class="line">udevadm control --log-priority=debug</span><br></pre></td></tr></table></figure><h2 id="25-lsblk-树型查看硬盘分区信息"><a href="#25-lsblk-树型查看硬盘分区信息" class="headerlink" title="25. lsblk 树型查看硬盘分区信息"></a>25. lsblk 树型查看硬盘分区信息</h2><ul><li><code>-d</code>: 只显示硬盘，不显示分区</li><li><code>-o xxx,xxx</code>: 指定显示列<ul><li><code>name</code>: 名字</li><li><code>rota</code>: 是否是转动磁盘，也就是机械硬盘。1为机械硬盘；0为固态硬盘</li></ul></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">=&gt; lsblk</span><br><span class="line">NAME   MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS</span><br><span class="line">sda      8:0    0 298.1G  0 disk</span><br><span class="line">├─sda1   8:1    0 954.9M  0 part</span><br><span class="line">├─sda2   8:2    0     1K  0 part</span><br><span class="line">├─sda5   8:5    0 198.1G  0 part /home</span><br><span class="line">├─sda6   8:6    0  11.2G  0 part [SWAP]</span><br><span class="line">├─sda7   8:7    0  46.6G  0 part /</span><br><span class="line">└─sda8   8:8    0  41.3G  0 part /opt</span><br><span class="line">=&gt; lsblk -d</span><br><span class="line">NAME MAJ:MIN RM   SIZE RO TYPE MOUNTPOINTS</span><br><span class="line">sda    8:0    0 298.1G  0 disk</span><br><span class="line">=&gt; lsblk -d -o name,rota</span><br><span class="line">NAME ROTA</span><br><span class="line">sda     1</span><br></pre></td></tr></table></figure><h2 id="26-blkid-查看已挂载的硬盘的uuid信息"><a href="#26-blkid-查看已挂载的硬盘的uuid信息" class="headerlink" title="26. blkid 查看已挂载的硬盘的uuid信息"></a>26. blkid 查看已挂载的硬盘的uuid信息</h2><h2 id="27-tune2fs-修改硬盘uuid"><a href="#27-tune2fs-修改硬盘uuid" class="headerlink" title="27. tune2fs 修改硬盘uuid"></a>27. tune2fs 修改硬盘uuid</h2><h2 id="28-route-更新路由信息"><a href="#28-route-更新路由信息" class="headerlink" title="28. route 更新路由信息"></a>28. route 更新路由信息</h2><h3 id="28-1-一些基本用法"><a href="#28-1-一些基本用法" class="headerlink" title="28.1. 一些基本用法"></a>28.1. 一些基本用法</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 查看路由 ##########</span></span></span><br><span class="line">route -n</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 添加路由 ##########</span></span></span><br><span class="line">route add -net 1.1.1.1/24 gw 1.1.1.254</span><br><span class="line">route add -net 1.1.1.1/24 dev eth0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 删除路由 ##########</span></span></span><br><span class="line">route del -net 1.1.1.1/24 gw 1.1.1.254</span><br><span class="line">route del -net 1.1.1.1/24 dev eth0</span><br></pre></td></tr></table></figure><h2 id="29-ps-查看系统进程"><a href="#29-ps-查看系统进程" class="headerlink" title="29. ps 查看系统进程"></a>29. ps 查看系统进程</h2><h3 id="29-1-选项含义"><a href="#29-1-选项含义" class="headerlink" title="29.1. 选项含义"></a>29.1. 选项含义</h3><p><strong>参数</strong></p><ul><li><code>a</code>: 列出所有用户的程序</li><li><code>u</code>: 显示所属用户</li><li><code>x</code>: 显示所有程序，不加只显示终端控制的程序</li><li><code>c</code>: 只显示指令名称</li><li><code>f</code>: 使用ascii字符展示关系</li><li><code>e</code>: 显示环境变量</li><li><code>ww</code>: 显示全，自动换行</li></ul><h2 id="30-ip-系统网络配置"><a href="#30-ip-系统网络配置" class="headerlink" title="30. ip 系统网络配置"></a>30. ip 系统网络配置</h2><ul><li>默认配置ipv4，配置ipv6需要加上<code>-6</code></li></ul><h3 id="30-1-路由相关"><a href="#30-1-路由相关" class="headerlink" title="30.1. 路由相关"></a>30.1. 路由相关</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">########## 查看路由 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这里查看的是main表</span></span><br><span class="line">=&gt; ip route show</span><br><span class="line">default via 199.200.2.254 dev ens18 proto static metric 100</span><br><span class="line">199.200.0.0/16 dev ens18 proto kernel scope link src 199.200.2.199 metric 100</span><br><span class="line">255.253.254.0/24 dev ens19 proto kernel scope link src 255.253.254.33</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">根据访问ip查看路由</span></span><br><span class="line">=&gt; ip r get 199.200.2.170</span><br><span class="line">199.200.2.170 via 10.240.255.254 dev ens18 src 10.240.17.101 uid 1000</span><br><span class="line">    cache</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看不同路由表，可以查看main、<span class="built_in">local</span></span></span><br><span class="line">=&gt; ip route list table local</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 配置路由 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">配置默认路由，需要先将网关的网段指向具体网卡，然后再添加默认路由指定网关地址，仅指定网卡并不能通</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">仅指定网关会导致无法配置网卡作为默认出口，虽然route命令可以</span></span><br><span class="line">ip route add 192.168.0.0/24 dev ens18</span><br><span class="line">ip route add default via 192.168.0.254 dev ens18</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">静态路由</span></span><br><span class="line">ip route add 192.168.0.101/32 via 192.168.0.254 dev enp0s3</span><br></pre></td></tr></table></figure><h4 id="1-策略路由"><a href="#1-策略路由" class="headerlink" title="1) 策略路由"></a>1) 策略路由</h4><ul><li>一般的策略路由配置是设置mark到数据包，然后通过mark将数据包匹配对应的路由表</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 查看所有的策略路由规则 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">下面的fwmark就是在数据包上的mark匹配走200这个表</span></span><br><span class="line">=&gt; ip rule show</span><br><span class="line">0:      from all lookup local</span><br><span class="line">50:     from all fwmark 0x1 lookup 200</span><br><span class="line">32766:  from all lookup main</span><br><span class="line">32767:  from all lookup default</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 查看某个路由表的规则 ##########</span></span></span><br><span class="line">=&gt; ip route show table 200</span><br><span class="line">local default dev lo scope host</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 设置规则 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">策略路由添加mark为1000的给到1000路由表，fwmark匹配的是sk_buff的mark</span></span><br><span class="line">=&gt; ip rule add fwmark 1000 table 1000</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 设置路由表的默认路由 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1000的路由表直接把所有流量路由到tun0上去</span></span><br><span class="line">=&gt; ip route add default dev tun0 table 1000</span><br></pre></td></tr></table></figure><h3 id="30-2-查看网卡ip"><a href="#30-2-查看网卡ip" class="headerlink" title="30.2. 查看网卡ip"></a>30.2. 查看网卡ip</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">=&gt; ip addr</span><br><span class="line">1: lo: &lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000</span><br><span class="line">    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00</span><br><span class="line">    inet 127.0.0.1/8 scope host lo</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 ::1/128 scope host</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">2: ens18: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span><br><span class="line">    link/ether fe:fc:fe:07:fe:6a brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet 199.200.2.199/16 brd 199.200.255.255 scope global noprefixroute ens18</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::34c9:aa6d:8630:e99a/64 scope link noprefixroute</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">3: ens19: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UP group default qlen 1000</span><br><span class="line">    link/ether fe:fc:fe:79:83:d5 brd ff:ff:ff:ff:ff:ff</span><br><span class="line">    inet6 2001::199/112 scope global noprefixroute</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br><span class="line">    inet6 fe80::d501:6609:cfd1:9970/64 scope link noprefixroute</span><br><span class="line">       valid_lft forever preferred_lft forever</span><br></pre></td></tr></table></figure><h3 id="30-3-配置网卡"><a href="#30-3-配置网卡" class="headerlink" title="30.3. 配置网卡"></a>30.3. 配置网卡</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启用/禁用网卡</span></span><br><span class="line">ip link set eth0 up</span><br><span class="line">ip link set eth0 down</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">分配ip</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">brd + 根据掩码和ip配置广播地址</span></span><br><span class="line">ip addr add 199.200.1.1/24 brd + dev eth0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">单独配置广播地址</span></span><br><span class="line">ip addr add broadcast 192.168.0.255 dev eth0</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">删除分配的ip</span></span><br><span class="line">ip addr del 192.168.0.10/24 dev eth0</span><br></pre></td></tr></table></figure><h2 id="31-read-读取输入"><a href="#31-read-读取输入" class="headerlink" title="31. read 读取输入"></a>31. read 读取输入</h2><h3 id="31-1-读取用户输入"><a href="#31-1-读取用户输入" class="headerlink" title="31.1. 读取用户输入"></a>31.1. 读取用户输入</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">read -s 5 -p &quot;do you wan&#x27;t to continue [y/n]&quot; input</span><br><span class="line">case &quot;$input&quot; in</span><br><span class="line">case [Yy]*)</span><br></pre></td></tr></table></figure><h2 id="32-conntrack-连接跟踪"><a href="#32-conntrack-连接跟踪" class="headerlink" title="32. conntrack 连接跟踪"></a>32. conntrack 连接跟踪</h2><h3 id="32-1-选项解释"><a href="#32-1-选项解释" class="headerlink" title="32.1. 选项解释"></a>32.1. 选项解释</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看连接跟踪表</span></span><br><span class="line">conntrack -L &lt;options&gt;</span><br></pre></td></tr></table></figure><ul><li><code>-p [protocol]</code></li><li><code>-s [src_ip]</code></li><li><code>-d [dst_ip]</code></li><li><code>--sport [src_port]</code></li><li><code>--dport [dst_port]</code></li><li><code>--state [NONE | SYN_SENT | SYN_RECV | ESTABLISHED | FIN_WAIT | CLOSE_WAIT | LAST_ACK | TIME_WAIT | CLOSE | LISTEN]</code>: 过滤状态</li></ul><h2 id="33-ss-查看socket占用情况"><a href="#33-ss-查看socket占用情况" class="headerlink" title="33. ss 查看socket占用情况"></a>33. ss 查看socket占用情况</h2><h3 id="33-1-选项解释"><a href="#33-1-选项解释" class="headerlink" title="33.1. 选项解释"></a>33.1. 选项解释</h3><ul><li><code>-t</code>: tcp</li><li><code>-u</code>: udp</li><li><code>-x</code>: unix</li><li><code>-l</code>: listening</li><li><code>-p</code>: 展示进程信息</li><li><code>-m</code>: 展示socket内存占用情况</li><li><code>-n</code>: 不把端口自动推测成服务，显示原始端口<br>v9k</li></ul><h3 id="33-2-使用实例"><a href="#33-2-使用实例" class="headerlink" title="33.2. 使用实例"></a>33.2. 使用实例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看22端口占用</span></span><br><span class="line">=&gt; ss -tnlp | grep &#x27;:22&#x27;</span><br><span class="line">LISTEN  0        128                    0.0.0.0:22               0.0.0.0:*       users:((&quot;sshd&quot;,pid=25985,fd=3))</span><br><span class="line">LISTEN  0        128                       [::]:22                  [::]:*       users:((&quot;sshd&quot;,pid=25985,fd=4))</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看25985进程占用情况</span></span><br><span class="line">=&gt; ss -tnlp | grep &#x27;pid=25985&#x27;</span><br><span class="line">LISTEN  0        128                    0.0.0.0:22               0.0.0.0:*       users:((&quot;sshd&quot;,pid=25985,fd=3))</span><br><span class="line">LISTEN  0        128                       [::]:22                  [::]:*       users:((&quot;sshd&quot;,pid=25985,fd=4))</span><br></pre></td></tr></table></figure><h2 id="34-pwd"><a href="#34-pwd" class="headerlink" title="34. pwd"></a>34. pwd</h2><h3 id="34-1-选项解释"><a href="#34-1-选项解释" class="headerlink" title="34.1. 选项解释"></a>34.1. 选项解释</h3><ul><li><code>-L</code>: 逻辑路径，软连接路径</li><li><code>-P</code>: 物理路径，软连接映射的真实路径</li></ul><h2 id="35-mknod"><a href="#35-mknod" class="headerlink" title="35. mknod"></a>35. mknod</h2><ul><li>用于挂载设备节点</li></ul><h3 id="35-1-示例"><a href="#35-1-示例" class="headerlink" title="35.1. 示例"></a>35.1. 示例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">挂载字符型设备，主设备号1，次设备号8</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">c     character special file</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">1 8   Device <span class="built_in">type</span>: 1,8</span></span><br><span class="line">mknod /dev/random c 1 8</span><br></pre></td></tr></table></figure><h2 id="36-sudo"><a href="#36-sudo" class="headerlink" title="36. sudo"></a>36. sudo</h2><h3 id="36-1-选项"><a href="#36-1-选项" class="headerlink" title="36.1. 选项"></a>36.1. 选项</h3><ul><li><code>-E</code>: 继承当前环境变量</li></ul><h2 id="37-sysctl-修改内核参数"><a href="#37-sysctl-修改内核参数" class="headerlink" title="37. sysctl 修改内核参数"></a>37. sysctl 修改内核参数</h2><h3 id="37-1-选项"><a href="#37-1-选项" class="headerlink" title="37.1. 选项"></a>37.1. 选项</h3><ul><li><code>-a</code>: 列举所有内核参数</li><li><code>-p</code>: 从<code>/etc/sysctl.conf</code>加载配置</li><li><code>-w</code>: 修改内核参数</li></ul><h4 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查找当前配置</span></span><br><span class="line">=&gt; sudo sysctl -a | grep compa</span><br><span class="line">net.ipv4.nexthop_compat_mode = 1</span><br><span class="line">vm.compact_unevictable_allowed = 1</span><br><span class="line">vm.compaction_proactiveness = 20</span><br><span class="line">vm.mmap_rnd_compat_bits = 8</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">临时修改kernel配置</span></span><br><span class="line">=&gt; sudo sysctl -w vm.compaction_proactiveness=0</span><br><span class="line">vm.compaction_proactiveness = 0</span><br><span class="line">=&gt; sudo sysctl -a | grep compa</span><br><span class="line">net.ipv4.nexthop_compat_mode = 1</span><br><span class="line">vm.compact_unevictable_allowed = 1</span><br><span class="line">vm.compaction_proactiveness = 0</span><br><span class="line">vm.mmap_rnd_compat_bits = 8</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">永久修改kernel配置</span></span><br><span class="line">=&gt; sudo bash -c &quot;echo \&quot;vm.compaction_proactiveness=0\&quot; &gt; /etc/sysctl.conf&quot;</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">从配置文件读取配置</span></span><br><span class="line">=&gt; sudo sysctl -p</span><br><span class="line">vm.compaction_proactiveness = 0</span><br><span class="line">=&gt; sudo sysctl -a | grep compa</span><br><span class="line">net.ipv4.nexthop_compat_mode = 1</span><br><span class="line">vm.compact_unevictable_allowed = 1</span><br><span class="line">vm.compaction_proactiveness = 0</span><br><span class="line">vm.mmap_rnd_compat_bits = 8</span><br></pre></td></tr></table></figure><h2 id="38-pmap查看进程内存情况"><a href="#38-pmap查看进程内存情况" class="headerlink" title="38. pmap查看进程内存情况"></a>38. pmap查看进程内存情况</h2><h3 id="选项"><a href="#选项" class="headerlink" title="选项"></a>选项</h3><ul><li><code>-x</code>: 显示扩展格式</li><li><code>-d</code>: 显示设备格式</li><li><code>-q</code>: 不显示头尾行</li><li><code>-V</code>: 显示指定版本</li></ul><h3 id="示例-1"><a href="#示例-1" class="headerlink" title="示例"></a>示例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">=&gt; pmap -x 76381</span><br><span class="line">76381:   build/output/run</span><br><span class="line">Address           Kbytes     RSS   Dirty Mode  Mapping</span><br><span class="line">0000560aff840000      44      44       0 r---- run</span><br><span class="line">0000560aff84b000     484     484       0 r-x-- run</span><br><span class="line">0000560aff8c4000     288      64       0 r---- run</span><br><span class="line">0000560aff90c000      12      12      12 r---- run</span><br><span class="line">0000560aff90f000       4       4       4 rw--- run</span><br><span class="line">0000560aff910000       4       4       4 rw---   [ anon ]</span><br><span class="line">0000560affa43000     132      16      16 rw---   [ anon ]</span><br><span class="line">00007f31dae00000     160     160       0 r---- libc.so.6</span><br><span class="line">00007f31dae28000    1512    1044       0 r-x-- libc.so.6</span><br><span class="line">00007f31dafa2000     352     180       0 r---- libc.so.6</span><br><span class="line">00007f31daffa000      16      16      16 r---- libc.so.6</span><br><span class="line">00007f31daffe000       8       8       8 rw--- libc.so.6</span><br><span class="line">00007f31db000000      52      20      20 rw---   [ anon ]</span><br><span class="line">00007f31db200000     612     612       0 r---- libstdc++.so.6.0.30</span><br><span class="line">00007f31db299000    1112     764       0 r-x-- libstdc++.so.6.0.30</span><br><span class="line">00007f31db3af000     476     116       0 r---- libstdc++.so.6.0.30</span><br><span class="line">00007f31db426000      52      52      52 r---- libstdc++.so.6.0.30</span><br><span class="line">00007f31db433000       4       4       4 rw--- libstdc++.so.6.0.30</span><br><span class="line">00007f31db434000      12      12      12 rw---   [ anon ]</span><br><span class="line">00007f31db474000      20      16      16 rw---   [ anon ]</span><br><span class="line">00007f31db479000      12      12       0 r---- libgcc_s.so.1</span><br><span class="line">00007f31db47c000      92      64       0 r-x-- libgcc_s.so.1</span><br><span class="line">00007f31db493000      16      16       0 r---- libgcc_s.so.1</span><br><span class="line">00007f31db497000       4       4       4 r---- libgcc_s.so.1</span><br><span class="line">00007f31db498000       4       4       4 rw--- libgcc_s.so.1</span><br><span class="line">00007f31db499000      56      56       0 r---- libm.so.6</span><br><span class="line">00007f31db4a7000     484     224       0 r-x-- libm.so.6</span><br><span class="line">00007f31db520000     376       0       0 r---- libm.so.6</span><br><span class="line">00007f31db57e000       4       4       4 r---- libm.so.6</span><br><span class="line">00007f31db57f000       4       4       4 rw--- libm.so.6</span><br><span class="line">00007f31db5af000       8       8       8 rw---   [ anon ]</span><br><span class="line">00007f31db5b1000       8       8       0 r---- ld-linux-x86-64.so.2</span><br><span class="line">00007f31db5b3000     156     156       0 r-x-- ld-linux-x86-64.so.2</span><br><span class="line">00007f31db5da000      44      40       0 r---- ld-linux-x86-64.so.2</span><br><span class="line">00007f31db5e6000       8       8       8 r---- ld-linux-x86-64.so.2</span><br><span class="line">00007f31db5e8000       8       8       8 rw--- ld-linux-x86-64.so.2</span><br><span class="line">00007ffe6b20a000     136      24      24 rw---   [ stack ]</span><br><span class="line">00007ffe6b2c7000      16       0       0 r----   [ anon ]</span><br><span class="line">00007ffe6b2cb000       8       4       0 r-x--   [ anon ]</span><br><span class="line">ffffffffff600000       4       0       0 --x--   [ anon ]</span><br><span class="line">---------------- ------- ------- -------</span><br><span class="line">total kB            6804    4276     228</span><br></pre></td></tr></table></figure><h2 id="39-setcap-提权命令"><a href="#39-setcap-提权命令" class="headerlink" title="39. setcap 提权命令"></a>39. setcap 提权命令</h2><p>参考 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/sky-heaven/p/12096758.html">Linux的capability深入分析</a></p><ul><li>从2.1版开始,Linux内核有了能力(capability)的概念,即它打破了UNIX&#x2F;LINUX操作系统中超级用户&#x2F;普通用户的概念,由普通用户也可以做只有超级用户可以完成的工作</li><li>比如给kill命令杀死其他进程的能力，但是不能重启系统，也不能修改文件。仅拥有杀死其他进程的能力</li></ul><h3 id="39-1-能力列举"><a href="#39-1-能力列举" class="headerlink" title="39.1. 能力列举"></a>39.1. 能力列举</h3><ul><li><code>CAP_CHOWN</code>: 修改文件属主的权限</li><li><code>CAP_DAC_OVERRIDE</code>: 忽略文件的DAC访问限制</li><li><code>CAP_DAC_READ_SEARCH</code>: 忽略文件读及目录搜索的DAC访问限制</li><li><code>CAP_FOWNER</code>: 忽略文件属主ID必须和进程用户ID相匹配的限制</li><li><code>CAP_FSETID</code>: 允许设置文件的setuid位</li><li><code>CAP_KILL</code>: 允许对不属于自己的进程发送信号</li><li><code>CAP_SETGID</code>: 允许改变进程的组ID</li><li><code>CAP_SETUID</code>: 允许改变进程的用户ID</li><li><code>CAP_SETPCAP</code>: 允许向其他进程转移能力以及删除其他进程的能力</li><li><code>CAP_LINUX_IMMUTABLE</code>: 允许修改文件的IMMUTABLE和APPEND属性标志</li><li><code>CAP_NET_BIND_SERVICE</code>: 允许绑定到小于1024的端口</li><li><code>CAP_NET_BROADCAST</code>: 允许网络广播和多播访问</li><li><code>CAP_NET_ADMIN</code>: 允许执行网络管理任务</li><li><code>CAP_NET_RAW</code>: 允许使用原始套接字</li><li><code>CAP_IPC_LOCK</code>: 允许锁定共享内存片段</li><li><code>CAP_IPC_OWNER</code>: 忽略IPC所有权检查</li><li><code>CAP_SYS_MODULE</code>: 允许插入和删除内核模块</li><li><code>CAP_SYS_RAWIO</code>: 允许直接访问&#x2F;devport,&#x2F;dev&#x2F;mem,&#x2F;dev&#x2F;kmem及原始块设备</li><li><code>CAP_SYS_CHROOT</code>: 允许使用chroot()系统调用</li><li><code>CAP_SYS_PTRACE</code>: 允许跟踪任何进程</li><li><code>CAP_SYS_PACCT</code>: 允许执行进程的BSD式审计</li><li><code>CAP_SYS_ADMIN</code>: 允许执行系统管理任务，如加载或卸载文件系统、设置磁盘配额等</li><li><code>CAP_SYS_BOOT</code>: 允许重新启动系统</li><li><code>CAP_SYS_NICE</code>: 允许提升优先级及设置其他进程的优先级</li><li><code>CAP_SYS_RESOURCE</code>: 忽略资源限制</li><li><code>CAP_SYS_TIME</code>: 允许改变系统时钟</li><li><code>CAP_SYS_TTY_CONFIG</code>: 允许配置TTY设备</li><li><code>CAP_MKNOD</code>: 允许使用mknod()系统调用</li><li><code>CAP_LEASE</code>: 允许修改文件锁的FL_LEASE标志</li></ul><h3 id="39-2-示例"><a href="#39-2-示例" class="headerlink" title="39.2. 示例"></a>39.2. 示例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">给tcpdump设置允许使用原始套接字，使得普通用户可以tcpdump</span></span><br><span class="line">=&gt; sudo setcap &#x27;CAP_NET_RAW+eip&#x27; /usr/sbin/tcpdump</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">删除tcpdump的权限</span></span><br><span class="line">=&gt; sudo setcap -r /usr/sbin/tcpdump</span><br></pre></td></tr></table></figure><h2 id="40-xdg-open-按照系统默认打开方式打开文件"><a href="#40-xdg-open-按照系统默认打开方式打开文件" class="headerlink" title="40. xdg-open 按照系统默认打开方式打开文件"></a>40. xdg-open 按照系统默认打开方式打开文件</h2><ul><li>可以打开url、文件等</li></ul><h2 id="41-uniq-处理重复行"><a href="#41-uniq-处理重复行" class="headerlink" title="41. uniq 处理重复行"></a>41. uniq 处理重复行</h2><h3 id="41-1-选项解释"><a href="#41-1-选项解释" class="headerlink" title="41.1. 选项解释"></a>41.1. 选项解释</h3><ul><li><code>-c</code>: 在前面显示重复行数量</li><li><code>-u</code>: 只打印不同的行</li><li><code>-d</code>: 只打印出现过多次的行</li></ul><h3 id="41-2-基本用法"><a href="#41-2-基本用法" class="headerlink" title="41.2. 基本用法"></a>41.2. 基本用法</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">统计重复行数量，<span class="built_in">uniq</span>只能对相邻行处理，所以需要先排序</span></span><br><span class="line">=&gt; cat xxx.log | sort | uniq -c</span><br><span class="line">   2427 0x0381</span><br><span class="line">    493 0x0585</span><br><span class="line">   3297 0x4116</span><br><span class="line">    493 0x41af</span><br><span class="line">    493 0x65cb</span><br><span class="line">    493 0x682f</span><br><span class="line">    221 0x74c4</span><br><span class="line">    492 0x78e1</span><br><span class="line">    477 0x7ca0</span><br><span class="line">   3444 0x82dc</span><br><span class="line">     36 0x8f1c</span><br><span class="line">     41 0x9a5a</span><br><span class="line">    477 0xa026</span><br><span class="line">    478 0xaa25</span><br><span class="line">    477 0xb6d2</span><br><span class="line">    477 0xd593</span><br><span class="line">    492 0xf2d3</span><br><span class="line">    477 0xf89b</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">只打印有重复的行</span></span><br><span class="line">=&gt; cat xxx.log | sort | uniq -d</span><br><span class="line">0x0381</span><br><span class="line">0x0585</span><br><span class="line">0x4116</span><br><span class="line">0x41af</span><br><span class="line">0x65cb</span><br><span class="line">0x682f</span><br><span class="line">0x74c4</span><br><span class="line">0x78e1</span><br><span class="line">0x7ca0</span><br><span class="line">0x82dc</span><br><span class="line">0x8f1c</span><br><span class="line">0x9a5a</span><br><span class="line">0xa026</span><br><span class="line">0xaa25</span><br><span class="line">0xb6d2</span><br><span class="line">0xd593</span><br><span class="line">0xf2d3</span><br><span class="line">0xf89b</span><br></pre></td></tr></table></figure><h2 id="42-ipset-给iptables使用的ip列表"><a href="#42-ipset-给iptables使用的ip列表" class="headerlink" title="42. ipset 给iptables使用的ip列表"></a>42. ipset 给iptables使用的ip列表</h2><h1 id="三、工具命令"><a href="#三、工具命令" class="headerlink" title="三、工具命令"></a>三、工具命令</h1><h2 id="1-文件夹目录大小-du"><a href="#1-文件夹目录大小-du" class="headerlink" title="1. 文件夹目录大小 du"></a>1. 文件夹目录大小 du</h2><p>当前目录下所有子文件夹和文件的大小</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">du ./ -h --max-depth=1</span><br></pre></td></tr></table></figure><h2 id="2-抓包工具-tcpdump"><a href="#2-抓包工具-tcpdump" class="headerlink" title="2. 抓包工具 tcpdump"></a>2. 抓包工具 tcpdump</h2><h3 id="2-1-选项"><a href="#2-1-选项" class="headerlink" title="2.1. 选项"></a>2.1. 选项</h3><ul><li><code>-c [num]</code>: 抓取的包的数量</li><li><code>-i</code>: 要监听的网口，不给默认为第一个网口</li><li><code>-n</code>: 对地址以数字方式显式，否则显示为主机名，也就是说-n选项不做主机名解析</li><li><code>-nn</code>: 除了-n的作用外，还把端口显示为数值，否则显示端口服务名</li><li><code>-w xxx.pcap</code>: 保存到文件，pcap结尾，用于wirshark分析</li><li><code>-v</code>: 显示更多信息，如ip包的存活时间、标识号、总长度和选项，并且检查ip包或icmp包的头部checksum</li><li><code>-vv</code>: 除<code>-v</code>作用外，NFS回包和SMB包会被解码</li><li><code>-X</code>: 打印每一个包，以hex和ascii的形式打印</li></ul><h3 id="2-2-过滤器"><a href="#2-2-过滤器" class="headerlink" title="2.2. 过滤器"></a>2.2. 过滤器</h3><ul><li><code>host [ip_addr]</code>: 源ip和目的ip为<code>ip_addr</code></li><li><code>[src|dst] [ip_addr]</code>: 源ip&#x2F;目的ip为<code>ip_addr</code></li><li><code>[protocol]</code>: 协议<ul><li><code>tcp</code></li><li><code>udp</code></li><li><code>icmp</code></li><li><code>icmp6</code>: ping ipv6</li></ul></li><li><code>port [port_num]</code>: 端口</li><li><code>[src|dst] port [port_num]</code>: 源&#x2F;目的端口</li><li><code>[tcp|udp] port [port_num]</code>: tcp&#x2F;udp端口</li><li><code>[tcp|udp] [src|dst] port [port_num]</code>: tcp&#x2F;udp的源&#x2F;目的端口</li><li><code>ip6</code>: ipv6</li></ul><h3 id="2-3-示例"><a href="#2-3-示例" class="headerlink" title="2.3. 示例"></a>2.3. 示例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">抓5个192.168.100.62到本机eth0的icmp（ping）包</span></span><br><span class="line">tcpdump -c 5 -nnvv -i eth0 icmp and src 192.168.100.62</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">抓取10个本机ens33的目的端口为22的tcp包</span></span><br><span class="line">tcpdump -c 10 -nnvv -i ens33 tcp dst port 22</span><br></pre></td></tr></table></figure><h2 id="3-网络嗅探-nmap"><a href="#3-网络嗅探-nmap" class="headerlink" title="3. 网络嗅探 nmap"></a>3. 网络嗅探 nmap</h2><p><a target="_blank" rel="noopener" href="https://baike.baidu.com/item/nmap/1400075?fr=aladdin">nmap使用</a></p><h2 id="4-远程连接-ssh"><a href="#4-远程连接-ssh" class="headerlink" title="4. 远程连接 ssh"></a>4. 远程连接 ssh</h2><h3 id="4-1-ssh生成公钥和私钥"><a href="#4-1-ssh生成公钥和私钥" class="headerlink" title="4.1. ssh生成公钥和私钥"></a>4.1. ssh生成公钥和私钥</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-keygen -t rsa -C &quot;xxx@xxx.com&quot;</span><br></pre></td></tr></table></figure><h3 id="4-2-ssh通过代理访问"><a href="#4-2-ssh通过代理访问" class="headerlink" title="4.2. ssh通过代理访问"></a>4.2. ssh通过代理访问</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">socks5代理</span></span><br><span class="line">ssh -o &quot;ProxyCommand=nc -x 127.0.0.1:1080 %h %p&quot; test@172.22.2.108</span><br></pre></td></tr></table></figure><h3 id="4-3-端口转发"><a href="#4-3-端口转发" class="headerlink" title="4.3. 端口转发"></a>4.3. 端口转发</h3><ul><li>手册解释如下</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"> -L [bind_address:]port:host:hostport</span><br><span class="line"> -L [bind_address:]port:remote_socket</span><br><span class="line"> -L local_socket:host:hostport</span><br><span class="line"> -L local_socket:remote_socket</span><br><span class="line">         Specifies that connections to the given TCP port or Unix socket on the local (client) host are to be forwarded to the given host and port, or Unix socket, on the remote</span><br><span class="line">         side.  This works by allocating a socket to listen to either a TCP port on the local side, optionally bound to the specified bind_address, or to a Unix socket.  Whenever a</span><br><span class="line">         connection is made to the local port or socket, the connection is forwarded over the secure channel, and a connection is made to either host port hostport, or the Unix</span><br><span class="line">         socket remote_socket, from the remote machine.</span><br><span class="line"></span><br><span class="line">         Port forwardings can also be specified in the configuration file.  Only the superuser can forward privileged ports.  IPv6 addresses can be specified by enclosing the address</span><br><span class="line">         in square brackets.</span><br><span class="line"></span><br><span class="line">         By default, the local port is bound in accordance with the GatewayPorts setting.  However, an explicit bind_address may be used to bind the connection to a specific address.</span><br><span class="line">         The bind_address of “localhost” indicates that the listening port be bound for local use only, while an empty address or ‘*’ indicates that the port should be available from</span><br><span class="line">         all interfaces.</span><br><span class="line">...</span><br><span class="line"> -R [bind_address:]port:host:hostport</span><br><span class="line"> -R [bind_address:]port:local_socket</span><br><span class="line"> -R remote_socket:host:hostport</span><br><span class="line"> -R remote_socket:local_socket</span><br><span class="line"> -R [bind_address:]port</span><br><span class="line">         Specifies that connections to the given TCP port or Unix socket on the remote (server) host are to be forwarded to the local side.</span><br><span class="line"></span><br><span class="line">         This works by allocating a socket to listen to either a TCP port or to a Unix socket on the remote side.  Whenever a connection is made to this port or Unix socket, the con‐</span><br><span class="line">         nection is forwarded over the secure channel, and a connection is made from the local machine to either an explicit destination specified by host port hostport, or</span><br><span class="line">         local_socket, or, if no explicit destination was specified, ssh will act as a SOCKS 4/5 proxy and forward connections to the destinations requested by the remote SOCKS</span><br><span class="line">         client.</span><br><span class="line"></span><br><span class="line">         Port forwardings can also be specified in the configuration file.  Privileged ports can be forwarded only when logging in as root on the remote machine.  IPv6 addresses can</span><br><span class="line">         be specified by enclosing the address in square brackets.</span><br><span class="line"></span><br><span class="line">         By default, TCP listening sockets on the server will be bound to the loopback interface only.  This may be overridden by specifying a bind_address.  An empty bind_address,</span><br><span class="line">         or the address ‘*’, indicates that the remote socket should listen on all interfaces.  Specifying a remote bind_address will only succeed if the server&#x27;s GatewayPorts option</span><br><span class="line">         is enabled (see sshd_config(5)).</span><br><span class="line"></span><br><span class="line">         If the port argument is ‘0’, the listen port will be dynamically allocated on the server and reported to the client at run time.  When used together with -O forward the al‐</span><br><span class="line">         located port will be printed to the standard output.</span><br></pre></td></tr></table></figure><ul><li>用法</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">监听本地端口9229，转发给远程的9229端口</span></span><br><span class="line">ssh -L 9229:127.0.0.1:9229 admin@199.200.2.170</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">监听远程端口1234，转发给本地的5678端口</span></span><br><span class="line">ssh -R 1234:127.0.0.1:5678 admin@199.200.2.170</span><br></pre></td></tr></table></figure><h3 id="4-4-ssh登陆信息"><a href="#4-4-ssh登陆信息" class="headerlink" title="4.4. ssh登陆信息"></a>4.4. ssh登陆信息</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">=&gt; echo $SSH_CONNECTION</span><br><span class="line">172.22.72.133 56819 172.22.27.203 22</span><br></pre></td></tr></table></figure><h4 id="1-添加ssh登陆后执行命令"><a href="#1-添加ssh登陆后执行命令" class="headerlink" title="1) 添加ssh登陆后执行命令"></a>1) 添加ssh登陆后执行命令</h4><ul><li>修改<code>.bashrc</code>添加</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ssh远程登陆执行命令</span></span><br><span class="line">if [[ -n &quot;$SSH_CONNECTION&quot; ]] ; then</span><br><span class="line">    echo &quot;I&#x27;m ssh login&quot;</span><br><span class="line">fi</span><br></pre></td></tr></table></figure><h3 id="4-5-忽略known-hosts错误"><a href="#4-5-忽略known-hosts错误" class="headerlink" title="4.5. 忽略known_hosts错误"></a>4.5. 忽略<code>known_hosts</code>错误</h3><ul><li>配置到<code>~/.ssh/config</code>中</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"># 对单个服务器</span><br><span class="line">Host test-server</span><br><span class="line">    StrictHostKeyChecking no</span><br><span class="line">    UserKnownHostsFile /dev/null</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"># 对所有服务器</span><br><span class="line">Host *</span><br><span class="line">    StrictHostKeyChecking no</span><br><span class="line">    UserKnownHostsFile /dev/null</span><br></pre></td></tr></table></figure><h3 id="踩坑记-1"><a href="#踩坑记-1" class="headerlink" title="踩坑记"></a>踩坑记</h3><h4 id="1-低版本ssh连接失败"><a href="#1-低版本ssh连接失败" class="headerlink" title="(1) 低版本ssh连接失败"></a>(1) 低版本ssh连接失败</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">```</span><br><span class="line"></span><br><span class="line">- 修改`/etc/ssh/ssh_config`或`~/.ssh/config`，添加下面字段即可</span><br><span class="line"></span><br><span class="line">```conf</span><br><span class="line"># 对单个服务器</span><br><span class="line">Host test-server</span><br><span class="line">    # no matching host key type found. Their offer: ssh-rsa,ssh-dss</span><br><span class="line">    HostkeyAlgorithms +ssh-rsa</span><br><span class="line">    PubkeyAcceptedAlgorithms +ssh-rsa</span><br><span class="line">    # no matching key exchange method found. Their offer: diffie-hellman-group1-sha1,diffie-hellman-group14-sha1</span><br><span class="line">    KexAlgorithms +diffie-hellman-group1-sha1</span><br><span class="line">    # no matching cipher found. Their offer: aes128-cbc,3des-cbc,blowfish-cbc,aes192-cbc,aes256-cbc,rijndael128-cbc,rijndael192-cbc,rijndael256-cbc,rijndael-cbc@lysator.liu.se</span><br><span class="line">    Ciphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc</span><br><span class="line">    ...</span><br><span class="line"></span><br><span class="line"># 对所有服务器</span><br><span class="line">Host *</span><br><span class="line">    # no matching host key type found. Their offer: ssh-rsa,ssh-dss</span><br><span class="line">    HostkeyAlgorithms +ssh-rsa</span><br><span class="line">    PubkeyAcceptedAlgorithms +ssh-rsa</span><br><span class="line">    # no matching key exchange method found. Their offer: diffie-hellman-group1-sha1,diffie-hellman-group14-sha1</span><br><span class="line">    KexAlgorithms +diffie-hellman-group1-sha1</span><br><span class="line">    # no matching cipher found. Their offer: aes128-cbc,3des-cbc,blowfish-cbc,aes192-cbc,aes256-cbc,rijndael128-cbc,rijndael192-cbc,rijndael256-cbc,rijndael-cbc@lysator.liu.se</span><br><span class="line">    Ciphers aes128-ctr,aes192-ctr,aes256-ctr,aes128-cbc,3des-cbc</span><br></pre></td></tr></table></figure><h4 id="2-ssh首次登录总要等一会才提示密码框"><a href="#2-ssh首次登录总要等一会才提示密码框" class="headerlink" title="(2) ssh首次登录总要等一会才提示密码框"></a>(2) ssh首次登录总要等一会才提示密码框</h4><ul><li>原因是ssh去找主机名的DNS</li><li>快速解决是修改服务端的<code>/etc/ssh/sshd_config</code>，然后重启服务</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UseDNS no</span><br></pre></td></tr></table></figure><h2 id="5-压缩和解压缩命令"><a href="#5-压缩和解压缩命令" class="headerlink" title="5. 压缩和解压缩命令"></a>5. 压缩和解压缩命令</h2><h3 id="5-1-tar命令"><a href="#5-1-tar命令" class="headerlink" title="5.1. tar命令"></a>5.1. tar命令</h3><h4 id="5-1-1-参数解析"><a href="#5-1-1-参数解析" class="headerlink" title="5.1.1. 参数解析"></a>5.1.1. 参数解析</h4><ul><li><code>-c</code>: 建立压缩档案</li><li><code>-x</code>: 解压</li><li><code>-t</code>: 查看内容</li><li><code>-r</code>: 向压缩归档文件末尾追加文件</li><li><code>-u</code>: 更新原压缩包中的文件</li></ul><p>这五个是独立的命令，压缩解压都要用到其中一个，可以和别的命令连用但只能用其中一个。</p><ul><li><code>-z</code>: 有gzip属性的 tar.gz</li><li><code>-j</code>: 有bz2属性的 tar.bz2</li><li><code>-J</code>: tar.xz</li><li><code>-Z</code>: 有compress属性的 tar.Z</li><li><code>-v</code>: 显示所有过程</li><li><code>-O</code>: 将文件解开到标准输出</li></ul><p>这几个根据需要在压缩或解压档案时可选的。</p><ul><li><code>-f [tar_file_name]</code>: 必须，使用档案名字，多选项时，此参数为最后一个。</li><li><code>-C [dir_name]</code>: 解压到什么目录，压缩时的父目录</li></ul><h4 id="5-1-2-示例"><a href="#5-1-2-示例" class="headerlink" title="5.1.2. 示例"></a>5.1.2. 示例</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar -xzf xxx.tar.gz             # 解压tar.gz文件</span><br><span class="line">tar -xzvf xxx.tar.gz -C tmp     # 解压tar.gz文件显示过程，解压到tmp目录</span><br><span class="line">tar -czvf xxx.tar.gz -C tmp ./  # 将tmp目录下的所有文件压缩，以tmp为根目录</span><br></pre></td></tr></table></figure><h4 id="5-1-3-加密压缩"><a href="#5-1-3-加密压缩" class="headerlink" title="5.1.3. 加密压缩"></a>5.1.3. 加密压缩</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">使用openssl命令进行加密压缩</span></span><br><span class="line">tar -zvcf - -C xxx ./ | openssl des3 -salt -k &quot;xxx&quot; | dd of=xxx.des3</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解压</span></span><br><span class="line">dd if=xxx.des3 | openssl des3 -d -k &#x27;xxx&#x27; | tar -zxf - -C xxx/</span><br></pre></td></tr></table></figure><ul><li><font color="red"><strong>openssl在1.1.0版本有修改导致不兼容，可以用下面的方法</strong></font><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在OpenSSL 1.1.0中，我们从MD5更改为SHA-256。我们这样做是作为整体改变的一部分，以摆脱现在不安全和破碎的MD5算法。如果您有旧文件，请使用“-md md5”标志对其进行解密</span><br></pre></td></tr></table></figure></li></ul><h3 id="5-2-zip命令"><a href="#5-2-zip命令" class="headerlink" title="5.2. zip命令"></a>5.2. zip命令</h3><h4 id="5-2-1-压缩"><a href="#5-2-1-压缩" class="headerlink" title="5.2.1. 压缩"></a>5.2.1. 压缩</h4><p>压缩只会追加不会删除已经存在于zip文件中的文件</p><ul><li><code>-j</code>: 去除路径</li><li><code>-r</code>: 递归压缩所有文件</li><li><code>-m</code>: 打包后删除压缩的源文件</li><li><code>-x &lt;pattern&gt;</code>: 忽略某些文件，可以连续写多个</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">zip -r (filename.zip) (path)</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">去除路径</span></span><br><span class="line">zip -jr (filename.zip) (path)</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">排除zip和<span class="built_in">cap</span>压缩，-x可以连续写多个</span></span><br><span class="line">zip -r xxx.zip ./ -x &#x27;*.pcap*&#x27; -x &#x27;*.zip&#x27; -x &#x27;*.rar&#x27; -x &#x27;*.cap&#x27; -x &#x27;*.7z&#x27;</span><br></pre></td></tr></table></figure><h4 id="5-2-2-解压"><a href="#5-2-2-解压" class="headerlink" title="5.2.2. 解压"></a>5.2.2. 解压</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">unzip xxx.zip -d xxx</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解压特定文件</span></span><br><span class="line">unzip xxx.zip &quot;b/c&quot; -d xxx</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看文件列表</span></span><br><span class="line">unzip -l xxx.zip</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">指定编码</span></span><br><span class="line">unzip -O gbk (filename.zip) -d (path)</span><br></pre></td></tr></table></figure><ul><li>不加<code>-d</code>就解压到当前目录</li></ul><h2 id="6-e2label-修改卷标名称"><a href="#6-e2label-修改卷标名称" class="headerlink" title="6. e2label 修改卷标名称"></a>6. e2label 修改卷标名称</h2><p>分区为<code>ext2/ext3</code>类型使用</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">e2label /dev/(partition) &quot;(name)&quot;</span><br></pre></td></tr></table></figure><h2 id="7-readelf-查看二进制符号表"><a href="#7-readelf-查看二进制符号表" class="headerlink" title="7. readelf 查看二进制符号表"></a>7. readelf 查看二进制符号表</h2><h3 id="7-1-查看符号表"><a href="#7-1-查看符号表" class="headerlink" title="7.1. 查看符号表"></a>7.1. 查看符号表</h3><ul><li>查看有哪些二进制符号和对应的函数地址</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-s 符号表</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-W 符号名字显示全</span></span><br><span class="line">readelf -Ws xxxx</span><br></pre></td></tr></table></figure><h3 id="7-2-查看二进制依赖"><a href="#7-2-查看二进制依赖" class="headerlink" title="7.2. 查看二进制依赖"></a>7.2. 查看二进制依赖</h3><ul><li>会显示依赖的动态库路径</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">readelf -d xxx</span><br></pre></td></tr></table></figure><h2 id="8-objdump-导出汇编指令表"><a href="#8-objdump-导出汇编指令表" class="headerlink" title="8. objdump 导出汇编指令表"></a>8. objdump 导出汇编指令表</h2><p>导出二进制的汇编指令表，如果没有strip掉符号，还能看到每个函数的汇编指令和对应地址</p><ul><li><code>-D</code>: 展示所有段的汇编</li><li><code>-S</code>: 将代码内嵌到汇编中（前提是有符号）</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">objdump -DS xxxx &gt; xxx.dump</span><br></pre></td></tr></table></figure><h2 id="9-strace-查看系统调用"><a href="#9-strace-查看系统调用" class="headerlink" title="9. strace 查看系统调用"></a>9. strace 查看系统调用</h2><ul><li><code>-t</code>: 打印时间</li><li><code>-tt</code>: 打印时间，精确到微秒</li><li><code>-T</code>: 打印系统调用占用时间</li><li><code>-f</code>: 打印进程号，可针对多进程程序</li><li><code>-v</code>: 参数打全，不省略</li><li><code>-o file</code>: 结果输出到文件</li><li><code>-p [PID]</code>: 挂载到一个进程</li></ul><h3 id="9-1-查看单进程的系统调用，不重启进程"><a href="#9-1-查看单进程的系统调用，不重启进程" class="headerlink" title="9.1. 查看单进程的系统调用，不重启进程"></a>9.1. 查看单进程的系统调用，不重启进程</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">strace -p xxx</span><br></pre></td></tr></table></figure><h2 id="10-tree-查看文件树"><a href="#10-tree-查看文件树" class="headerlink" title="10. tree 查看文件树"></a>10. tree 查看文件树</h2><ul><li><code>-L n</code>: 目录深度</li></ul><h2 id="11-sshfs-挂载远程目录"><a href="#11-sshfs-挂载远程目录" class="headerlink" title="11. sshfs 挂载远程目录"></a>11. sshfs 挂载远程目录</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">和mount一样，将远程的/aaa挂载到本地~/xxx</span></span><br><span class="line">sshfs xxx@xxx.xxx.xxx.xxx:/aaa ~/xxx</span><br></pre></td></tr></table></figure><h2 id="12-cmake-跨平台编译命令"><a href="#12-cmake-跨平台编译命令" class="headerlink" title="12. cmake 跨平台编译命令"></a>12. cmake 跨平台编译命令</h2><p>CMakeLists.txt编写参见<a href="/blogs/2019-06-03-makefile/#CMakeLists">CMakeLists.txt</a></p><h3 id="12-1-基本使用命令"><a href="#12-1-基本使用命令" class="headerlink" title="12.1 基本使用命令"></a>12.1 基本使用命令</h3><ul><li><code>-DCMAKE_BUILD_TYPE</code><ul><li><code>STRING=Debug</code>: 在linux上会编译出<code>libxxxd.so</code></li><li><code>STRING=Release</code></li><li><code>STRING=MinSizeRel</code></li><li><code>STRING=RelWithDebInfo</code>: 在linux上会编译出<code>libxxxrd.so</code></li></ul></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">指定build目录生成工程</span></span><br><span class="line">cmake -DCMAKE_BUILD_TYPE:STRING=Debug -B build/</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">vscode常用的编译命令</span></span><br><span class="line">cmake --no-warn-unused-cli -DCMAKE_EXPORT_COMPILE_COMMANDS:BOOL=TRUE -DCMAKE_BUILD_TYPE:STRING=Debug -H . -B build/ -G &quot;Visual Studio 14 2015&quot; -A win32</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">编译指定目标文件，会自动编译依赖，4线程编译</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">不指定target编译所有</span></span><br><span class="line">cmake --build build/ --target xxx -j 4</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">清理工程，相当于make clean</span></span><br><span class="line">cmake --build build/ --target clean -j 4</span><br></pre></td></tr></table></figure><h2 id="13-gdb-c-c-单步调试工具"><a href="#13-gdb-c-c-单步调试工具" class="headerlink" title="13. gdb c&#x2F;c++单步调试工具"></a>13. gdb c&#x2F;c++单步调试工具</h2><h3 id="13-1-gdb内部基本使用命令"><a href="#13-1-gdb内部基本使用命令" class="headerlink" title="13.1 gdb内部基本使用命令"></a>13.1 gdb内部基本使用命令</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">start                       # 开始调试,停在第一行代码处,(gdb)start</span><br><span class="line">l                           #list的缩写查看源代码,(gdb) l [number/function]</span><br><span class="line">b &lt;lines&gt;                   # b: Breakpoint的简写，设置断点。(gdb) b 10</span><br><span class="line">b &lt;func&gt;                    # b: Breakpoint的简写，设置断点。(gdb) b main</span><br><span class="line">b filename:[line/function]  # b:在文件filename的某行或某个函数处设置断点</span><br><span class="line">i breakpoints               # :info 的简写。(gdb)i breakpoints</span><br><span class="line">d [bpNO]                    # d: Delete breakpoint的简写，删除指定编号的某个断点，或删除所有断点。断点编号从1开始递增。 (gdb)d 1</span><br><span class="line">s                           # s: step执行一行源程序代码，如果此行代码中有函数调用，则进入该函数；(gdb) s</span><br><span class="line">n                           # n: next执行一行源程序代码，此行代码中的函数调用也一并执行。(gdb) n</span><br><span class="line">r                           # Run的简写，运行被调试的程序。如果此前没有下过断点，则执行完整个程序；如果有断点，则程序暂停在第一个可用断点处。(gdb) r</span><br><span class="line">c                           # Continue的简写，继续执行被调试程序，直至下一个断点或程序结束。(gdb) c</span><br><span class="line">finish                      # 函数结束</span><br><span class="line">p [var]                     # Print的简写，显示指定变量（临时变量或全局变量 例如 int a）的值。(gdb) p a</span><br><span class="line">display [var]               # display，设置想要跟踪的变量(例如 int a)。(gdb) display a</span><br><span class="line">undisplay [varnum]          # undisplay取消对变量的跟踪，被跟踪变量用整型数标识。(gdb) undisplay 1</span><br><span class="line">set args                    # 可指定运行时参数。(gdb)set args 10 20</span><br><span class="line">show args                   # 查看运行时参数。</span><br><span class="line">q                           # Quit的简写，退出GDB调试环境。(gdb) q</span><br><span class="line">help [cmd]                  # GDB帮助命令，提供对GDB名种命令的解释说明。如果指定了“命令名称”参数，则显示该命令的详细说明；如果没有指定参数，则分类显示所有GDB命令，供用户进一步浏览和查询。(gdb)help</span><br><span class="line">回车                        # 重复前面的命令，(gdb)回车</span><br></pre></td></tr></table></figure><h3 id="13-2-可以看代码版本-cgdb"><a href="#13-2-可以看代码版本-cgdb" class="headerlink" title="13.2. 可以看代码版本 cgdb"></a>13.2. 可以看代码版本 cgdb</h3><h4 id="1-快捷键"><a href="#1-快捷键" class="headerlink" title="1) 快捷键"></a>1) 快捷键</h4><p><strong>gdb窗口</strong></p><ul><li><code>Esc</code>: 转到代码窗口</li></ul><p><strong>代码窗口</strong></p><ul><li><code>i</code>: 转到gdb窗口</li><li><code>o</code>: 打开源码文件列表，<code>/</code>搜索</li><li><code>j</code>: 光标下移</li><li><code>k</code>: 光标上移</li><li><code>Space</code>: 当前行打断点</li><li><code>=</code>: 放大代码窗口一行</li><li><code>-</code>: 减小代码窗口一行</li><li><code>Shift + +</code>: 放大窗口一大段</li><li><code>Shift + _</code>: 缩小窗口一大段</li></ul><h3 id="13-3-函数堆栈"><a href="#13-3-函数堆栈" class="headerlink" title="13.3. 函数堆栈"></a>13.3. 函数堆栈</h3><ul><li><code>bt</code>: 查看当前堆栈</li><li><code>frame &lt;n&gt;</code>: 跳转到当前哪一层堆栈</li><li><code>up &lt;n&gt;</code>: 向上跳几层</li><li><code>down &lt;n&gt;</code>: 向下跳几层</li></ul><h3 id="13-4-带参数的执行"><a href="#13-4-带参数的执行" class="headerlink" title="13.4. 带参数的执行"></a>13.4. 带参数的执行</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gdb --args /path/to/run a b</span><br></pre></td></tr></table></figure><h3 id="13-5-gdbserver远程调试"><a href="#13-5-gdbserver远程调试" class="headerlink" title="13.5. gdbserver远程调试"></a>13.5. gdbserver远程调试</h3><ul><li>在远程服务器执行</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gdbserver 0.0.0.0:6666 --attach 14614</span><br></pre></td></tr></table></figure><ul><li>vscode配置文件</li></ul><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="comment">// Use IntelliSense to learn about possible attributes.</span></span><br><span class="line">    <span class="comment">// Hover to view descriptions of existing attributes.</span></span><br><span class="line">    <span class="comment">// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span></span><br><span class="line">    <span class="attr">&quot;version&quot;</span><span class="punctuation">:</span> <span class="string">&quot;0.2.0&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;configurations&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">        <span class="punctuation">&#123;</span></span><br><span class="line">            <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Attach remote server&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;cppdbg&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;request&quot;</span><span class="punctuation">:</span> <span class="string">&quot;launch&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;program&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;workspaceFolder&#125;/nginx-1.21.4/objs/nginx&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;miDebuggerServerAddress&quot;</span><span class="punctuation">:</span> <span class="string">&quot;x.x.x.x:6666&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;cwd&quot;</span><span class="punctuation">:</span> <span class="string">&quot;$&#123;workspaceFolder&#125;&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;MIMode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;gdb&quot;</span><span class="punctuation">,</span></span><br><span class="line">            <span class="attr">&quot;setupCommands&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Enable pretty-printing for gdb&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;-enable-pretty-printing&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;ignoreFailures&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">                <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">                <span class="punctuation">&#123;</span></span><br><span class="line">                    <span class="attr">&quot;description&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Set Disassembly Flavor to Intel&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;text&quot;</span><span class="punctuation">:</span> <span class="string">&quot;-gdb-set disassembly-flavor intel&quot;</span><span class="punctuation">,</span></span><br><span class="line">                    <span class="attr">&quot;ignoreFailures&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span></span><br><span class="line">                <span class="punctuation">&#125;</span></span><br><span class="line">            <span class="punctuation">]</span></span><br><span class="line">        <span class="punctuation">&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h3 id="13-6-gdb忽略某个信号不打断"><a href="#13-6-gdb忽略某个信号不打断" class="headerlink" title="13.6. gdb忽略某个信号不打断"></a>13.6. gdb忽略某个信号不打断</h3><ul><li>经常遇到gdb调试进去后，因为某些信号打断，又可以继续，使用下面命令跳过</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">gdb&gt; </span><span class="language-bash">handle SIGINT nostop</span></span><br></pre></td></tr></table></figure><h3 id="13-7-gdb挂载进程调试"><a href="#13-7-gdb挂载进程调试" class="headerlink" title="13.7. gdb挂载进程调试"></a>13.7. gdb挂载进程调试</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gdb /path/to/exec pid</span><br></pre></td></tr></table></figure><h2 id="14-tmux"><a href="#14-tmux" class="headerlink" title="14. tmux"></a>14. <span id="tmux">tmux</span></h2><h3 id="快捷键"><a href="#快捷键" class="headerlink" title="快捷键"></a>快捷键</h3><ul><li>工具特定命令前缀为<code>Ctrl + b</code></li></ul><p><strong>session操作</strong></p><ul><li><code>tmux ls</code>: 查看session列表</li><li><code>prefix, d</code>: 离开当前session，但是session继续跑</li><li><code>tmux a -t &lt;session-name&gt;</code>: 重新回到一个session</li><li><code>tmux kill-session -t &lt;session-name&gt;</code>: 杀死一个session</li></ul><p><strong>窗口操作</strong></p><ul><li><code>prefix, c</code>: 创建新窗口</li><li><code>prefix, n</code>: 下一个窗口</li><li><code>prefix, p</code>: 上一个窗口</li><li><code>prefix, l</code>: 进入前一个操作的窗口</li><li><code>prefix, w</code>: 列出窗口进行选择</li><li><code>prefix, ,</code>: 重命名当前窗口</li><li><code>prefix, Shift + &amp;</code>: 删除当前窗口</li></ul><p><strong>窗格操作</strong></p><ul><li><code>prefix, &lt;方向键&gt;</code>: 切换到相应窗格</li><li><code>prefix, Shift + &quot;</code>: 纵向分屏</li><li><code>prefix, Shift + %</code>: 横向分屏</li><li><code>prefix, Shift + !</code>: 将当前窗格新起一个窗口存放</li><li><code>prefix, Ctrl + &lt;方向键&gt;</code>: 朝相应方向移动边界</li><li><code>prefix, x</code>: 关闭当前窗格</li><li><code>prefix, z</code>: 当前窗格放大（专注，切换窗格就恢复了）</li><li><code>prefix, ;</code>: 切换到上一个窗格</li><li><code>prefix, o</code>: 切换到下一个窗格</li><li><code>prefix, [</code>: 进入copy mode</li><li><code>prefix, Ctrl + o</code>: 顺时针切换各个窗格</li><li><code>prefix, m</code>: 标记窗格，配合下面命令交换窗格</li><li><code>prefix, :swapp</code>: 切换窗格</li></ul><p><strong>copy mode</strong></p><ul><li><code>Ctrl + s</code>: 向下查找，输入字符串回车后，使用n和N选择下一个或者上一个</li><li><code>Ctrl + r</code>: 向上查找</li></ul><h2 id="15-fzf"><a href="#15-fzf" class="headerlink" title="15. fzf"></a>15. fzf</h2><h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><ol><li>安装完成后，将下面配置加到<code>.zshrc</code>或者<code>.bashrc</code>中</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">40%屏显示非全屏，展示反向（输入框在上面，文件在下面正序），文件在右侧展示前50行</span></span><br><span class="line">export FZF_DEFAULT_OPTS=&quot;--height 40% --layout=reverse --preview &#x27;head -n 50 &#123;&#125; 2&gt;/dev/null&#x27;&quot;</span><br></pre></td></tr></table></figure><h2 id="16-ctags"><a href="#16-ctags" class="headerlink" title="16. ctags"></a>16. <span id="ctags">ctags</span></h2><h3 id="16-1-C-C"><a href="#16-1-C-C" class="headerlink" title="16.1. C&#x2F;C++"></a>16.1. C&#x2F;C++</h3><h4 id="基本选项"><a href="#基本选项" class="headerlink" title="基本选项"></a>基本选项</h4><ul><li><code>-I xxx</code>: 许多函数定义最后有一个<code>__THROW</code>类似的，ctags将解析出错，加上此选项会忽略xxx</li><li><code>--fields=+iaS</code>:</li><li><code>--extra=+q</code></li><li><code>--c-kinds=+p</code></li></ul><h4 id="添加系统头文件支持"><a href="#添加系统头文件支持" class="headerlink" title="添加系统头文件支持"></a>添加系统头文件支持</h4><ul><li>执行以下命令生成系统头文件的tags</li><li>添加<code>set tags+=~/.vim/systags</code>包含系统头文件tags</li></ul><p>系统头文件检索列表，里面尖括号字段根据系统适配</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">/usr/include</span><br><span class="line">/usr/include/linux</span><br><span class="line">/usr/include/net</span><br><span class="line">/usr/include/netinet</span><br><span class="line">/usr/include/arpa</span><br><span class="line">/usr/include/c++/&lt;version&gt;</span><br><span class="line">/usr/include/&lt;sys-version&gt;-linux-gnu/sys</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">把上面列表文件都扫出来，加到files.list里面</span></span><br><span class="line">find xxx -maxdepth 1 -type f &gt;&gt; files.list</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">ctags根据files.list生成tags文件</span></span><br><span class="line">ctags -I __wur -I __THROW -I __THROWNL -I __attribute_pure__ -I __nonnull -I __attribute__ --file-scope=yes --language-force=C++ --links=yes --c-kinds=+p --c++-kinds=+p --fields=+iaS --extra=+q -f ~/.vim/systags -L files.list</span><br></pre></td></tr></table></figure><h3 id="16-2-php支持"><a href="#16-2-php支持" class="headerlink" title="16.2. php支持"></a>16.2. php支持</h3><p>转载自 <a target="_blank" rel="noopener" href="https://www.cnblogs.com/longdouhzt/archive/2013/04/15/3022908.html">https://www.cnblogs.com/longdouhzt/archive/2013/04/15/3022908.html</a></p><ol><li>添加以下命令到<code>~/.bashrc</code>或者<code>~/.zshrc</code>等当前使用的bash的起始配置文件中，可以使用phptags来生成php的tags文件</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">alias phptags=&#x27;ctags --langmap=php:.engine.inc.module.theme.php  --php-kinds=cdf  --languages=php&#x27;</span><br></pre></td></tr></table></figure><ol start="2"><li>添加以下配置到<code>~/.ctags</code>中，添加一些匹配规则</li></ol><figure class="highlight vim"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">--regex-php=/^[ \t]*[(private|public|static)( \t)]*<span class="keyword">function</span>[ \t]+([A-Za-z0-<span class="number">9</span>_]+)[ \t]*\(/\<span class="number">1</span>/<span class="keyword">f</span>, <span class="keyword">function</span>, functions/</span><br><span class="line">--regex-php=/^[ \t]*[(private|public|static)]+[ \t]+\$([A-Za-z0-<span class="number">9</span>_]+)[ \t]*/\<span class="number">1</span>/<span class="keyword">p</span>, property, properties/</span><br><span class="line">--regex-php=/^[ \t]*(const)[ \t]+([A-Za-z0-<span class="number">9</span>_]+)[ \t]*/\<span class="number">2</span>/d, const, constants/</span><br></pre></td></tr></table></figure><ol start="3"><li>到工程目录下<code>phptags -R</code>即可生成相应tags</li></ol><h2 id="17-gcc"><a href="#17-gcc" class="headerlink" title="17. gcc"></a>17. gcc</h2><h3 id="17-1-选项解释"><a href="#17-1-选项解释" class="headerlink" title="17.1. 选项解释"></a>17.1. 选项解释</h3><ul><li><code>-s</code>: strip掉所有符号</li><li><code>-fsanitize=address</code>: 监听内存泄漏，需要同时加上<code>-lasan</code>并且保证已经安装libasan</li><li><code>-fno-omit-frame-pointer</code></li><li><code>-Werror</code>: 所有warning当作error处理</li></ul><h3 id="17-2-查看预定义宏"><a href="#17-2-查看预定义宏" class="headerlink" title="17.2. 查看预定义宏"></a>17.2. 查看预定义宏</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">=&gt; gcc -dM -E - &lt; /dev/null</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">define __SSP_STRONG__ 3</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">define __DBL_MIN_EXP__ (-1021)</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">define __UINT_LEAST16_MAX__ 0xffff</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><h3 id="17-3-单函数优化级别设定"><a href="#17-3-单函数优化级别设定" class="headerlink" title="17.3. 单函数优化级别设定"></a>17.3. 单函数优化级别设定</h3><ul><li>全局优化级别设定后，可以在编译时指定单个函数的优化级别</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">static</span> <span class="type">int</span> <span class="title">ip_rcv_finish</span><span class="params">(<span class="keyword">struct</span> net *net, <span class="keyword">struct</span> sock *sk, <span class="keyword">struct</span> sk_buff *skb)</span> __<span class="title">attribute__</span><span class="params">((optimize(<span class="string">&quot;O0&quot;</span>)))</span></span>;</span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">ip_rcv_finish</span><span class="params">(<span class="keyword">struct</span> net *net, <span class="keyword">struct</span> sock *sk, <span class="keyword">struct</span> sk_buff *skb)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>或者指定一批，<code>pragma</code>后面的函数都会应用此优化</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">pragma</span> GCC optimize(<span class="string">&quot;O0&quot;</span>)</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">int</span> <span class="title">ip_rcv_finish</span><span class="params">(<span class="keyword">struct</span> net *net, <span class="keyword">struct</span> sock *sk, <span class="keyword">struct</span> sk_buff *skb)</span> </span>&#123;</span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="17-4-实例"><a href="#17-4-实例" class="headerlink" title="17.4. 实例"></a>17.4. 实例</h3><h4 id="1-编译动态库"><a href="#1-编译动态库" class="headerlink" title="1) 编译动态库"></a>1) 编译动态库</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -shared -fPIC main.cpp -o main.so</span><br></pre></td></tr></table></figure><h2 id="18-firewalld-防火墙"><a href="#18-firewalld-防火墙" class="headerlink" title="18. firewalld 防火墙"></a>18. firewalld 防火墙</h2><h3 id="18-1-选项解释"><a href="#18-1-选项解释" class="headerlink" title="18.1. 选项解释"></a>18.1. 选项解释</h3><ul><li><code>--permanent</code>: 永久生效，加了这个选项，需要执行reload才能生效；不加，会立即生效，但是reload后会消失</li></ul><h3 id="18-2-基本操作"><a href="#18-2-基本操作" class="headerlink" title="18.2. 基本操作"></a>18.2. 基本操作</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重载防火墙规则</span></span><br><span class="line">firewall-cmd --reload</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">重启防火墙服务</span></span><br><span class="line">firewall-cmd --complete-reload</span><br></pre></td></tr></table></figure><h3 id="18-3-区域操作"><a href="#18-3-区域操作" class="headerlink" title="18.3. 区域操作"></a>18.3. 区域操作</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 查看区域 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看当前使用的区域，返回每个网卡对应的区域</span></span><br><span class="line">firewall-cmd --get-active-zones</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看所有支持的区域</span></span><br><span class="line">firewall-cmd --get-zones</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看网卡对应的区域</span></span><br><span class="line">firewall-cmd --get-zone-of-interface=eth0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看默认区域</span></span><br><span class="line">firewall-cmd --get-default-zone</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看区域所有配置，不加zone返回默认区域</span></span><br><span class="line">firewall-cmd --zone=public --list-all</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 编辑区域 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将一个接口加到public区域内，永久生效加上--permanent然后reload</span></span><br><span class="line">firewall-cmd --zone=public --add-interface=eth0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置默认区域，永久生效加上--permanent然后reload</span></span><br><span class="line">firewall-cmd --get-default-zone</span><br></pre></td></tr></table></figure><h3 id="18-4-服务操作"><a href="#18-4-服务操作" class="headerlink" title="18.4. 服务操作"></a>18.4. 服务操作</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 查看服务 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">列举服务，不加zone列举默认区域</span></span><br><span class="line">firewall-cmd --zone=work --list-services</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看支持的服务</span></span><br><span class="line">firewall-cmd --get-services</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 新增服务 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">允许smtp服务，永久生效加上--permanent然后reload</span></span><br><span class="line">firewall-cmd --zone=work --add-service=smtp</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 删除服务 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">删除smtp服务，永久生效加上--permanent然后reload</span></span><br><span class="line">firewall-cmd --zone=work --remove-service=smtp</span><br></pre></td></tr></table></figure><h3 id="18-5-端口操作"><a href="#18-5-端口操作" class="headerlink" title="18.5. 端口操作"></a>18.5. 端口操作</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 查看服务 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">列举服务，不加zone列举默认区域</span></span><br><span class="line">firewall-cmd --zone=work --list-ports</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 新增服务 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">允许22端口，永久生效加上--permanent然后reload</span></span><br><span class="line">firewall-cmd --zone=work --add-port=22/tcp</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 删除服务 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">删除22端口，永久生效加上--permanent然后reload</span></span><br><span class="line">firewall-cmd --zone=work --remove-port=22/tcp</span><br></pre></td></tr></table></figure><h3 id="18-6-直接操作"><a href="#18-6-直接操作" class="headerlink" title="18.6. 直接操作"></a>18.6. 直接操作</h3><ul><li>这个操作和firewalld原生的不在一起，如果firewalld放开了，这里禁止了，无法访问</li><li>如果firewalld禁止了，这里放开了，同样无法访问</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">firewall-cmd --direct -add-rule ipv4 filter INPUT 0 -p tcp --dport 9000 -j accept</span><br></pre></td></tr></table></figure><h2 id="19-jq-linux的json解析工具"><a href="#19-jq-linux的json解析工具" class="headerlink" title="19. jq linux的json解析工具"></a>19. jq linux的json解析工具</h2><h3 id="1-几种基本用法"><a href="#1-几种基本用法" class="headerlink" title="1. 几种基本用法"></a>1. 几种基本用法</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">检查key是否存在</span></span><br><span class="line">=&gt; echo &#x27;&#123;&quot;a&quot;:1&#125;&#x27; | jq &#x27;has(&quot;b&quot;)&#x27;</span><br><span class="line">false</span><br><span class="line">=&gt; echo &#x27;&#123;&quot;a&quot;:1&#125;&#x27; | jq &#x27;has(&quot;a&quot;)&#x27;</span><br><span class="line">true</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">取值</span></span><br><span class="line">=&gt; echo &#x27;&#123;&quot;a&quot;:1&#125;&#x27; | jq &#x27;.&#x27;</span><br><span class="line">1</span><br><span class="line">=&gt; echo &#x27;&#123;&quot;a&quot;:&quot;1&quot;&#125;&#x27; | jq &#x27;.a&#x27;</span><br><span class="line">&quot;1&quot;</span><br></pre></td></tr></table></figure><h2 id="20-iotop-磁盘占用统计工具"><a href="#20-iotop-磁盘占用统计工具" class="headerlink" title="20. iotop 磁盘占用统计工具"></a>20. iotop 磁盘占用统计工具</h2><h3 id="1-几种基本用法-1"><a href="#1-几种基本用法-1" class="headerlink" title="1. 几种基本用法"></a>1. 几种基本用法</h3><ul><li>需要使用root权限</li><li>类似与top，不需要跟参数</li></ul><p><strong>统计中快捷键</strong></p><ul><li><code>o</code>: 仅显示占用io的进程</li><li><code>a</code>: 显示累计数据</li><li><code>shift + P</code>: 只显示进程，不显示线程，默认显示所有线程</li><li>使用左右方向键来选择排序的列</li></ul><h2 id="21-图片操作工具-imagemagick"><a href="#21-图片操作工具-imagemagick" class="headerlink" title="21. 图片操作工具 imagemagick"></a>21. 图片操作工具 imagemagick</h2><h3 id="21-1-图片转pdf"><a href="#21-1-图片转pdf" class="headerlink" title="21.1. 图片转pdf"></a>21.1. 图片转pdf</h3><ul><li>按照图片名字顺序生成pdf</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">convert *.jpg +compress foo.pdf</span><br></pre></td></tr></table></figure><h3 id="21-2-pdf转图片"><a href="#21-2-pdf转图片" class="headerlink" title="21.2. pdf转图片"></a>21.2. pdf转图片</h3><ul><li>执行了下面命令后，就会生成 image_name-0.jpg，image_name-1.jpg等等图片，数目由PDF页数决定。</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">convert pdf_name.pdf image_name.jpg</span><br></pre></td></tr></table></figure><p><strong>额外的参数</strong></p><ul><li><code>-resize 1800x</code>: 指定生成的像素大小，越大生成的图片越大，转化的时间越久</li><li><code>-density 150</code>: 参数指定密度，具体含义再查</li><li><code>-quality 100</code>: 指定生成图片的质量</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">convert -resize 1800x -density 150 -quality 100 pdf_name.pdf image_name.jpg</span><br></pre></td></tr></table></figure><h3 id="21-3-gif和图片转换"><a href="#21-3-gif和图片转换" class="headerlink" title="21.3. gif和图片转换"></a>21.3. gif和图片转换</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">gif转jpg</span></span><br><span class="line">=&gt; convert test.gif test.jpg</span><br><span class="line">=&gt; ls</span><br><span class="line">test-0.jpg   test-11.jpg  test-13.jpg  test-15.jpg  test-17.jpg  test-2.jpg  test-4.jpg  test-6.jpg  test-8.jpg  test.gif</span><br><span class="line">test-10.jpg  test-12.jpg  test-14.jpg  test-16.jpg  test-1.jpg   test-3.jpg  test-5.jpg  test-7.jpg  test-9.jpg</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">jpg转gif</span></span><br><span class="line">=&gt; convert test-*.jpg aaa.gif</span><br></pre></td></tr></table></figure><h3 id="21-4-图片信息查看"><a href="#21-4-图片信息查看" class="headerlink" title="21.4. 图片信息查看"></a>21.4. 图片信息查看</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">=&gt; identify -verbose misc2.jpg</span><br><span class="line">Image:</span><br><span class="line">  Filename: misc2.jpg</span><br><span class="line">  Permissions: rw-r--r--</span><br><span class="line">  Format: JPEG (Joint Photographic Experts Group JFIF format)</span><br><span class="line">  Mime type: image/jpeg</span><br><span class="line">  Class: DirectClass</span><br><span class="line">  Geometry: 1366x768+0+0</span><br><span class="line">  Resolution: 96x96</span><br><span class="line">  Print size: 14.2292x8</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h2 id="22-模拟网络延迟-tc"><a href="#22-模拟网络延迟-tc" class="headerlink" title="22. 模拟网络延迟 tc"></a>22. 模拟网络延迟 tc</h2><ul><li>局限就是只能对某一个网卡设置，不能设定规则来指针对ip和端口</li></ul><h3 id="22-1-基本操作"><a href="#22-1-基本操作" class="headerlink" title="22.1. 基本操作"></a>22.1. 基本操作</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 增加延迟 ##########</span></span></span><br><span class="line">tc qdisc add dev eth0 root netem delay 100ms</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 删除规则 ##########</span></span></span><br><span class="line">tc qdisc del dev eth0 root</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### 查询规则 ##########</span></span></span><br><span class="line">tc -s qdisc ls dev eth0</span><br></pre></td></tr></table></figure><h2 id="23-ltrace-跟踪库函数调用"><a href="#23-ltrace-跟踪库函数调用" class="headerlink" title="23. ltrace 跟踪库函数调用"></a>23. ltrace 跟踪库函数调用</h2><h3 id="23-1-选项"><a href="#23-1-选项" class="headerlink" title="23.1 选项"></a>23.1 选项</h3><ul><li><code>-r</code>: 显示运行时间，<code>0.000123</code></li><li><code>-t</code>: 和<code>-r</code>不能同时用，显示当前时间，<code>23:12:11</code></li><li><code>-tt</code>: 和<code>-r</code>不能同时用，显示当前时间，<code>23:12:11.345678</code></li><li><code>-ttt</code>: 和<code>-r</code>不能同时用，显示当前时间戳，<code>1645024757.123456</code></li><li><code>-T</code>: 显示调用花费的时间，在函数调用返回值后面用<code>&lt;&gt;</code>包裹</li><li><code>-i</code>: 显示函数的地址</li><li><code>-c</code>: 显示统计数据，表格形式</li><li><code>-S</code>: 将系统调用显示出来，使用<code>SYS_</code>作为前缀</li><li><code>-p [PID]</code>: 挂载到一个进程</li></ul><h3 id="23-2-实例"><a href="#23-2-实例" class="headerlink" title="23.2 实例"></a>23.2 实例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">监听一段时间的5623的函数调用次数，需要ctrl c停止监听后才显示结果</span></span><br><span class="line">=&gt; ltrace -p 5623 -c</span><br><span class="line">^C% time     seconds  usecs/call     calls      function</span><br><span class="line">------ ----------- ----------- --------- --------------------</span><br><span class="line"> 36.20    0.151489        2913        52 __errno_location</span><br><span class="line"> 29.99    0.125516        5229        24 epoll_wait</span><br><span class="line"> 24.01    0.100467        2954        34 clock_gettime</span><br><span class="line">  5.33    0.022294        2786         8 pthread_mutex_lock</span><br><span class="line">  4.47    0.018724        2340         8 pthread_mutex_unlock</span><br><span class="line">------ ----------- ----------- --------- --------------------</span><br><span class="line">100.00    0.418490                   126 total</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">显示系统调用并显示各个函数的调用耗时</span></span><br><span class="line">＝&gt; ltrace -t -S -T ./run</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">省略若干行</span></span><br><span class="line">...</span><br><span class="line">23:36:12 _ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEED1Ev(0x5714c8aed8, 0, 0, 0x5714c79010) = 0x5714c8aee8 &lt;0.001116&gt;</span><br><span class="line">23:36:12 _ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEED1Ev(0x5714c8aeb8, 0x5714c8aee8, 0, 0x5714c79010) = 0x7abb140060 &lt;0.001756&gt;</span><br><span class="line">23:36:12 _ZdlPvm(0x5714c8aeb0, 224, 0, 0x5714c79010)                 = 0x7abb140060 &lt;0.001005&gt;</span><br><span class="line">23:36:12 _ZdlPvm(0x5714c8b110, 720, 1, 0x7fe51ecda0)                 = 0x7abb140060 &lt;0.000966&gt;</span><br><span class="line">23:36:12 _ZdlPvm(0x5714c8b740, 16, 1, 0x5714c8b740)                  = 0x7abb140060 &lt;0.000864&gt;</span><br><span class="line">23:36:12 _ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEED1Ev(0x5714c8b668, 0, 0, 0x5714c79010) = 0x5714c8b678 &lt;0.001675&gt;</span><br><span class="line">23:36:12 _ZdlPvm(0x5714c8b650, 232, 1, 0x7fe51ecfc0)                 = 0x7abb140060 &lt;0.000936&gt;</span><br><span class="line">23:36:12 _ZNSt7__cxx1112basic_stringIcSt11char_traitsIcESaIcEED1Ev(0x5714c8b768, 0, 0, 0x5714c79010) = 0x5714c8b778 &lt;0.000870&gt;</span><br><span class="line">23:36:12 _ZdlPvm(0x5714c8b760, 64, 1, 0x5714c79010)                  = 0x7abb140060 &lt;0.000934&gt;</span><br><span class="line">23:36:12 memset(0x5714c8b7b0, &#x27;\0&#x27;, 104)                             = 0x5714c8b7b0 &lt;0.001023&gt;</span><br><span class="line">23:36:12 _ZdlPvm(0x5714c8b7b0, 104, 13, 0x5714c8b7e0)                = 0x7abb140060 &lt;0.000877&gt;</span><br><span class="line">23:36:12 SYS_exit_group(0 &lt;no return ...&gt;</span><br><span class="line">23:36:12 +++ exited (status 0) +++</span><br></pre></td></tr></table></figure><h2 id="24-dmidecode-获取硬件信息"><a href="#24-dmidecode-获取硬件信息" class="headerlink" title="24. dmidecode 获取硬件信息"></a>24. dmidecode 获取硬件信息</h2><h3 id="24-1-获取内存信息"><a href="#24-1-获取内存信息" class="headerlink" title="24.1. 获取内存信息"></a>24.1. 获取内存信息</h3><ul><li>可以获取到有几个插槽，每个插槽内存信息（包括频率、大小、电压、类型等）</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">=&gt; sudo dmidecode -t memory</span><br></pre></td></tr></table></figure><h2 id="25-nc-网络链接工具"><a href="#25-nc-网络链接工具" class="headerlink" title="25. nc 网络链接工具"></a>25. nc 网络链接工具</h2><h3 id="25-1-选项详解"><a href="#25-1-选项详解" class="headerlink" title="25.1. 选项详解"></a>25.1. 选项详解</h3><ul><li><code>-l</code>: 监听</li><li><code>-p [port]</code>: 本地端口，监听状态就绑定这个端口，非监听状态就是使用此端口发送</li><li><code>-v</code>: 显示输出，会打印一些连接过程和错误信息</li><li><code>-u</code>: udp模式，默认是tcp</li><li><code>-n</code>: 不翻译ip到hostname</li><li><code>-s</code>: 监听地址，默认监听所有地址</li><li><code>-w [second]</code>: 连接超时时间，单位秒</li><li><code>-z</code>: 测试模式，用于扫描，连接成功就断开，加上<code>-v</code>会显示结果</li></ul><h3 id="25-2-基本用法"><a href="#25-2-基本用法" class="headerlink" title="25.2. 基本用法"></a>25.2. 基本用法</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### tcp ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">服务端</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">监听0.0.0.0:1234，只处理一个连接，客户端连上后关闭就退出</span></span><br><span class="line">nc -l -p 1234</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">客户端</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">测试监听的端口</span></span><br><span class="line">nc -vz 127.0.0.1 1234</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">扫描ip是否有端口开放，无超时时间，如果服务端不给回包就一直发</span></span><br><span class="line">nc -vz 127.0.0.1 1-1024</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">扫描ip是否有端口开放，每个连接超时1s</span></span><br><span class="line">nc -vz -w 1 127.0.0.1 1-1024</span><br></pre></td></tr></table></figure><h2 id="26-curl-网络请求工具"><a href="#26-curl-网络请求工具" class="headerlink" title="26. curl 网络请求工具"></a>26. curl 网络请求工具</h2><p>参考: <a target="_blank" rel="noopener" href="https://blog.csdn.net/angle_chen123/article/details/120675472">https://blog.csdn.net/angle_chen123/article/details/120675472</a></p><h3 id="26-1-选项解释"><a href="#26-1-选项解释" class="headerlink" title="26.1. 选项解释"></a>26.1. 选项解释</h3><ul><li><code>-X [proto]</code>: 指定协议，可选<code>POST/GET/HEAD/DELETE/PUT/PATCH</code>，默认是GET</li><li><code>-H &quot;[name]: [value]&quot;</code>: 添加一个header头，示例<code>-H &quot;Content-Type: application/json&quot;</code></li><li><code>-d @file</code>: 文件内容为post内容</li><li><code>-d &quot;string&quot;</code>: 内容为post的body内容，指定了<code>-d</code>会默认使用POST</li><li><code>-F &quot;name=@file&quot;</code>: 表单形式提交文件，会自动设置<code>Content-Type: multipart/form-data</code>，示例<code>-F &quot;page=@/tmp/a;filename=a.txt&quot;</code></li><li><code>--insecure</code>: 允许不授信的证书</li><li><code>-o [filename]</code>: 输出储存到文件</li><li><code>-c [filename]</code>: 将返回的cookie保存到文件</li><li><code>-b [filename]</code>: 将文件内容作为cookie发送</li><li><code>-b &#39;name=value; name=value&#39;</code>: 设置cookie</li><li><code>-x &quot;127.0.0.1:1080&quot;</code>: 使用代理访问</li></ul><p><strong>POST默认的头部数据</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">POST /api HTTP/1.1</span><br><span class="line">Host: 10.240.17.101</span><br><span class="line">User-Agent: curl/7.86.0</span><br><span class="line">Accept: */*</span><br><span class="line">Content-Length: 7</span><br><span class="line">Content-Type: application/x-www-form-urlencoded</span><br></pre></td></tr></table></figure><p><strong>GET默认头部数据</strong></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">GET /api HTTP/1.1</span><br><span class="line">Host: 10.240.17.101</span><br><span class="line">User-Agent: curl/7.86.0</span><br><span class="line">Accept: */*</span><br></pre></td></tr></table></figure><h3 id="26-1-几种常用的示例"><a href="#26-1-几种常用的示例" class="headerlink" title="26.1. 几种常用的示例"></a>26.1. 几种常用的示例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">get请求下载文件</span></span><br><span class="line">curl http://1.1.1.1/download/aaa.txt -o aaa.txt</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">get发起请求，传参</span></span><br><span class="line">curl http://1.1.1.1/api?a=1&amp;b=2</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">post发起请求，传输x-www-form-urlencoded数据</span></span><br><span class="line">curl -X POST -d &#x27;a=1&amp;b=2&#x27; http://2.2.2.2/api</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">post发起请求，传输json数据</span></span><br><span class="line">curl -X POST -H &quot;Content-Type: application/json&quot; -d &#x27;&#123;&quot;a&quot;:1,&quot;b&quot;:2&#125;&#x27; http://1.1.1.1/api</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">忽略证书错误的请求</span></span><br><span class="line">curl https://1.1.1.1/api --insecure</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">上传文件</span></span><br><span class="line">curl -X POST -F &#x27;file=@test.txt;filename=a.txt&#x27; http://10.240.17.101/api</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">储存cookie到文件，下次请求携带过去</span></span><br><span class="line">curl -X GET http://10.240.17.101/api -c cookie.txt</span><br><span class="line">curl -X GET http://10.240.17.101/api -b cookie.txt</span><br></pre></td></tr></table></figure><h2 id="27-clang"><a href="#27-clang" class="headerlink" title="27. clang"></a>27. clang</h2><h3 id="27-1-查看预定义宏"><a href="#27-1-查看预定义宏" class="headerlink" title="27.1. 查看预定义宏"></a>27.1. 查看预定义宏</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">=&gt; clang -dM -E -x c /dev/null</span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">define _LP64 1</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">define __ATOMIC_ACQUIRE 2</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">define __ATOMIC_ACQ_REL 4</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">define __ATOMIC_CONSUME 1</span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash">define __ATOMIC_RELAXED 0</span></span><br><span class="line">...</span><br></pre></td></tr></table></figure><h2 id="28-brctl-网桥管理命令"><a href="#28-brctl-网桥管理命令" class="headerlink" title="28. brctl 网桥管理命令"></a>28. brctl 网桥管理命令</h2><ul><li>命令创建的都只是临时生效，重启后就不生效了。想要持续生效需要参考对应的网络管理器的配置。</li><li>网桥绑定网卡后，就会接管此网卡，此网卡配置都可以清除，反正不生效。配置网桥即可</li></ul><h3 id="28-1-基本用法"><a href="#28-1-基本用法" class="headerlink" title="28.1. 基本用法"></a>28.1. 基本用法</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">创建网桥</span></span><br><span class="line">=&gt; sudo brctl addbr virbr0</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置网桥的stp打开</span></span><br><span class="line">=&gt; sudo brctl stp virbr0 on</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置网桥绑定到一个网卡</span></span><br><span class="line">=&gt; sudo brctl addif virbr0 eno1</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看网桥</span></span><br><span class="line">=&gt; sudo brctl show</span><br><span class="line">bridge name     bridge id               STP enabled     interfaces</span><br><span class="line">virbr0          8000.66c563b8e2bc       yes             eno1</span><br></pre></td></tr></table></figure><h2 id="29-sox-音频转换命令"><a href="#29-sox-音频转换命令" class="headerlink" title="29. sox 音频转换命令"></a>29. sox 音频转换命令</h2><h3 id="29-1-常用用法"><a href="#29-1-常用用法" class="headerlink" title="29.1. 常用用法"></a>29.1. 常用用法</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sox rec.au rec.wav</span><br></pre></td></tr></table></figure><h2 id="30-nslookup-解析域名"><a href="#30-nslookup-解析域名" class="headerlink" title="30. nslookup 解析域名"></a>30. nslookup 解析域名</h2><h3 id="30-1-选项"><a href="#30-1-选项" class="headerlink" title="30.1. 选项"></a>30.1. 选项</h3><ul><li><code>-q=A</code>: 查询A记录</li><li><code>-vc</code>: 使用tcp查询</li></ul><h2 id="31-wget"><a href="#31-wget" class="headerlink" title="31. wget"></a>31. wget</h2><h3 id="31-1-选项"><a href="#31-1-选项" class="headerlink" title="31.1. 选项"></a>31.1. 选项</h3><ul><li><code>-r</code>: 表示递归下载。</li><li><code>-np</code>: 表示不要进入父级目录。</li><li><code>-nH</code>: 表示不要在本地创建主机名目录。</li><li><code>--cut-dirs=2</code>: 表示从第二级目录开始下载。</li><li><code>-R index.html</code>: 表示不下载 index.html 文件。</li></ul><h3 id="31-2-示例"><a href="#31-2-示例" class="headerlink" title="31.2. 示例"></a>31.2. 示例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">递归下载此链接下所有文件，不进入父级目录，下载完看到es5目录（前两级裁剪掉了）</span></span><br><span class="line">wget -r -np -nH --cut-dirs=2 -R index.html https://cdn.mathjax.org/mathjax/es5/</span><br></pre></td></tr></table></figure><h2 id="32-hexdump"><a href="#32-hexdump" class="headerlink" title="32. hexdump"></a>32. hexdump</h2><h3 id="32-1-选项"><a href="#32-1-选项" class="headerlink" title="32.1. 选项"></a>32.1. 选项</h3><ul><li><code>-C</code>: 显示ascii和hex对应的格式</li><li><code>-n &lt;length&gt;</code>: 指定显示几个字节</li></ul><h3 id="32-2-示例"><a href="#32-2-示例" class="headerlink" title="32.2. 示例"></a>32.2. 示例</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">=&gt; hexdump 隐藏的钥匙.jpg | head -n 3</span><br><span class="line">0000000 d8ff e0ff 1000 464a 4649 0100 0001 0100</span><br><span class="line">0000010 0100 0000 feff 3b00 5243 4145 4f54 3a52</span><br><span class="line">0000020 6720 2d64 706a 6765 7620 2e31 2030 7528</span><br><span class="line">=&gt; hexdump -C 隐藏的钥匙.jpg | head -n 3</span><br><span class="line">00000000  ff d8 ff e0 00 10 4a 46  49 46 00 01 01 00 00 01  |......JFIF......|</span><br><span class="line">00000010  00 01 00 00 ff fe 00 3b  43 52 45 41 54 4f 52 3a  |.......;CREATOR:|</span><br><span class="line">00000020  20 67 64 2d 6a 70 65 67  20 76 31 2e 30 20 28 75  | gd-jpeg v1.0 (u|</span><br><span class="line">=&gt; hexdump -C -n 100 隐藏的钥匙.jpg</span><br><span class="line">00000000  ff d8 ff e0 00 10 4a 46  49 46 00 01 01 00 00 01  |......JFIF......|</span><br><span class="line">00000010  00 01 00 00 ff fe 00 3b  43 52 45 41 54 4f 52 3a  |.......;CREATOR:|</span><br><span class="line">00000020  20 67 64 2d 6a 70 65 67  20 76 31 2e 30 20 28 75  | gd-jpeg v1.0 (u|</span><br><span class="line">00000030  73 69 6e 67 20 49 4a 47  20 4a 50 45 47 20 76 36  |sing IJG JPEG v6|</span><br><span class="line">00000040  32 29 2c 20 71 75 61 6c  69 74 79 20 3d 20 39 30  |2), quality = 90|</span><br><span class="line">00000050  0a ff db 00 43 00 03 02  02 03 02 02 03 03 03 03  |....C...........|</span><br><span class="line">00000060  04 03 03 04                                       |....|</span><br><span class="line">00000064</span><br></pre></td></tr></table></figure><h2 id="33-base64"><a href="#33-base64" class="headerlink" title="33. base64"></a>33. base64</h2><h3 id="33-1-选项"><a href="#33-1-选项" class="headerlink" title="33.1. 选项"></a>33.1. 选项</h3><ul><li><code>-d</code>: 解密</li></ul><h3 id="33-2-示例"><a href="#33-2-示例" class="headerlink" title="33.2. 示例"></a>33.2. 示例</h3><ul><li>base64一般是对文件，如果需要字符串则要使用管道</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">解密</span></span><br><span class="line">=&gt; echo -n &quot;Mzc3Y2JhZGRhMWVjYTJmMmY3M2QzNjI3Nzc4MWYwMGE=&quot; | base64 -d</span><br><span class="line"><span class="meta prompt_">377cbadda1eca2f2f73d36277781f00a%</span><span class="language-bash"></span></span><br><span class="line"><span class="language-bash"><span class="comment"># 加密</span></span></span><br><span class="line">=&gt; echo -n &quot;377cbadda1eca2f2f73d36277781f00a&quot; | base64</span><br><span class="line">Mzc3Y2JhZGRhMWVjYTJmMmY3M2QzNjI3Nzc4MWYwMGE=</span><br></pre></td></tr></table></figure><h1 id="四、小技巧"><a href="#四、小技巧" class="headerlink" title="四、小技巧"></a>四、小技巧</h1><h2 id="1-swap临时空间（可用于编译时内存不足问题）"><a href="#1-swap临时空间（可用于编译时内存不足问题）" class="headerlink" title="1. swap临时空间（可用于编译时内存不足问题）"></a>1. swap临时空间（可用于编译时内存不足问题）</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看内存文件</span></span><br><span class="line">sudo swapon --show</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">一般内存不够了，可以用这种方式增加交换内存。</span></span><br><span class="line">dd if=/dev/zero of=/var/swapfile1 bs=1024 count=6000000</span><br><span class="line">mkswap /var/swapfile1</span><br><span class="line">swapon /var/swapfile1</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">不需要交换内存的时候，取消磁盘占用</span></span><br><span class="line">swapoff /var/swapfile1</span><br><span class="line">rm -f /var/swapfile1</span><br></pre></td></tr></table></figure><h2 id="2-自颁发证书（不受信）"><a href="#2-自颁发证书（不受信）" class="headerlink" title="2. 自颁发证书（不受信）"></a>2. <span id="openssl_diy">自颁发证书（不受信）</span></h2><p>在开发过程中，https请求需要配置ssl证书，这个证书需要到部分供应商申请（阿里云、腾讯云等），自然不是免费的。开发过程中并不想这么麻烦，可以使用shell中的openssl进行自颁发证书。</p><ol><li>颁发证书需要先生成一个颁发机构，也就是CA</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">新建目录防止混乱</span></span><br><span class="line">mkdir -p ssl_diy/private &amp;&amp; cd ssl_diy</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">生成ca的私钥</span></span><br><span class="line">openssl genrsa -out private/cakey.pem 2048</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">根据key生成CA的证书文件</span></span><br><span class="line">openssl req -new -x509 -key private/cakey.pem -out cacert.pem</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将有一些配置需要填写，可以随意填写，因为是自颁发</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Country Name (2 letter code) [AU]: 国家名，自然CN</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">State or Province Name (full name) [Some-State]: 省份名称，比如Hunan</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Locality Name (eg, city) []: 城市名称，比如changsha</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Organization Name (eg, company) [Internet Widgits Pty Ltd]: 公司名称</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Organizational Unit Name (eg, section) []: 部门名称</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Common Name (eg, YOUR name) []: 颁发者的名字</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Email Address []: 邮件地址</span></span><br></pre></td></tr></table></figure><ol start="2"><li>生成证书</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">同样生成私钥key</span></span><br><span class="line">openssl genrsa -out domain.key 2048</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">根据key生成证书文件</span></span><br><span class="line">openssl req -new -key domain.key -out domain.csr</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将有一些配置需要填写，可以随意填写，因为是自颁发</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Country Name (2 letter code) [AU]: 国家名，自然CN</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">State or Province Name (full name) [Some-State]: 省份名称，比如Hunan</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Locality Name (eg, city) []: 城市名称，比如changsha</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Organization Name (eg, company) [Internet Widgits Pty Ltd]: 公司名称</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Organizational Unit Name (eg, section) []: 部门名称</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Common Name (eg, server FQDN or YOUR name) []: 填写网站的域名</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Email Address []: 邮件地址</span></span><br></pre></td></tr></table></figure><ol start="3"><li>使用ca给证书签名</li></ol><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">签名前需要有几个准备文件</span></span><br><span class="line">mkdir -p demoCA/newcerts</span><br><span class="line">touch demoCA/index.txt</span><br><span class="line">echo 01 &gt; demoCA/serial</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">签名，可以自定义有效天数-days</span></span><br><span class="line">openssl ca -in domain.csr -cert cacert.pem -keyfile private/cakey.pem -days 365 -out domain.crt</span><br></pre></td></tr></table></figure><ol start="4"><li>将生成的domain.crt和domain.key配置到服务器即可</li></ol><h2 id="3-快捷键"><a href="#3-快捷键" class="headerlink" title="3. 快捷键"></a>3. 快捷键</h2><ul><li><code>Ctrl + a</code> &#x2F; <code>home</code>: 移到行首</li><li><code>Ctrl + e</code> &#x2F; <code>end</code>: 移到行首</li><li><code>Ctrl + r</code>: 历史命令搜索，不支持模糊搜索，只支持连续字符</li><li><code>Ctrl + k</code>: 清空光标后面的字符</li><li><code>Ctrl + u</code>: 清空光标前面的字符</li></ul><h2 id="4-安装软件"><a href="#4-安装软件" class="headerlink" title="4. 安装软件"></a>4. 安装软件</h2><h3 id="4-1-二进制安装"><a href="#4-1-二进制安装" class="headerlink" title="4.1. 二进制安装"></a>4.1. 二进制安装</h3><ul><li>一般二进制都会自带依赖，可以直接使用</li><li>linux根目录有一个opt目录，大致是让用户自定义软件放在这里</li><li>&#x2F;usr&#x2F;local&#x2F;bin目录下放的是用户自定义应用，所以移过去后可以软链过去</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">sudo mv xxx /opt/xxx</span><br><span class="line">sudo ln -s /opt/xxx/bin/xxx /usr/local/bin/xxx</span><br></pre></td></tr></table></figure><h2 id="5-代码扫描"><a href="#5-代码扫描" class="headerlink" title="5. 代码扫描"></a>5. 代码扫描</h2><ul><li>github搜索shellcheck软件，根据系统安装</li><li>vscode搜索shellcheck插件，安装</li><li>不在PATH中则手动配置路径即可完成扫描</li></ul><h2 id="6-软件运行"><a href="#6-软件运行" class="headerlink" title="6. 软件运行"></a>6. 软件运行</h2><h3 id="6-1-临时加载库so"><a href="#6-1-临时加载库so" class="headerlink" title="6.1. 临时加载库so"></a>6.1. 临时加载库so</h3><ul><li>只想要当前运行加载so，可以执行下面命令</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export LD_LIBRARY_PATH=&quot;xxx&quot;</span><br></pre></td></tr></table></figure><h2 id="7-脚本技巧"><a href="#7-脚本技巧" class="headerlink" title="7. 脚本技巧"></a>7. 脚本技巧</h2><h3 id="7-1-获取脚本所在目录"><a href="#7-1-获取脚本所在目录" class="headerlink" title="7.1. 获取脚本所在目录"></a>7.1. 获取脚本所在目录</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash"><span class="variable">$0</span>是脚本目录，<span class="built_in">dirname</span>获取目录</span></span><br><span class="line">scriptDir=&quot;$(dirname &quot;$0&quot;)&quot;</span><br></pre></td></tr></table></figure><h2 id="8-有用的软件"><a href="#8-有用的软件" class="headerlink" title="8. 有用的软件"></a>8. 有用的软件</h2><h3 id="8-1-登陆显示系统信息"><a href="#8-1-登陆显示系统信息" class="headerlink" title="8.1. 登陆显示系统信息"></a>8.1. 登陆显示系统信息</h3><p>安装<code>landscape-common</code>，可以在登陆时显示下面的信息</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">Welcome to Ubuntu 20.04.1 LTS (GNU/Linux 5.6.0-25-generic x86_64)</span><br><span class="line"></span><br><span class="line"> * Documentation:  https://help.ubuntu.com</span><br><span class="line"> * Management:     https://landscape.canonical.com</span><br><span class="line"> * Support:        https://ubuntu.com/advantage</span><br><span class="line"></span><br><span class="line">  System information as of Tue 15 Jan 2021 10:08:49 AM CST</span><br><span class="line"></span><br><span class="line">  System load:  0.25               Processes:              356</span><br><span class="line">  Usage of /:   28.5% of 77.43GB   Users logged in:        0</span><br><span class="line">  Memory usage: 10%                IPv4 address for ens18: 192.168.0.1</span><br><span class="line">  Swap usage:   0%</span><br><span class="line"></span><br><span class="line">5 updates can be installed immediately.</span><br><span class="line">0 of these updates are security updates.</span><br><span class="line">To see these additional updates run: apt list --upgradable</span><br><span class="line"></span><br><span class="line">Your Hardware Enablement Stack (HWE) is supported until April 2025.</span><br><span class="line">Last login: Tue Jan 5 10:13:40 2021 from 192.168.0.2</span><br></pre></td></tr></table></figure><h3 id="8-2-x11vnc-linux远程桌面"><a href="#8-2-x11vnc-linux远程桌面" class="headerlink" title="8.2. x11vnc linux远程桌面"></a>8.2. x11vnc linux远程桌面</h3><p><strong>设置密码</strong></p><ul><li>默认储存到<code>/home/&lt;username&gt;/.vnc/passwd</code></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x11vnc -storepasswd</span><br></pre></td></tr></table></figure><p><strong>设置开机启动</strong></p><ul><li>写一个service文件到<code>/usr/lib/systemd/system/x11vnc.service</code></li><li>要修改passwd的路径</li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[Unit]</span></span><br><span class="line"><span class="attr">Description</span>=Start x11vnc at startup.</span><br><span class="line"><span class="attr">After</span>=multi-user.target</span><br><span class="line"></span><br><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">Type</span>=simple</span><br><span class="line"><span class="attr">ExecStart</span>=/usr/bin/x11vnc -auth guess -forever -loop -noxdamage -repeat -rfbauth /home/&lt;username&gt;/.vnc/passwd -rfbport <span class="number">5900</span> -shared -capslock</span><br><span class="line"></span><br><span class="line"><span class="section">[Install]</span></span><br><span class="line"><span class="attr">WantedBy</span>=multi-user.target</span><br></pre></td></tr></table></figure><ul><li><code>systemctl enable x11vnc</code>，加到开机启动项中</li><li><code>service x11vnc start</code>，当前开启服务</li></ul><p><strong>无显示器模拟显示器</strong></p><ul><li>在没有显示器的情况下x11vnc特别慢，插上显示器就快了，因为没有显示器显卡不工作</li><li>安装<code>xserver-xorg-video-dummy</code>模拟显示器</li><li>新增配置文件<code>/usr/share/X11/xorg.conf.d/xorg.conf</code></li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">Section &quot;Device&quot;</span><br><span class="line">    Identifier  &quot;Configured Video Device&quot;</span><br><span class="line">    Driver      &quot;dummy&quot;</span><br><span class="line">EndSection</span><br><span class="line"></span><br><span class="line">Section &quot;Monitor&quot;</span><br><span class="line">    Identifier  &quot;Configured Monitor&quot;</span><br><span class="line">    HorizSync 31.5-48.5</span><br><span class="line">    VertRefresh 50-70</span><br><span class="line">    Modeline &quot;1920x1080&quot;  173.00  1920 2048 2248 2576  1080 1083 1088 1120 -hsync +vsync</span><br><span class="line">    VideoRam 256000</span><br><span class="line">EndSection</span><br><span class="line"></span><br><span class="line">Section &quot;Screen&quot;</span><br><span class="line">    Identifier  &quot;Default Screen&quot;</span><br><span class="line">    Monitor     &quot;Configured Monitor&quot;</span><br><span class="line">    Device      &quot;Configured Video Device&quot;</span><br><span class="line">    DefaultDepth 24</span><br><span class="line">    SubSection &quot;Display&quot;</span><br><span class="line">        Depth 24</span><br><span class="line">        Modes &quot;1920x1080&quot;</span><br><span class="line">    EndSubSection</span><br><span class="line">EndSection</span><br></pre></td></tr></table></figure><ul><li>重启设备就好了</li></ul><p><strong>sddm管理桌面x11vnc起不来</strong></p><ul><li>可能需要单独写一个脚本处理，上面service的exec就指定这个脚本的目录即可</li><li>sddm使用单独的auth模式</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">while [ -z &quot;$(ls -t /run/sddm)&quot; ]; do</span><br><span class="line">    sleep 1</span><br><span class="line">done</span><br><span class="line">authFile=&quot;$(ls -t /run/sddm | head -n 1)&quot;</span><br><span class="line"></span><br><span class="line">/usr/bin/x11vnc -auth &quot;/run/sddm/$authFile&quot; -forever -loop -noxdamage -repeat -rfbauth &quot;/home/xxx/.vnc/passwd&quot; -rfbport 5900 -shared -capslock</span><br></pre></td></tr></table></figure><p><strong>gdm3管理桌面x11vnc起不来</strong></p><ul><li>同上，不过脚本变成下面这样</li><li>尝试的出现一个问题，当使用gdm3启动kde时，在桌面登陆前，没有<code>/run/user/1000/gdm/Xauthority</code>，需要先登录再启动</li><li>但是存在一个<code>/run/user/129/gdm/Xauthority</code>，这个可以打开登陆界面，登陆完这个就只有黑屏，需要使用上面的配置，并且<code>-dislay</code>需要设置成<code>:1</code></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash">!/bin/bash</span></span><br><span class="line"></span><br><span class="line">auth_file=&quot;/run/user/1000/gdm/Xauthority&quot;</span><br><span class="line"></span><br><span class="line">while [ ! -f &quot;$auth_file&quot; ]; do</span><br><span class="line">    sleep 1</span><br><span class="line">done</span><br><span class="line"></span><br><span class="line">/usr/bin/x11vnc -auth &quot;$auth_file&quot; -forever -loop -noxdamage -repeat -rfbauth &quot;/home/xxx/.vnc/passwd&quot; -rfbport 5900 -shared -capslock</span><br></pre></td></tr></table></figure><h2 id="9-查看电量"><a href="#9-查看电量" class="headerlink" title="9. 查看电量"></a>9. 查看电量</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat /sys/class/power_supply/battery/capacity</span><br></pre></td></tr></table></figure><h2 id="10-当前运行命令转后台"><a href="#10-当前运行命令转后台" class="headerlink" title="10. 当前运行命令转后台"></a>10. 当前运行命令转后台</h2><ol><li><code>Ctrl + z</code>: 暂停当前程序</li><li><code>bg</code>: 后台继续运行暂停的程序</li></ol><p><strong>其他命令</strong></p><ul><li><code>fg</code>: 后台运行程序转前台</li><li><code>jobs</code>: 查看所有程序</li></ul><h2 id="12-shell脚本单例"><a href="#12-shell脚本单例" class="headerlink" title="12. shell脚本单例"></a>12. shell脚本单例</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 进程单例判断</span></span></span><br><span class="line">is_single_running() &#123;</span><br><span class="line">    local lockfile=$1</span><br><span class="line"></span><br><span class="line">    exec 100&gt; &quot;$lockfile&quot;</span><br><span class="line">    if /usr/bin/flock -xw 3 100</span><br><span class="line">    then</span><br><span class="line">        return 0</span><br><span class="line">    else</span><br><span class="line">        return 1</span><br><span class="line">    fi</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment"># 用法</span></span></span><br><span class="line">if ! is_single_running /tmp/xxx; then</span><br><span class="line">    echo &quot;has been running&quot;</span><br><span class="line">    exit 1</span><br><span class="line">fi</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h2 id="13-挂载windows共享文件夹"><a href="#13-挂载windows共享文件夹" class="headerlink" title="13. 挂载windows共享文件夹"></a>13. 挂载windows共享文件夹</h2><ul><li><code>uid</code>和<code>gid</code>需要根据需要设置成对应的id，为挂在过来的所属用户和用户组</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看windows共享文件夹</span></span><br><span class="line">smbclient -U User -L //xxx.xxx.xxx.xxx/</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">挂载</span></span><br><span class="line">mount -t cifs -o user=share,rw,uid=0,gid=0 //192.168.1.120/share /root/share</span><br></pre></td></tr></table></figure><h1 id="踩坑记-2"><a href="#踩坑记-2" class="headerlink" title="踩坑记"></a>踩坑记</h1><h2 id="1-ssh用rsakey无法免密登陆"><a href="#1-ssh用rsakey无法免密登陆" class="headerlink" title="1. ssh用rsakey无法免密登陆"></a>1. ssh用rsakey无法免密登陆</h2><ul><li>sshd要求使用rsakey需要有以下权限限制<ul><li><code>/home/xxx</code>需要700权限，不允许用户组编辑</li><li><code>/home/xxx/.ssh</code>需要700权限</li><li><code>/home/xxx/authorized_keys</code>需要600权限</li></ul></li></ul></div><div class="reward-container"><div></div><button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'>打赏</button><div id="qr" style="display:none"><div style="display:inline-block"><img src="/images/wechatpay.png" alt="王钰博 微信支付"><p>微信支付</p></div><div style="display:inline-block"><img src="/images/alipay.jpg" alt="王钰博 支付宝"><p>支付宝</p></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Linux/" rel="tag"># Linux</a></div><div class="post-nav"><div class="post-nav-item"><a href="/blogs/2018-09-16-pythonStudy/" rel="prev" title="python学习笔记"><i class="fa fa-chevron-left"></i> python学习笔记</a></div><div class="post-nav-item"><a href="/blogs/2018-09-18-algorithmStudy/" rel="next" title="算法与数据结构学习">算法与数据结构学习 <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>window.addEventListener("tabs:register",()=>{let{activeClass:t}=CONFIG.comments;if(CONFIG.comments.storage&&(t=localStorage.getItem("comments_active")||t),t){let e=document.querySelector(`a[href="#comment-${t}"]`);e&&e.click()}}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{if(!t.target.matches(".tabs-comment .tab-content .tab-pane"))return;let e=t.target.classList[1];localStorage.setItem("comments_active",e)})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E8%AF%AD%E6%B3%95%E7%9B%B8%E5%85%B3"><span class="nav-text">一、语法相关</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E8%BF%9B%E5%88%B6%E6%95%B0%E5%AD%97%E8%A1%A8%E7%A4%BA"><span class="nav-text">1. 进制数字表示</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E7%9B%AE%E5%BD%95%E7%89%B9%E6%AE%8A%E7%AC%A6%E5%8F%B7"><span class="nav-text">2. 目录特殊符号</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%B8%B8%E7%94%A8%E8%AF%AD%E6%B3%95%E8%AF%A6%E8%A7%A3"><span class="nav-text">3. 常用语法详解</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E8%BE%93%E5%85%A5%E5%87%BA%E9%87%8D%E5%AE%9A%E5%90%91"><span class="nav-text">3.1. &lt;&gt; 输入出重定向</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-2-%E6%84%8F%E4%B9%89"><span class="nav-text">3.2. $ 意义</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-3-cd-%E8%B7%B3%E8%BD%AC%E7%9B%AE%E5%BD%95%E5%91%BD%E4%BB%A4"><span class="nav-text">3.3. cd 跳转目录命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-4-if-%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD"><span class="nav-text">3.4. if 条件判断</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-5-for-%E5%BE%AA%E7%8E%AF"><span class="nav-text">3.5. for 循环</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%96%87%E4%BB%B6%E9%81%8D%E5%8E%86"><span class="nav-text">(1) 文件遍历</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-index%E9%80%92%E5%A2%9E%E5%BD%A2%E5%BC%8F"><span class="nav-text">(2) index递增形式</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-6-while-%E5%BE%AA%E7%8E%AF"><span class="nav-text">3.6. while 循环</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#3-7-switch-%E8%AF%AD%E5%8F%A5"><span class="nav-text">3.7. switch 语句</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8"><span class="nav-text">4. 函数调用</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C"><span class="nav-text">5. 字符串操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%9B%BF%E6%8D%A2"><span class="nav-text">5.1. 字符串替换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%88%AA%E5%8F%96"><span class="nav-text">5.2. 字符串截取</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-3-%E5%AD%97%E7%AC%A6%E4%B8%B2%E9%81%8D%E5%8E%86"><span class="nav-text">5.3. 字符串遍历</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E6%95%B0%E7%BB%84"><span class="nav-text">6. 数组</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-%E6%95%B0%E7%BB%84%E9%81%8D%E5%8E%86"><span class="nav-text">6.1. 数组遍历</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-%E6%95%B0%E7%BB%84%E6%8B%B7%E8%B4%9D"><span class="nav-text">6.2. 数组拷贝</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-eval"><span class="nav-text">7. eval</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-bash%E5%92%8Csource%E3%80%81-%E7%9A%84%E5%8C%BA%E5%88%AB"><span class="nav-text">8. bash和source、.的区别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-%E7%AE%97%E6%9C%AF%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="nav-text">9. 算术表达式</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#9-1-i-%E8%A1%A8%E7%A4%BA"><span class="nav-text">9.1. i++表示</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E4%BD%BF%E7%94%A8let%E8%A1%A8%E7%A4%BA"><span class="nav-text">(1) 使用let表示</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E7%94%A8-%EF%BC%8C%E8%BF%99%E7%A7%8D%E7%94%A8%E6%B3%95%E5%B8%B8%E8%A7%81%E4%BA%8Efor%E5%BE%AA%E7%8E%AF%E4%B8%AD"><span class="nav-text">(2) 用(())，这种用法常见于for循环中</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-%E7%94%A8expr"><span class="nav-text">(3) 用expr</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-%E7%94%A8%E5%A6%82%E4%B8%8B%E6%A8%A1%E5%BC%8F"><span class="nav-text">(4) 用如下模式</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E7%B3%BB%E7%BB%9F%E5%91%BD%E4%BB%A4%E8%AF%A6%E8%A7%A3"><span class="nav-text">二、系统命令详解</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-find-%E6%96%87%E4%BB%B6%E6%9F%A5%E6%89%BE"><span class="nav-text">1. find 文件查找</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E9%80%89%E9%A1%B9"><span class="nav-text">1.1. 选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E5%AE%9E%E4%BE%8B"><span class="nav-text">1.2. 实例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-%E7%BB%9F%E8%AE%A1%E4%BB%A3%E7%A0%81%E8%A1%8C%E6%95%B0"><span class="nav-text">1.3. 统计代码行数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-file"><span class="nav-text">2. file</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E5%AE%9E%E4%BE%8B"><span class="nav-text">2.1. 实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-tr"><span class="nav-text">3. tr</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E5%AE%9E%E4%BE%8B"><span class="nav-text">3.1. 实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-watch"><span class="nav-text">4. watch</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-%E9%80%89%E9%A1%B9"><span class="nav-text">4.1. 选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-%E5%8F%82%E6%95%B0"><span class="nav-text">4.2. 参数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-%E5%AE%9E%E4%BE%8B"><span class="nav-text">4.3. 实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-tail-%E5%AE%9E%E6%97%B6%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6%E5%86%85%E5%AE%B9%EF%BC%88%E5%8F%AF%E7%94%A8%E4%BA%8E%E6%9F%A5%E7%9C%8Blog%E6%96%87%E4%BB%B6%EF%BC%89"><span class="nav-text">5. tail 实时查看文件内容（可用于查看log文件）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-tail%E6%98%BE%E7%A4%BA%E9%AB%98%E4%BA%AE"><span class="nav-text">5.1. tail显示高亮</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-sort-%E6%8E%92%E5%BA%8F"><span class="nav-text">6. sort 排序</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-%E9%80%89%E9%A1%B9%E8%A7%A3%E9%87%8A"><span class="nav-text">6.1. 选项解释</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#6-2-%E4%B8%80%E4%BA%9B%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="nav-text">6.2. 一些基本操作</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-grep-%E6%9F%A5%E6%89%BE%E5%86%85%E5%AE%B9"><span class="nav-text">7. grep 查找内容</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-%E5%86%85%E5%AE%B9%E5%8C%B9%E9%85%8D"><span class="nav-text">7.1. 内容匹配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-%E6%9F%A5%E6%89%BE%E8%BF%9B%E7%A8%8B%E6%8E%92%E9%99%A4grep"><span class="nav-text">7.2. 查找进程排除grep</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-3-%E6%9F%A5%E6%89%BE%E5%8C%85%E5%90%AB%E5%86%85%E5%AE%B9%E7%9A%84%E6%9C%89%E5%87%A0%E8%A1%8C"><span class="nav-text">7.3. 查找包含内容的有几行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-4-%E6%9F%A5%E6%89%BE%E7%9B%AE%E5%BD%95%E4%B8%8B%E6%89%80%E6%9C%89%E6%96%87%E4%BB%B6%E5%8C%B9%E9%85%8D%E5%AF%B9%E5%BA%94%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="nav-text">7.4. 查找目录下所有文件匹配对应字符串</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-5-%E6%AD%A3%E5%88%99%E6%9F%A5%E6%89%BE%EF%BC%8C%E5%8F%AA%E6%98%BE%E7%A4%BA%E5%8C%B9%E9%85%8D%E6%AE%B5"><span class="nav-text">7.5. 正则查找，只显示匹配段</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-wc-%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6%E6%88%96%E8%80%85%E5%86%85%E5%AE%B9%E8%A1%8C%E6%95%B0"><span class="nav-text">8. wc 查看文件或者内容行数</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-addr2line-%E6%A0%B9%E6%8D%AE%E5%9C%B0%E5%9D%80%E5%AE%9A%E4%BD%8D%E4%BB%A3%E7%A0%81%E4%BD%8D%E7%BD%AE"><span class="nav-text">9. addr2line 根据地址定位代码位置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#9-1-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="nav-text">9.1. 注意事项</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-date-%E6%97%B6%E9%97%B4%E5%B7%A5%E5%85%B7"><span class="nav-text">10. date 时间工具</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-dd-%E6%89%B9%E9%87%8F%E6%8B%B7%E8%B4%9D%E5%91%BD%E4%BB%A4"><span class="nav-text">11. dd 批量拷贝命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#11-1-%E5%AE%9E%E4%BE%8B"><span class="nav-text">11.1. 实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12-watch-%E7%9B%91%E5%90%AC%E5%91%BD%E4%BB%A4"><span class="nav-text">12. watch 监听命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#12-1-%E5%AE%9E%E4%BE%8B"><span class="nav-text">12.1. 实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-iptables-%E9%98%B2%E7%81%AB%E5%A2%99"><span class="nav-text">13. iptables 防火墙</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#13-1-%E7%9F%A5%E8%AF%86%E5%A1%AB%E5%85%85"><span class="nav-text">13.1. 知识填充</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-2-%E5%AE%9E%E4%BE%8B"><span class="nav-text">13.2. 实例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B8%A9%E5%9D%91%E8%AE%B0"><span class="nav-text">踩坑记</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-iptables%E6%8A%A5%E9%94%99iptables-v1-8-4-nf-tables-Could-not-fetch-rule-set-generation-id-Invalid-argument"><span class="nav-text">1) iptables报错iptables v1.8.4 (nf_tables): Could not fetch rule set generation id: Invalid argument</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#14-ls-%E5%88%97%E4%B8%BE%E7%9B%AE%E5%BD%95"><span class="nav-text">14. ls 列举目录</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#13-1-%E9%80%89%E9%A1%B9"><span class="nav-text">13.1. 选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-2-%E6%97%B6%E9%97%B4%E6%98%BE%E7%A4%BA%E6%A0%BC%E5%BC%8F%E4%BF%AE%E6%94%B9"><span class="nav-text">13.2. 时间显示格式修改</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#15-netstat-%E7%BD%91%E7%BB%9C%E7%8A%B6%E6%80%81%E6%9F%A5%E7%9C%8B"><span class="nav-text">15. netstat 网络状态查看</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9E%E4%BE%8B"><span class="nav-text">实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#16-sed-%E6%96%87%E4%BB%B6%E6%9F%A5%E6%89%BE%E6%9B%BF%E6%8D%A2%E6%89%93%E5%8D%B0"><span class="nav-text">16. sed 文件查找替换打印</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#16-1-%E9%80%89%E9%A1%B9"><span class="nav-text">16.1. 选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#16-2-%E7%A4%BA%E4%BE%8B"><span class="nav-text">16.2. 示例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#16-3-%E6%AD%A3%E5%88%99"><span class="nav-text">16.3. 正则</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%89%B9%E6%AE%8A%E7%94%A8%E6%B3%95"><span class="nav-text">特殊用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#17-echo-%E8%BE%93%E5%87%BA"><span class="nav-text">17. echo 输出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#18-diff-patch-%E5%B7%AE%E5%BC%82%E8%BE%93%E5%87%BA%E5%92%8C%E5%BA%94%E7%94%A8"><span class="nav-text">18. diff &amp; patch 差异输出和应用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#18-1-git%E6%94%B9%E5%8A%A8%E5%BA%94%E7%94%A8%E5%88%B0%E6%9F%90%E4%B8%AA%E7%9B%AE%E5%BD%95%E4%B8%8A%EF%BC%88%E9%9D%9Egit%E6%A0%87%E5%87%86%E7%9B%AE%E5%BD%95%EF%BC%89"><span class="nav-text">18.1 git改动应用到某个目录上（非git标准目录）</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#18-2-%E6%96%87%E4%BB%B6%E5%A4%B9%E6%94%B9%E5%8A%A8%E5%BA%94%E7%94%A8%E5%88%B0%E5%8F%A6%E4%B8%80%E4%B8%AA%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="nav-text">18.2 文件夹改动应用到另一个文件夹</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#19-fallocate-%E5%88%9B%E5%BB%BA%E5%A4%A7%E6%96%87%E4%BB%B6"><span class="nav-text">19. fallocate 创建大文件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#19-1-%E5%87%A0%E7%A7%8D%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="nav-text">19.1. 几种基本用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#20-lsof-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E6%96%87%E4%BB%B6%E5%8D%A0%E7%94%A8%EF%BC%88%E5%8C%85%E6%8B%AC%E7%AB%AF%E5%8F%A3%EF%BC%89"><span class="nav-text">20. lsof 查看系统文件占用（包括端口）</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#20-1-%E5%87%A0%E7%A7%8D%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="nav-text">20.1. 几种基本用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#21-top-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E5%8D%A0%E7%94%A8"><span class="nav-text">21. top 查看系统占用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#21-1-%E5%87%A0%E4%B8%AA%E5%BF%AB%E6%8D%B7%E9%94%AE"><span class="nav-text">21.1. 几个快捷键</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#21-2-%E8%BF%9B%E7%A8%8B%E7%8A%B6%E6%80%81%E8%A7%A3%E6%9E%90"><span class="nav-text">21.2. 进程状态解析</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-awk-%E9%80%90%E8%A1%8C%E5%A4%84%E7%90%86%E6%98%BE%E7%A4%BA"><span class="nav-text">22. awk 逐行处理显示</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#22-1-%E5%87%A0%E7%A7%8D%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="nav-text">22.1. 几种基本用法</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#22-2-%E9%AA%9A%E6%93%8D%E4%BD%9C%E5%AE%9E%E4%BE%8B"><span class="nav-text">22.2. 骚操作实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#23-md5sum-%E8%AE%A1%E7%AE%97MD5"><span class="nav-text">23. md5sum 计算MD5</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#23-1-%E5%87%A0%E7%A7%8D%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="nav-text">23.1. 几种基本用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#24-udevadm-%E7%B3%BB%E7%BB%9Fusb%E7%AE%A1%E7%90%86"><span class="nav-text">24. udevadm 系统usb管理</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#24-1-%E5%87%A0%E7%A7%8D%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="nav-text">24.1 几种基本用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#25-lsblk-%E6%A0%91%E5%9E%8B%E6%9F%A5%E7%9C%8B%E7%A1%AC%E7%9B%98%E5%88%86%E5%8C%BA%E4%BF%A1%E6%81%AF"><span class="nav-text">25. lsblk 树型查看硬盘分区信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#26-blkid-%E6%9F%A5%E7%9C%8B%E5%B7%B2%E6%8C%82%E8%BD%BD%E7%9A%84%E7%A1%AC%E7%9B%98%E7%9A%84uuid%E4%BF%A1%E6%81%AF"><span class="nav-text">26. blkid 查看已挂载的硬盘的uuid信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#27-tune2fs-%E4%BF%AE%E6%94%B9%E7%A1%AC%E7%9B%98uuid"><span class="nav-text">27. tune2fs 修改硬盘uuid</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#28-route-%E6%9B%B4%E6%96%B0%E8%B7%AF%E7%94%B1%E4%BF%A1%E6%81%AF"><span class="nav-text">28. route 更新路由信息</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#28-1-%E4%B8%80%E4%BA%9B%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="nav-text">28.1. 一些基本用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#29-ps-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E8%BF%9B%E7%A8%8B"><span class="nav-text">29. ps 查看系统进程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#29-1-%E9%80%89%E9%A1%B9%E5%90%AB%E4%B9%89"><span class="nav-text">29.1. 选项含义</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#30-ip-%E7%B3%BB%E7%BB%9F%E7%BD%91%E7%BB%9C%E9%85%8D%E7%BD%AE"><span class="nav-text">30. ip 系统网络配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#30-1-%E8%B7%AF%E7%94%B1%E7%9B%B8%E5%85%B3"><span class="nav-text">30.1. 路由相关</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E7%AD%96%E7%95%A5%E8%B7%AF%E7%94%B1"><span class="nav-text">1) 策略路由</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#30-2-%E6%9F%A5%E7%9C%8B%E7%BD%91%E5%8D%A1ip"><span class="nav-text">30.2. 查看网卡ip</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#30-3-%E9%85%8D%E7%BD%AE%E7%BD%91%E5%8D%A1"><span class="nav-text">30.3. 配置网卡</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#31-read-%E8%AF%BB%E5%8F%96%E8%BE%93%E5%85%A5"><span class="nav-text">31. read 读取输入</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#31-1-%E8%AF%BB%E5%8F%96%E7%94%A8%E6%88%B7%E8%BE%93%E5%85%A5"><span class="nav-text">31.1. 读取用户输入</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#32-conntrack-%E8%BF%9E%E6%8E%A5%E8%B7%9F%E8%B8%AA"><span class="nav-text">32. conntrack 连接跟踪</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#32-1-%E9%80%89%E9%A1%B9%E8%A7%A3%E9%87%8A"><span class="nav-text">32.1. 选项解释</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#33-ss-%E6%9F%A5%E7%9C%8Bsocket%E5%8D%A0%E7%94%A8%E6%83%85%E5%86%B5"><span class="nav-text">33. ss 查看socket占用情况</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#33-1-%E9%80%89%E9%A1%B9%E8%A7%A3%E9%87%8A"><span class="nav-text">33.1. 选项解释</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#33-2-%E4%BD%BF%E7%94%A8%E5%AE%9E%E4%BE%8B"><span class="nav-text">33.2. 使用实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#34-pwd"><span class="nav-text">34. pwd</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#34-1-%E9%80%89%E9%A1%B9%E8%A7%A3%E9%87%8A"><span class="nav-text">34.1. 选项解释</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#35-mknod"><span class="nav-text">35. mknod</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#35-1-%E7%A4%BA%E4%BE%8B"><span class="nav-text">35.1. 示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#36-sudo"><span class="nav-text">36. sudo</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#36-1-%E9%80%89%E9%A1%B9"><span class="nav-text">36.1. 选项</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#37-sysctl-%E4%BF%AE%E6%94%B9%E5%86%85%E6%A0%B8%E5%8F%82%E6%95%B0"><span class="nav-text">37. sysctl 修改内核参数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#37-1-%E9%80%89%E9%A1%B9"><span class="nav-text">37.1. 选项</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B"><span class="nav-text">示例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#38-pmap%E6%9F%A5%E7%9C%8B%E8%BF%9B%E7%A8%8B%E5%86%85%E5%AD%98%E6%83%85%E5%86%B5"><span class="nav-text">38. pmap查看进程内存情况</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%89%E9%A1%B9"><span class="nav-text">选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%A4%BA%E4%BE%8B-1"><span class="nav-text">示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#39-setcap-%E6%8F%90%E6%9D%83%E5%91%BD%E4%BB%A4"><span class="nav-text">39. setcap 提权命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#39-1-%E8%83%BD%E5%8A%9B%E5%88%97%E4%B8%BE"><span class="nav-text">39.1. 能力列举</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#39-2-%E7%A4%BA%E4%BE%8B"><span class="nav-text">39.2. 示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#40-xdg-open-%E6%8C%89%E7%85%A7%E7%B3%BB%E7%BB%9F%E9%BB%98%E8%AE%A4%E6%89%93%E5%BC%80%E6%96%B9%E5%BC%8F%E6%89%93%E5%BC%80%E6%96%87%E4%BB%B6"><span class="nav-text">40. xdg-open 按照系统默认打开方式打开文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#41-uniq-%E5%A4%84%E7%90%86%E9%87%8D%E5%A4%8D%E8%A1%8C"><span class="nav-text">41. uniq 处理重复行</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#41-1-%E9%80%89%E9%A1%B9%E8%A7%A3%E9%87%8A"><span class="nav-text">41.1. 选项解释</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#41-2-%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="nav-text">41.2. 基本用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#42-ipset-%E7%BB%99iptables%E4%BD%BF%E7%94%A8%E7%9A%84ip%E5%88%97%E8%A1%A8"><span class="nav-text">42. ipset 给iptables使用的ip列表</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E5%B7%A5%E5%85%B7%E5%91%BD%E4%BB%A4"><span class="nav-text">三、工具命令</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E6%96%87%E4%BB%B6%E5%A4%B9%E7%9B%AE%E5%BD%95%E5%A4%A7%E5%B0%8F-du"><span class="nav-text">1. 文件夹目录大小 du</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E6%8A%93%E5%8C%85%E5%B7%A5%E5%85%B7-tcpdump"><span class="nav-text">2. 抓包工具 tcpdump</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E9%80%89%E9%A1%B9"><span class="nav-text">2.1. 选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E8%BF%87%E6%BB%A4%E5%99%A8"><span class="nav-text">2.2. 过滤器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-3-%E7%A4%BA%E4%BE%8B"><span class="nav-text">2.3. 示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E7%BD%91%E7%BB%9C%E5%97%85%E6%8E%A2-nmap"><span class="nav-text">3. 网络嗅探 nmap</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E8%BF%9C%E7%A8%8B%E8%BF%9E%E6%8E%A5-ssh"><span class="nav-text">4. 远程连接 ssh</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-ssh%E7%94%9F%E6%88%90%E5%85%AC%E9%92%A5%E5%92%8C%E7%A7%81%E9%92%A5"><span class="nav-text">4.1. ssh生成公钥和私钥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-ssh%E9%80%9A%E8%BF%87%E4%BB%A3%E7%90%86%E8%AE%BF%E9%97%AE"><span class="nav-text">4.2. ssh通过代理访问</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-3-%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91"><span class="nav-text">4.3. 端口转发</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-4-ssh%E7%99%BB%E9%99%86%E4%BF%A1%E6%81%AF"><span class="nav-text">4.4. ssh登陆信息</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E6%B7%BB%E5%8A%A0ssh%E7%99%BB%E9%99%86%E5%90%8E%E6%89%A7%E8%A1%8C%E5%91%BD%E4%BB%A4"><span class="nav-text">1) 添加ssh登陆后执行命令</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-5-%E5%BF%BD%E7%95%A5known-hosts%E9%94%99%E8%AF%AF"><span class="nav-text">4.5. 忽略known_hosts错误</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B8%A9%E5%9D%91%E8%AE%B0-1"><span class="nav-text">踩坑记</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E4%BD%8E%E7%89%88%E6%9C%ACssh%E8%BF%9E%E6%8E%A5%E5%A4%B1%E8%B4%A5"><span class="nav-text">(1) 低版本ssh连接失败</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-ssh%E9%A6%96%E6%AC%A1%E7%99%BB%E5%BD%95%E6%80%BB%E8%A6%81%E7%AD%89%E4%B8%80%E4%BC%9A%E6%89%8D%E6%8F%90%E7%A4%BA%E5%AF%86%E7%A0%81%E6%A1%86"><span class="nav-text">(2) ssh首次登录总要等一会才提示密码框</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E5%8E%8B%E7%BC%A9%E5%92%8C%E8%A7%A3%E5%8E%8B%E7%BC%A9%E5%91%BD%E4%BB%A4"><span class="nav-text">5. 压缩和解压缩命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-tar%E5%91%BD%E4%BB%A4"><span class="nav-text">5.1. tar命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-1-%E5%8F%82%E6%95%B0%E8%A7%A3%E6%9E%90"><span class="nav-text">5.1.1. 参数解析</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-2-%E7%A4%BA%E4%BE%8B"><span class="nav-text">5.1.2. 示例</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-1-3-%E5%8A%A0%E5%AF%86%E5%8E%8B%E7%BC%A9"><span class="nav-text">5.1.3. 加密压缩</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#5-2-zip%E5%91%BD%E4%BB%A4"><span class="nav-text">5.2. zip命令</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-1-%E5%8E%8B%E7%BC%A9"><span class="nav-text">5.2.1. 压缩</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#5-2-2-%E8%A7%A3%E5%8E%8B"><span class="nav-text">5.2.2. 解压</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-e2label-%E4%BF%AE%E6%94%B9%E5%8D%B7%E6%A0%87%E5%90%8D%E7%A7%B0"><span class="nav-text">6. e2label 修改卷标名称</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-readelf-%E6%9F%A5%E7%9C%8B%E4%BA%8C%E8%BF%9B%E5%88%B6%E7%AC%A6%E5%8F%B7%E8%A1%A8"><span class="nav-text">7. readelf 查看二进制符号表</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-%E6%9F%A5%E7%9C%8B%E7%AC%A6%E5%8F%B7%E8%A1%A8"><span class="nav-text">7.1. 查看符号表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#7-2-%E6%9F%A5%E7%9C%8B%E4%BA%8C%E8%BF%9B%E5%88%B6%E4%BE%9D%E8%B5%96"><span class="nav-text">7.2. 查看二进制依赖</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-objdump-%E5%AF%BC%E5%87%BA%E6%B1%87%E7%BC%96%E6%8C%87%E4%BB%A4%E8%A1%A8"><span class="nav-text">8. objdump 导出汇编指令表</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-strace-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8"><span class="nav-text">9. strace 查看系统调用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#9-1-%E6%9F%A5%E7%9C%8B%E5%8D%95%E8%BF%9B%E7%A8%8B%E7%9A%84%E7%B3%BB%E7%BB%9F%E8%B0%83%E7%94%A8%EF%BC%8C%E4%B8%8D%E9%87%8D%E5%90%AF%E8%BF%9B%E7%A8%8B"><span class="nav-text">9.1. 查看单进程的系统调用，不重启进程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-tree-%E6%9F%A5%E7%9C%8B%E6%96%87%E4%BB%B6%E6%A0%91"><span class="nav-text">10. tree 查看文件树</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-sshfs-%E6%8C%82%E8%BD%BD%E8%BF%9C%E7%A8%8B%E7%9B%AE%E5%BD%95"><span class="nav-text">11. sshfs 挂载远程目录</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12-cmake-%E8%B7%A8%E5%B9%B3%E5%8F%B0%E7%BC%96%E8%AF%91%E5%91%BD%E4%BB%A4"><span class="nav-text">12. cmake 跨平台编译命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#12-1-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-text">12.1 基本使用命令</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-gdb-c-c-%E5%8D%95%E6%AD%A5%E8%B0%83%E8%AF%95%E5%B7%A5%E5%85%B7"><span class="nav-text">13. gdb c&#x2F;c++单步调试工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#13-1-gdb%E5%86%85%E9%83%A8%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="nav-text">13.1 gdb内部基本使用命令</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-2-%E5%8F%AF%E4%BB%A5%E7%9C%8B%E4%BB%A3%E7%A0%81%E7%89%88%E6%9C%AC-cgdb"><span class="nav-text">13.2. 可以看代码版本 cgdb</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%BF%AB%E6%8D%B7%E9%94%AE"><span class="nav-text">1) 快捷键</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-3-%E5%87%BD%E6%95%B0%E5%A0%86%E6%A0%88"><span class="nav-text">13.3. 函数堆栈</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-4-%E5%B8%A6%E5%8F%82%E6%95%B0%E7%9A%84%E6%89%A7%E8%A1%8C"><span class="nav-text">13.4. 带参数的执行</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-5-gdbserver%E8%BF%9C%E7%A8%8B%E8%B0%83%E8%AF%95"><span class="nav-text">13.5. gdbserver远程调试</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-6-gdb%E5%BF%BD%E7%95%A5%E6%9F%90%E4%B8%AA%E4%BF%A1%E5%8F%B7%E4%B8%8D%E6%89%93%E6%96%AD"><span class="nav-text">13.6. gdb忽略某个信号不打断</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-7-gdb%E6%8C%82%E8%BD%BD%E8%BF%9B%E7%A8%8B%E8%B0%83%E8%AF%95"><span class="nav-text">13.7. gdb挂载进程调试</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#14-tmux"><span class="nav-text">14. tmux</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%BF%AB%E6%8D%B7%E9%94%AE"><span class="nav-text">快捷键</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#15-fzf"><span class="nav-text">15. fzf</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%85%8D%E7%BD%AE"><span class="nav-text">配置</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#16-ctags"><span class="nav-text">16. ctags</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#16-1-C-C"><span class="nav-text">16.1. C&#x2F;C++</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E9%80%89%E9%A1%B9"><span class="nav-text">基本选项</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%B7%BB%E5%8A%A0%E7%B3%BB%E7%BB%9F%E5%A4%B4%E6%96%87%E4%BB%B6%E6%94%AF%E6%8C%81"><span class="nav-text">添加系统头文件支持</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#16-2-php%E6%94%AF%E6%8C%81"><span class="nav-text">16.2. php支持</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#17-gcc"><span class="nav-text">17. gcc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#17-1-%E9%80%89%E9%A1%B9%E8%A7%A3%E9%87%8A"><span class="nav-text">17.1. 选项解释</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#17-2-%E6%9F%A5%E7%9C%8B%E9%A2%84%E5%AE%9A%E4%B9%89%E5%AE%8F"><span class="nav-text">17.2. 查看预定义宏</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#17-3-%E5%8D%95%E5%87%BD%E6%95%B0%E4%BC%98%E5%8C%96%E7%BA%A7%E5%88%AB%E8%AE%BE%E5%AE%9A"><span class="nav-text">17.3. 单函数优化级别设定</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#17-4-%E5%AE%9E%E4%BE%8B"><span class="nav-text">17.4. 实例</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E7%BC%96%E8%AF%91%E5%8A%A8%E6%80%81%E5%BA%93"><span class="nav-text">1) 编译动态库</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#18-firewalld-%E9%98%B2%E7%81%AB%E5%A2%99"><span class="nav-text">18. firewalld 防火墙</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#18-1-%E9%80%89%E9%A1%B9%E8%A7%A3%E9%87%8A"><span class="nav-text">18.1. 选项解释</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#18-2-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="nav-text">18.2. 基本操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#18-3-%E5%8C%BA%E5%9F%9F%E6%93%8D%E4%BD%9C"><span class="nav-text">18.3. 区域操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#18-4-%E6%9C%8D%E5%8A%A1%E6%93%8D%E4%BD%9C"><span class="nav-text">18.4. 服务操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#18-5-%E7%AB%AF%E5%8F%A3%E6%93%8D%E4%BD%9C"><span class="nav-text">18.5. 端口操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#18-6-%E7%9B%B4%E6%8E%A5%E6%93%8D%E4%BD%9C"><span class="nav-text">18.6. 直接操作</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#19-jq-linux%E7%9A%84json%E8%A7%A3%E6%9E%90%E5%B7%A5%E5%85%B7"><span class="nav-text">19. jq linux的json解析工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%87%A0%E7%A7%8D%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="nav-text">1. 几种基本用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#20-iotop-%E7%A3%81%E7%9B%98%E5%8D%A0%E7%94%A8%E7%BB%9F%E8%AE%A1%E5%B7%A5%E5%85%B7"><span class="nav-text">20. iotop 磁盘占用统计工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-%E5%87%A0%E7%A7%8D%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95-1"><span class="nav-text">1. 几种基本用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#21-%E5%9B%BE%E7%89%87%E6%93%8D%E4%BD%9C%E5%B7%A5%E5%85%B7-imagemagick"><span class="nav-text">21. 图片操作工具 imagemagick</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#21-1-%E5%9B%BE%E7%89%87%E8%BD%ACpdf"><span class="nav-text">21.1. 图片转pdf</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#21-2-pdf%E8%BD%AC%E5%9B%BE%E7%89%87"><span class="nav-text">21.2. pdf转图片</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#21-3-gif%E5%92%8C%E5%9B%BE%E7%89%87%E8%BD%AC%E6%8D%A2"><span class="nav-text">21.3. gif和图片转换</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#21-4-%E5%9B%BE%E7%89%87%E4%BF%A1%E6%81%AF%E6%9F%A5%E7%9C%8B"><span class="nav-text">21.4. 图片信息查看</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#22-%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%BB%9C%E5%BB%B6%E8%BF%9F-tc"><span class="nav-text">22. 模拟网络延迟 tc</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#22-1-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="nav-text">22.1. 基本操作</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#23-ltrace-%E8%B7%9F%E8%B8%AA%E5%BA%93%E5%87%BD%E6%95%B0%E8%B0%83%E7%94%A8"><span class="nav-text">23. ltrace 跟踪库函数调用</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#23-1-%E9%80%89%E9%A1%B9"><span class="nav-text">23.1 选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#23-2-%E5%AE%9E%E4%BE%8B"><span class="nav-text">23.2 实例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#24-dmidecode-%E8%8E%B7%E5%8F%96%E7%A1%AC%E4%BB%B6%E4%BF%A1%E6%81%AF"><span class="nav-text">24. dmidecode 获取硬件信息</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#24-1-%E8%8E%B7%E5%8F%96%E5%86%85%E5%AD%98%E4%BF%A1%E6%81%AF"><span class="nav-text">24.1. 获取内存信息</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#25-nc-%E7%BD%91%E7%BB%9C%E9%93%BE%E6%8E%A5%E5%B7%A5%E5%85%B7"><span class="nav-text">25. nc 网络链接工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#25-1-%E9%80%89%E9%A1%B9%E8%AF%A6%E8%A7%A3"><span class="nav-text">25.1. 选项详解</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#25-2-%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="nav-text">25.2. 基本用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#26-curl-%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E5%B7%A5%E5%85%B7"><span class="nav-text">26. curl 网络请求工具</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#26-1-%E9%80%89%E9%A1%B9%E8%A7%A3%E9%87%8A"><span class="nav-text">26.1. 选项解释</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#26-1-%E5%87%A0%E7%A7%8D%E5%B8%B8%E7%94%A8%E7%9A%84%E7%A4%BA%E4%BE%8B"><span class="nav-text">26.1. 几种常用的示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#27-clang"><span class="nav-text">27. clang</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#27-1-%E6%9F%A5%E7%9C%8B%E9%A2%84%E5%AE%9A%E4%B9%89%E5%AE%8F"><span class="nav-text">27.1. 查看预定义宏</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#28-brctl-%E7%BD%91%E6%A1%A5%E7%AE%A1%E7%90%86%E5%91%BD%E4%BB%A4"><span class="nav-text">28. brctl 网桥管理命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#28-1-%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="nav-text">28.1. 基本用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#29-sox-%E9%9F%B3%E9%A2%91%E8%BD%AC%E6%8D%A2%E5%91%BD%E4%BB%A4"><span class="nav-text">29. sox 音频转换命令</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#29-1-%E5%B8%B8%E7%94%A8%E7%94%A8%E6%B3%95"><span class="nav-text">29.1. 常用用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#30-nslookup-%E8%A7%A3%E6%9E%90%E5%9F%9F%E5%90%8D"><span class="nav-text">30. nslookup 解析域名</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#30-1-%E9%80%89%E9%A1%B9"><span class="nav-text">30.1. 选项</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#31-wget"><span class="nav-text">31. wget</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#31-1-%E9%80%89%E9%A1%B9"><span class="nav-text">31.1. 选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#31-2-%E7%A4%BA%E4%BE%8B"><span class="nav-text">31.2. 示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#32-hexdump"><span class="nav-text">32. hexdump</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#32-1-%E9%80%89%E9%A1%B9"><span class="nav-text">32.1. 选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#32-2-%E7%A4%BA%E4%BE%8B"><span class="nav-text">32.2. 示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#33-base64"><span class="nav-text">33. base64</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#33-1-%E9%80%89%E9%A1%B9"><span class="nav-text">33.1. 选项</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#33-2-%E7%A4%BA%E4%BE%8B"><span class="nav-text">33.2. 示例</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E5%B0%8F%E6%8A%80%E5%B7%A7"><span class="nav-text">四、小技巧</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-swap%E4%B8%B4%E6%97%B6%E7%A9%BA%E9%97%B4%EF%BC%88%E5%8F%AF%E7%94%A8%E4%BA%8E%E7%BC%96%E8%AF%91%E6%97%B6%E5%86%85%E5%AD%98%E4%B8%8D%E8%B6%B3%E9%97%AE%E9%A2%98%EF%BC%89"><span class="nav-text">1. swap临时空间（可用于编译时内存不足问题）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E8%87%AA%E9%A2%81%E5%8F%91%E8%AF%81%E4%B9%A6%EF%BC%88%E4%B8%8D%E5%8F%97%E4%BF%A1%EF%BC%89"><span class="nav-text">2. 自颁发证书（不受信）</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%BF%AB%E6%8D%B7%E9%94%AE"><span class="nav-text">3. 快捷键</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E5%AE%89%E8%A3%85%E8%BD%AF%E4%BB%B6"><span class="nav-text">4. 安装软件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-%E4%BA%8C%E8%BF%9B%E5%88%B6%E5%AE%89%E8%A3%85"><span class="nav-text">4.1. 二进制安装</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E4%BB%A3%E7%A0%81%E6%89%AB%E6%8F%8F"><span class="nav-text">5. 代码扫描</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E8%BD%AF%E4%BB%B6%E8%BF%90%E8%A1%8C"><span class="nav-text">6. 软件运行</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#6-1-%E4%B8%B4%E6%97%B6%E5%8A%A0%E8%BD%BD%E5%BA%93so"><span class="nav-text">6.1. 临时加载库so</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-%E8%84%9A%E6%9C%AC%E6%8A%80%E5%B7%A7"><span class="nav-text">7. 脚本技巧</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-%E8%8E%B7%E5%8F%96%E8%84%9A%E6%9C%AC%E6%89%80%E5%9C%A8%E7%9B%AE%E5%BD%95"><span class="nav-text">7.1. 获取脚本所在目录</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-%E6%9C%89%E7%94%A8%E7%9A%84%E8%BD%AF%E4%BB%B6"><span class="nav-text">8. 有用的软件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-1-%E7%99%BB%E9%99%86%E6%98%BE%E7%A4%BA%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF"><span class="nav-text">8.1. 登陆显示系统信息</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#8-2-x11vnc-linux%E8%BF%9C%E7%A8%8B%E6%A1%8C%E9%9D%A2"><span class="nav-text">8.2. x11vnc linux远程桌面</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-%E6%9F%A5%E7%9C%8B%E7%94%B5%E9%87%8F"><span class="nav-text">9. 查看电量</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-%E5%BD%93%E5%89%8D%E8%BF%90%E8%A1%8C%E5%91%BD%E4%BB%A4%E8%BD%AC%E5%90%8E%E5%8F%B0"><span class="nav-text">10. 当前运行命令转后台</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12-shell%E8%84%9A%E6%9C%AC%E5%8D%95%E4%BE%8B"><span class="nav-text">12. shell脚本单例</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-%E6%8C%82%E8%BD%BDwindows%E5%85%B1%E4%BA%AB%E6%96%87%E4%BB%B6%E5%A4%B9"><span class="nav-text">13. 挂载windows共享文件夹</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E8%B8%A9%E5%9D%91%E8%AE%B0-2"><span class="nav-text">踩坑记</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-ssh%E7%94%A8rsakey%E6%97%A0%E6%B3%95%E5%85%8D%E5%AF%86%E7%99%BB%E9%99%86"><span class="nav-text">1. ssh用rsakey无法免密登陆</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="王钰博" src="/images/12.jpg"><p class="site-author-name" itemprop="name">王钰博</p><div class="site-description" itemprop="description">个人博客</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">122</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">22</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">14</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/Githubwyb" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Githubwyb" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:1061322005@qq.com" title="E-Mail → mailto:1061322005@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://githubwyb.github.io/bookPages/" title="https:&#x2F;&#x2F;githubwyb.github.io&#x2F;bookPages&#x2F;">markdown books</a></li></ul></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">豫ICP备16023189号 </a><img src="/images/beian.png" style="display:inline-block"></div><div class="copyright">&copy; <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">王钰博</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span title="站点总字数">919k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">13:56</span></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动</div><div class="addthis_inline_share_toolbox"><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e1986d4e4e2d132" async></script></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/medium-zoom.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script src="/js/local-search.js"></script><script>document.querySelectorAll(".pdfobject-container").forEach(e=>{let t=e.dataset.target,a="#"+Object.entries({navpanes:0,toolbar:0,statusbar:0,pagemode:"thumbs",view:"FitH"}).map(([e,t])=>`${e}=${encodeURIComponent(t)}`).join("&"),i=`/lib/pdf/web/viewer.html?file=${encodeURIComponent(t)}${a}`;NexT.utils.supportsPDFs()?e.innerHTML=`<embed class="pdfobject" src="${t+a}" type="application/pdf" style="height: ${e.dataset.height};">`:e.innerHTML=`<iframe src="${i}" style="height: ${e.dataset.height};" frameborder="0"></iframe>`})</script><script>"undefined"==typeof MathJax?(window.MathJax={loader:{source:{"[tex]/amsCd":"[tex]/amscd","[tex]/AMScd":"[tex]/amscd"}},tex:{inlineMath:{"[+]":[["$","$"]]},tags:"ams"},options:{renderActions:{findScript:[10,e=>{document.querySelectorAll('script[type^="math/tex"]').forEach(t=>{const a=!!t.type.match(/; *mode=display/),n=new e.options.MathItem(t.textContent,e.inputJax[0],a),d=document.createTextNode("");t.parentNode.replaceChild(d,t),n.start={node:d,delim:"",n:0},n.end={node:d,delim:"",n:0},e.math.push(n)})},"",!1],insertedScript:[200,()=>{document.querySelectorAll("mjx-container").forEach(e=>{let t=e.parentNode;"li"===t.nodeName.toLowerCase()&&t.parentNode.classList.add("has-jax")})},"",!1]}}},function(){var e=document.createElement("script");e.src="/lib/mathjax/tex-mml-chtml.js",e.defer=!0,document.head.appendChild(e)}()):(MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset())</script><script>NexT.utils.loadComments(document.querySelector("#valine-comments"),()=>{NexT.utils.getScript("//unpkg.com/valine/dist/Valine.min.js",()=>{var e=["nick","mail","link"],a="nick,mail";a=a.split(",").filter(a=>e.includes(a)),new Valine({el:"#valine-comments",verify:!1,notify:!1,appId:"qmLbUHV1HOr841BOYkl84riu-gzGzoHsz",appKey:"j4fgTcf1yHRDD5X3HUH5EH95",placeholder:"^_^ happy everyday!",avatar:"wavatar",meta:a,pageSize:"10",visitor:!1,lang:"zh-cn",path:location.pathname,recordIP:!1,serverURLs:""})},window.Valine)})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":true,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"bottom":-30,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body><script type="text/javascript" src="/lib/jquery-3.4.1.min.js"></script><script type="text/javascript" src="/js/src/love.js"></script></html>