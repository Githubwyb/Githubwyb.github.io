<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-diy.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-diy.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-diy.png"><link rel="mask-icon" href="/images/logo-diy.svg" color="#222"><meta name="baidu-site-verification" content="y1cfESbTt9nd3LsA"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/lib/pace/pace-theme-flash.min.css"><script src="/lib/pace/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"githubwyb.github.io",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!0,color:"#ff0000",save:"auto"},fancybox:!1,mediumzoom:!0,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="shell命令 linux性能观测和排查 linux内核学习  一、系统知识1. profile、bashrc、bash_profile之间的关系 &#x2F;etc&#x2F;profile： 此文件为系统的每个用户设置环境信息,当用户第一次登录时,该文件被执行. 并从&#x2F;etc&#x2F;profile.d目录的配置文件中搜集shell的设置。 &#x2F;etc&#x2F;bashrc: 为每一个运行bash shell"><meta property="og:type" content="article"><meta property="og:title" content="linux相关知识"><meta property="og:url" content="https://githubwyb.github.io/blogs/2021-02-27-linux/index.html"><meta property="og:site_name" content="技术的路上奔跑"><meta property="og:description" content="shell命令 linux性能观测和排查 linux内核学习  一、系统知识1. profile、bashrc、bash_profile之间的关系 &#x2F;etc&#x2F;profile： 此文件为系统的每个用户设置环境信息,当用户第一次登录时,该文件被执行. 并从&#x2F;etc&#x2F;profile.d目录的配置文件中搜集shell的设置。 &#x2F;etc&#x2F;bashrc: 为每一个运行bash shell"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://githubwyb.github.io/blogs/2021-02-27-linux/2024-03-03-01.png"><meta property="article:published_time" content="2021-02-27T02:24:19.000Z"><meta property="article:modified_time" content="2024-06-24T13:11:41.000Z"><meta property="article:author" content="王钰博"><meta property="article:tag" content="Linux"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://githubwyb.github.io/blogs/2021-02-27-linux/2024-03-03-01.png"><link rel="canonical" href="https://githubwyb.github.io/blogs/2021-02-27-linux/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>linux相关知识 | 技术的路上奔跑</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">技术的路上奔跑</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">入门</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-fw fa-sitemap"></i>站点地图</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a> <a href="https://github.com/Githubwyb" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://githubwyb.github.io/blogs/2021-02-27-linux/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/12.jpg"><meta itemprop="name" content="王钰博"><meta itemprop="description" content="个人博客"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="技术的路上奔跑"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">linux相关知识</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2021-02-27 10:24:19" itemprop="dateCreated datePublished" datetime="2021-02-27T10:24:19+08:00">2021-02-27</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2024-06-24 21:11:41" itemprop="dateModified" datetime="2024-06-24T21:11:41+08:00">2024-06-24</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Program/" itemprop="url" rel="index"><span itemprop="name">Program</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Program/Shell/" itemprop="url" rel="index"><span itemprop="name">Shell</span></a> </span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span id="busuanzi_value_page_pv"></span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><span class="post-meta-item-text">Valine：</span> <a title="valine" href="/blogs/2021-02-27-linux/#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/blogs/2021-02-27-linux/" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>18k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>17 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><ul><li><a href="/blogs/2018-09-16-shellStudy/">shell命令</a></li><li><a href="/blogs/2023-05-25-linux-performance/">linux性能观测和排查</a></li><li><a href="/blogs/2021-03-22-linux-kernel">linux内核学习</a></li></ul><h1 id="一、系统知识"><a href="#一、系统知识" class="headerlink" title="一、系统知识"></a>一、系统知识</h1><h2 id="1-profile、bashrc、bash-profile之间的关系"><a href="#1-profile、bashrc、bash-profile之间的关系" class="headerlink" title="1. profile、bashrc、bash_profile之间的关系"></a>1. <code>profile</code>、<code>bashrc</code>、<code>bash_profile</code>之间的关系</h2><ul><li><code>/etc/profile</code>： 此文件为系统的每个用户设置环境信息,当用户第一次登录时,该文件被执行. 并从&#x2F;etc&#x2F;profile.d目录的配置文件中搜集shell的设置。</li><li><code>/etc/bashrc</code>: 为每一个运行bash shell的用户执行此文件.当bash shell被打开时,该文件被读取。</li><li><code>~/.bash_profile</code>: 每个用户都可使用该文件输入专用于自己使用的shell信息,当用户登录时,该文件仅仅执行一次!默认情况下,他设置一些环境变量,执行用户的.bashrc文件。</li><li><code>~/.bashrc</code>: 该文件包含专用于你的bash shell的bash信息,当登录时以及每次打开新的shell时,该该文件被读取。</li><li><code>~/.bash_logout</code>: 当每次退出系统(退出bash shell)时,执行该文件. 另外,&#x2F;etc&#x2F;profile中设定的变量(全局)的可以作用于任何用户,而~&#x2F;.bashrc等中设定的变量(局部)只能继承&#x2F;etc &#x2F;profile中的变量,他们是”父子”关系。</li><li><code>~/.bash_profile</code>是交互式、login 方式进入 bash 运行的</li><li>~&#x2F;.bashrc 是交互式 non-login 方式进入 bash 运行的通常二者设置大致相同，所以通常前者会调用后者。</li></ul><h2 id="2-service的几个知识"><a href="#2-service的几个知识" class="headerlink" title="2. service的几个知识"></a>2. service的几个知识</h2><h3 id="2-1-service-linux服务管理"><a href="#2-1-service-linux服务管理" class="headerlink" title="2.1. service linux服务管理"></a>2.1. service linux服务管理</h3><ul><li>service有两种管理方式，一个是用service命令，一个使用systemctl，自己感觉没啥区别，都需要写一个service文件</li><li>service文件位置: <code>/usr/lib/systemd/system/</code></li><li>服务文件内容一般如下，具体作用查看<code>man systemd.service</code></li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[Unit]</span></span><br><span class="line"><span class="attr">Description</span>=OpenBSD Secure Shell server</span><br><span class="line"><span class="attr">Documentation</span>=man:sshd(<span class="number">8</span>) man:sshd_config(<span class="number">5</span>)</span><br><span class="line"><span class="attr">After</span>=network.target auditd.service</span><br><span class="line"><span class="attr">ConditionPathExists</span>=!/etc/ssh/sshd_not_to_be_run</span><br><span class="line"></span><br><span class="line"><span class="section">[Service]</span></span><br><span class="line"><span class="attr">EnvironmentFile</span>=-/etc/default/ssh</span><br><span class="line"><span class="attr">ExecStartPre</span>=/usr/sbin/sshd -t</span><br><span class="line"><span class="attr">ExecStart</span>=/usr/sbin/sshd -D <span class="variable">$SSHD_OPTS</span></span><br><span class="line"><span class="attr">ExecReload</span>=/usr/sbin/sshd -t</span><br><span class="line"><span class="attr">ExecReload</span>=/bin/kill -HUP <span class="variable">$MAINPID</span></span><br><span class="line"><span class="attr">KillMode</span>=process</span><br><span class="line"><span class="attr">Restart</span>=<span class="literal">on</span>-failure</span><br><span class="line"><span class="attr">RestartPreventExitStatus</span>=<span class="number">255</span></span><br><span class="line"><span class="attr">Type</span>=notify</span><br><span class="line"><span class="attr">RuntimeDirectory</span>=sshd</span><br><span class="line"><span class="attr">RuntimeDirectoryMode</span>=<span class="number">0755</span></span><br><span class="line"></span><br><span class="line"><span class="section">[Install]</span></span><br><span class="line"><span class="comment"># 这个是用来配置开机启动的目标，在multi-user模式下启动服务</span></span><br><span class="line"><span class="attr">WantedBy</span>=multi-user.target</span><br><span class="line"><span class="attr">Alias</span>=sshd.service</span><br></pre></td></tr></table></figure><ul><li>配置了WantedBy后，使用<code>systemctl enable xxx</code>可以设置服务在某个模式下启动，会创建一个连接到<code>/etc/systemd/system/xxx.target.wanted/</code></li><li>一般配置开机启动设置WantedBy为<code>multi-user.target</code>，然后执行上一行的命令即可</li><li><code>Type=forking</code>会检测pidfile的进程状态</li></ul><h3 id="2-2-查看服务启动日志"><a href="#2-2-查看服务启动日志" class="headerlink" title="2.2. 查看服务启动日志"></a>2.2. 查看服务启动日志</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-f 跟踪日志</span></span><br><span class="line">journalctl -u [service_name] -f</span><br></pre></td></tr></table></figure><h2 id="3-开机启动脚本"><a href="#3-开机启动脚本" class="headerlink" title="3. 开机启动脚本"></a>3. 开机启动脚本</h2><p>update-rc.d enable&#x2F;disable&#x2F;defaults</p><h2 id="4-设备event事件查看"><a href="#4-设备event事件查看" class="headerlink" title="4. 设备event事件查看"></a>4. 设备event事件查看</h2><ul><li>使用下面命令可以查看键盘插入或者触摸板移动等信息</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-w 跟踪</span></span><br><span class="line">dmesg -w</span><br></pre></td></tr></table></figure><ul><li>使用下面命令查看usb拔插事件</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">udevadm monitor --environment --udev</span><br></pre></td></tr></table></figure><h2 id="5-用户组"><a href="#5-用户组" class="headerlink" title="5. 用户组"></a>5. 用户组</h2><h3 id="5-1-几个基本用法"><a href="#5-1-几个基本用法" class="headerlink" title="5.1. 几个基本用法"></a>5.1. 几个基本用法</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">将用户变更主组到group_name</span></span><br><span class="line">usermod -g [group_name] [user_name]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加用户组属性，不修改原有所属组</span></span><br><span class="line">usermod -a -G [group_name] [user_name]</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看用户所属组</span></span><br><span class="line">groups [user_name]</span><br></pre></td></tr></table></figure><h2 id="6-查看系统启动时间"><a href="#6-查看系统启动时间" class="headerlink" title="6. 查看系统启动时间"></a>6. 查看系统启动时间</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### who命令 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看最后一次系统启动时间</span></span><br><span class="line">=&gt; who -b</span><br><span class="line">         系统引导 2022-01-06 10:22</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">查看当前系统运行时间</span></span><br><span class="line">=&gt; who -r</span><br><span class="line">         运行级别 3 2022-01-06 10:24</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### last命令 ##########</span></span></span><br><span class="line">=&gt; last reboot</span><br><span class="line">reboot   system boot  4.19.181         Thu Jan  6 10:22   still running</span><br><span class="line">reboot   system boot  4.19.181         Sat Dec 18 20:06 - 10:20 (18+14:14)</span><br><span class="line">reboot   system boot  4.19.181         Sat Dec 18 19:26 - 20:04  (00:38)</span><br><span class="line">reboot   system boot  4.19.181         Tue Dec  7 13:49 - 20:04 (11+06:15)</span><br><span class="line">reboot   system boot  4.19.163         Mon Nov 22 22:41 - 13:47 (14+15:06)</span><br><span class="line"></span><br><span class="line">wtmp begins Mon Nov 22 10:40:48 2021</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### uptime命令 ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">只能看当前时间和启动了多久</span></span><br><span class="line">=&gt; uptime</span><br><span class="line"> 10:37:02 up 3 days, 17:50,  0 users,  load average: 5.29, 5.16, 5.04</span><br><span class="line"><span class="meta prompt_"></span></span><br><span class="line"><span class="meta prompt_">#</span><span class="language-bash"><span class="comment">######### /proc/uptime ##########</span></span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">展示从系统启动到现在经过多少s</span></span><br><span class="line">=&gt; cat /proc/uptime</span><br><span class="line">16235.69 22108.34</span><br></pre></td></tr></table></figure><h2 id="7-定时任务"><a href="#7-定时任务" class="headerlink" title="7. 定时任务"></a>7. 定时任务</h2><h3 id="7-1-cron格式说明"><a href="#7-1-cron格式说明" class="headerlink" title="7.1. cron格式说明"></a>7.1. cron格式说明</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">*    *    *    *    *    *</span><br><span class="line">┬    ┬    ┬    ┬    ┬    ┬</span><br><span class="line">│    │    │    │    │    |</span><br><span class="line">│    │    │    │    │    └ 星期 (0 - 7) (0或7都是星期日)</span><br><span class="line">│    │    │    │    └───── 月份 (1 - 12)</span><br><span class="line">│    │    │    └────────── 日期 (1 - 31)</span><br><span class="line">│    │    └─────────────── 小时 (0 - 23)</span><br><span class="line">│    └──────────────────── 分钟 (0 - 59)</span><br><span class="line">└───────────────────────── 秒 (0 - 59, optional)</span><br></pre></td></tr></table></figure><h2 id="8-进程的几种状态"><a href="#8-进程的几种状态" class="headerlink" title="8. 进程的几种状态"></a>8. 进程的几种状态</h2><p><a href="/blogs/2018-09-16-shellStudy/#process_status">top进程状态解析</a></p><h2 id="9-dev-介绍"><a href="#9-dev-介绍" class="headerlink" title="9. &#x2F;dev 介绍"></a>9. &#x2F;dev 介绍</h2><h3 id="9-1-dev-random和-dev-urandom"><a href="#9-1-dev-random和-dev-urandom" class="headerlink" title="9.1. /dev/random和/dev/urandom"></a>9.1. <code>/dev/random</code>和<code>/dev/urandom</code></h3><ul><li>用于产生真随机数，其中<code>/dev/random</code>依赖系统中断，所以较慢，但是随机性更好</li><li><code>/dev/urandom</code>不依赖系统中断，随机性较差</li><li>它们都依赖一个系统熵<ul><li>熵足够，两个都是真随机</li><li>熵不足，<code>/dev/random</code>会阻塞，<code>/dev/urandom</code>不会阻塞，依赖算法</li></ul></li><li>查看熵池大小: <code>/proc/sys/kernel/random/poolsize</code></li><li>查看熵池可用的数量: <code>/proc/sys/kernel/random/entropy_avail</code></li><li><code>/dev/random</code>和<code>/dev/urandom</code>都是字符型设备，可以当作文件直接读取</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">=&gt; stat /dev/random</span><br><span class="line">  File: /dev/random</span><br><span class="line">  Size: 0               Blocks: 0          IO Block: 4096   character special file</span><br><span class="line">Device: 0,5     Inode: 8           Links: 1     Device type: 1,8</span><br><span class="line">Access: (0666/crw-rw-rw-)  Uid: (    0/    root)   Gid: (    0/    root)</span><br><span class="line">Access: 2022-03-22 09:53:37.442304649 +0800</span><br><span class="line">Modify: 2022-03-22 09:53:37.442304649 +0800</span><br><span class="line">Change: 2022-03-22 09:53:37.442304649 +0800</span><br><span class="line"> Birth: -</span><br><span class="line">=&gt; stat /dev/urandom</span><br><span class="line">  File: /dev/urandom</span><br><span class="line">  Size: 0               Blocks: 0          IO Block: 4096   character special file</span><br><span class="line">Device: 0,5     Inode: 9           Links: 1     Device type: 1,9</span><br><span class="line">Access: (0666/crw-rw-rw-)  Uid: (    0/    root)   Gid: (    0/    root)</span><br><span class="line">Access: 2022-03-22 09:53:37.442304649 +0800</span><br><span class="line">Modify: 2022-03-22 09:53:37.442304649 +0800</span><br><span class="line">Change: 2022-03-22 09:53:37.442304649 +0800</span><br><span class="line"> Birth: -</span><br></pre></td></tr></table></figure><p><strong>如果不存在，可以通过下面命令挂载</strong></p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mknod /dev/random c 1 8</span><br><span class="line">mknod /dev/urandom c 1 9</span><br></pre></td></tr></table></figure><h2 id="10-proc介绍"><a href="#10-proc介绍" class="headerlink" title="10. &#x2F;proc介绍"></a>10. &#x2F;proc介绍</h2><ul><li>&#x2F;proc内存放了进程的信息</li></ul><h3 id="10-2-proc-pid-进程信息"><a href="#10-2-proc-pid-进程信息" class="headerlink" title="10.2. /proc/[pid] 进程信息"></a>10.2. <code>/proc/[pid]</code> 进程信息</h3><ul><li><code>/proc/self</code>为当前进程信息，可以直接在程序中进行读取</li></ul><h4 id="1-fd-保存当前进程打开的句柄"><a href="#1-fd-保存当前进程打开的句柄" class="headerlink" title="1) fd 保存当前进程打开的句柄"></a>1) fd 保存当前进程打开的句柄</h4><ul><li>0: 标准输入</li><li>1: 标准输出</li><li>2: 标准错误输出</li></ul><h4 id="2-maps-进程内存空间信息"><a href="#2-maps-进程内存空间信息" class="headerlink" title="2) maps 进程内存空间信息"></a>2) maps 进程内存空间信息</h4><ul><li>加载了什么库及其地址</li><li>进程的基地址信息</li></ul><h4 id="3-limits-显示进程的一些限制"><a href="#3-limits-显示进程的一些限制" class="headerlink" title="3) limits 显示进程的一些限制"></a>3) limits 显示进程的一些限制</h4><ul><li>unlimited就是没有限制</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">=&gt; cat /proc/self/limits</span><br><span class="line">Limit                     Soft Limit           Hard Limit           Units</span><br><span class="line">Max cpu time              unlimited            unlimited            seconds</span><br><span class="line">Max file size             unlimited            unlimited            bytes</span><br><span class="line">Max data size             unlimited            unlimited            bytes</span><br><span class="line">Max stack size            8388608              unlimited            bytes</span><br><span class="line">Max core file size        unlimited            unlimited            bytes</span><br><span class="line">Max resident set          unlimited            unlimited            bytes</span><br><span class="line">Max processes             14993                14993                processes</span><br><span class="line">Max open files            1024                 4096                 files</span><br><span class="line">Max locked memory         16777216             16777216             bytes</span><br><span class="line">Max address space         unlimited            unlimited            bytes</span><br><span class="line">Max file locks            unlimited            unlimited            locks</span><br><span class="line">Max pending signals       14993                14993                signals</span><br><span class="line">Max msgqueue size         819200               819200               bytes</span><br><span class="line">Max nice priority         0                    0</span><br><span class="line">Max realtime priority     0                    0</span><br><span class="line">Max realtime timeout      unlimited            unlimited            us</span><br></pre></td></tr></table></figure><p><strong>硬限制和软限制</strong></p><ul><li>硬限制只能由root用户进行扩大</li><li>软限制由用户自己修改，不能超过硬限制</li></ul><h4 id="4-cwd-当前工作目录"><a href="#4-cwd-当前工作目录" class="headerlink" title="4) cwd 当前工作目录"></a>4) cwd 当前工作目录</h4><ul><li>cwd是一个软连接，指向对应的工作目录</li><li>查看进程当前工作目录</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">=&gt; ll /proc/57733/cwd</span><br><span class="line">lrwxrwxrwx 1 test test 0 Aug 16 09:29 /proc/57733/cwd -&gt; /home/test</span><br></pre></td></tr></table></figure><h3 id="10-3-proc-sys-保存内核的参数"><a href="#10-3-proc-sys-保存内核的参数" class="headerlink" title="10.3. /proc/sys 保存内核的参数"></a>10.3. <code>/proc/sys</code> 保存内核的参数</h3><ul><li>修改可以查看<a href="/blogs/2018-09-16-shellStudy/#37-sysctl-%E4%BF%AE%E6%94%B9%E5%86%85%E6%A0%B8%E5%8F%82%E6%95%B0">sysctl</a></li></ul><h4 id="1-列举几个内核参数含义"><a href="#1-列举几个内核参数含义" class="headerlink" title="1) 列举几个内核参数含义"></a>1) 列举几个内核参数含义</h4><ul><li><code>/proc/sys/fs/file-max</code>: 系统最多能打开的文件句柄数</li><li><code>/proc/sys/kernel/threads-max</code>: 系统最大线程数量</li><li><code>/proc/sys/kernel/pid-max</code>: pid的最大数</li></ul><h4 id="2-proc-sys-net-ipv4-conf-interface-rp-filter"><a href="#2-proc-sys-net-ipv4-conf-interface-rp-filter" class="headerlink" title="2) /proc/sys/net/ipv4/conf/interface/rp_filter "></a>2) <code>/proc/sys/net/ipv4/conf/interface/rp_filter</code></h4><p><a href="/bookPages/docs/linux-kernel/net/ipv4/ipv4/index.html#21-rp_filter%E5%A6%82%E4%BD%95%E7%94%9F%E6%95%88">rp_filter在内核代码如何生效</a></p><ul><li>对应sysctl变量<code>net.ipv4.conf.[interface].rp_filter</code></li><li>内核取值会取all和当前进入的网卡较大的那个值</li><li><code>rp_filter</code>设置成1则会在当前网卡收包处理时，如果发现源地址作为目的地址路由不是指向此网卡，将会丢包，具体原理看上面链接</li><li>设置值的说明见 <a target="_blank" rel="noopener" href="https://sysctl-explorer.net/net/ipv4/rp_filter/">rp_filter|sysctl-explorer.net</a></li></ul><h2 id="11-管道"><a href="#11-管道" class="headerlink" title="11. 管道"></a>11. 管道</h2><ul><li>进程间通信可以使用管道</li><li>管道的本质是起了两个子进程，一个进程的标准输出为另一个进程的标准输入</li></ul><h3 id="11-1-示例"><a href="#11-1-示例" class="headerlink" title="11.1. 示例"></a>11.1. 示例</h3><ul><li>使用read让管道两边的进程阻塞</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">=&gt; &#123; echo &quot;aaa&quot;; read n &#125; | &#123; cat; read p &#125;</span><br><span class="line">aaa</span><br></pre></td></tr></table></figure><ul><li>查看进程树</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">=&gt; ps -auxf</span><br><span class="line">...</span><br><span class="line">test_user    2262  0.0  0.0  16840  8192 pts/2    Ss   11:41   0:01  |   \_ -zsh</span><br><span class="line">test_user   10342  0.0  0.0  16840  3412 pts/2    S+   14:20   0:00  |   |   \_ -zsh</span><br><span class="line">test_user   10343  0.0  0.0  10792   976 pts/2    S+   14:20   0:00  |   |   \_ cat</span><br><span class="line">...</span><br></pre></td></tr></table></figure><ul><li>明显看到父进程起了两个子进程</li><li>再查看它们的句柄</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">=&gt; ls -l /proc/10342/fd</span><br><span class="line">total 0</span><br><span class="line">lrwx------ 1 test_user test_user 64 Jun 20 14:27 0 -&gt; /dev/pts/2</span><br><span class="line">l-wx------ 1 test_user test_user 64 Jun 20 14:27 1 -&gt; &#x27;pipe:[224646]&#x27;</span><br><span class="line">lrwx------ 1 test_user test_user 64 Jun 20 14:27 10 -&gt; /dev/pts/2</span><br><span class="line">lrwx------ 1 test_user test_user 64 Jun 20 14:27 2 -&gt; /dev/pts/2</span><br><span class="line">=&gt; ls -l /proc/10343/fd</span><br><span class="line">total 0</span><br><span class="line">lr-x------ 1 test_user test_user 64 Jun 20 14:27 0 -&gt; &#x27;pipe:[224646]&#x27;</span><br><span class="line">lrwx------ 1 test_user test_user 64 Jun 20 14:27 1 -&gt; /dev/pts/2</span><br><span class="line">lrwx------ 1 test_user test_user 64 Jun 20 14:27 2 -&gt; /dev/pts/2</span><br></pre></td></tr></table></figure><ul><li>左边进程的标准输出到管道，右边进程的标准输入为管道</li></ul><h2 id="12-文件类型"><a href="#12-文件类型" class="headerlink" title="12. 文件类型"></a>12. 文件类型</h2><ul><li>linux下存在很多种文件类型，一切皆文件</li><li>使用<code>ls -l</code>可以查看文件类型</li></ul><p><strong>几种类型</strong></p><ul><li><code>-</code>: 普通文件，文本或二进制</li><li><code>d</code>: 目录</li><li><code>l</code>: 链接</li><li><code>b</code>: 块设备，磁盘就是块设备，可以向前向后读</li><li><code>c</code>: 字符型设备，比如<code>/dev/zero</code>、<code>/dev/random</code>等，只能读取当前</li><li><code>s</code>: 套接字文件，用于链接建立等</li><li><code>p</code>: 管道文件，不过一般是命名管道，正常的管道一般不可见</li></ul><h2 id="13-进程"><a href="#13-进程" class="headerlink" title="13. 进程"></a>13. 进程</h2><h3 id="13-1-最多能创建多少线程"><a href="#13-1-最多能创建多少线程" class="headerlink" title="13.1. 最多能创建多少线程"></a>13.1. 最多能创建多少线程</h3><ul><li>取决于进程的虚拟内存大小和每个线程需要占用的栈大小</li><li>32位系统下，4G虚拟内存，内核占用1G，剩余3G。每个线程栈大小，由<code>ulimit -s</code>可以查看，假设8M。那么最多创建300多个线程就会内存不足</li><li>64位系统下，取决于linux系统下的线程最大数量、全局pid号数量限制、进程可以拥有的VMA数量</li></ul><h3 id="13-2-最大能打开的文件句柄数"><a href="#13-2-最大能打开的文件句柄数" class="headerlink" title="13.2. 最大能打开的文件句柄数"></a>13.2. 最大能打开的文件句柄数</h3><h2 id="14-可执行文件的结构"><a href="#14-可执行文件的结构" class="headerlink" title="14. 可执行文件的结构"></a>14. 可执行文件的结构</h2><h3 id="14-1-查看可执行文件的大小"><a href="#14-1-查看可执行文件的大小" class="headerlink" title="14.1.  查看可执行文件的大小"></a>14.1. 查看可执行文件的大小</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello, world&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">=&gt; gcc -g main.cpp</span><br><span class="line">=&gt; size a.out</span><br><span class="line">   text    data     bss     dec     hex filename</span><br><span class="line">   1576     616       8    2200     898 a.out</span><br></pre></td></tr></table></figure><h3 id="14-2-解析"><a href="#14-2-解析" class="headerlink" title="14.2. 解析"></a>14.2. 解析</h3><h4 id="1-bss-未初始化数据区"><a href="#1-bss-未初始化数据区" class="headerlink" title="1) bss 未初始化数据区"></a>1) bss 未初始化数据区</h4><ul><li>Block Started by Symbol 以符号开始的段，通常指未初始化的数据段</li><li>代码中定义的未初始化的全局变量和静态变量存放到此区域</li><li>此区域会被内核初始化成0，所以为什么没有初始化的全局变量和静态变量会是0的原因</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a[<span class="number">1000</span>];</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello, world&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">=&gt; gcc -g main.cpp</span><br><span class="line">=&gt; size a.out</span><br><span class="line">   text    data     bss     dec     hex filename</span><br><span class="line">   1576     616    4008    6200    1838 a.out</span><br></pre></td></tr></table></figure><ul><li>可以看到bss段增加了<code>4 * 1000</code>字节</li></ul><h4 id="2-data-静态数据和全局初始化的数据区"><a href="#2-data-静态数据和全局初始化的数据区" class="headerlink" title="2) data 静态数据和全局初始化的数据区"></a>2) data 静态数据和全局初始化的数据区</h4><ul><li>初始化的静态变量和全局变量会放到此区域</li><li>初始化成0的变量会被编译器优化放到bss段</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="type">int</span> a = <span class="number">100</span>;</span><br><span class="line"><span class="type">int</span> b = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello, world&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">=&gt; gcc -g main.cpp</span><br><span class="line">=&gt; size a.out</span><br><span class="line">   text    data     bss     dec     hex filename</span><br><span class="line">   1576     620      12    2208     8a0 a.out</span><br></pre></td></tr></table></figure><ul><li>可以看到定义了两个int型变量，一个增加了data段，一个增加了bss段，各4个字节</li></ul><h4 id="3-text-代码段，存放代码指令"><a href="#3-text-代码段，存放代码指令" class="headerlink" title="3) text 代码段，存放代码指令"></a>3) text 代码段，存放代码指令</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">(<span class="type">int</span> argc, <span class="type">char</span> **argv)</span> </span>&#123;</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello, world&quot;</span>);</span><br><span class="line">    <span class="built_in">printf</span>(<span class="string">&quot;Hello, world1&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">=&gt; gcc -g main.cpp</span><br><span class="line">=&gt; size a.out</span><br><span class="line">   text    data     bss     dec     hex filename</span><br><span class="line">   1605     616       8    2229     8b5 a.out</span><br></pre></td></tr></table></figure><ul><li>bss和data都没增加，text段增加了代码指令</li></ul><h1 id="二、有用的几个技巧"><a href="#二、有用的几个技巧" class="headerlink" title="二、有用的几个技巧"></a>二、有用的几个技巧</h1><h2 id="1-linux启动到文本界面和到图形界面"><a href="#1-linux启动到文本界面和到图形界面" class="headerlink" title="1. linux启动到文本界面和到图形界面"></a>1. linux启动到文本界面和到图形界面</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动到文本界面</span></span><br><span class="line">systemctl set-default multi-user.target</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">启动到图形界面</span></span><br><span class="line">systemctl set-default graphical.target</span><br></pre></td></tr></table></figure><h2 id="2-修改硬盘的uuid"><a href="#2-修改硬盘的uuid" class="headerlink" title="2. 修改硬盘的uuid"></a>2. 修改硬盘的uuid</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">随机生成uuid写入</span></span><br><span class="line">uuidgen | xargs tune2fs /dev/sda5 -U</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">写入自己生成uuid</span></span><br><span class="line">tune2fs -U c1b9d5a2-f162-11cf-9ece-0020afc76f16 /dev/sdb1</span><br></pre></td></tr></table></figure><h2 id="3-hostname立即生效"><a href="#3-hostname立即生效" class="headerlink" title="3. hostname立即生效"></a>3. hostname立即生效</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hostname &quot;$(cat /etc/hostname)&quot;</span><br></pre></td></tr></table></figure><h2 id="4-bpf-主要用于网络数据分析"><a href="#4-bpf-主要用于网络数据分析" class="headerlink" title="4. bpf 主要用于网络数据分析"></a>4. bpf 主要用于网络数据分析</h2><p>原理参考 <a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1698426">Linux超能力BPF技术介绍及学习分享</a></p><ul><li>新版tcpdump就是基于bpf技术实现的</li></ul><h2 id="5-设置无操作用户自动退出"><a href="#5-设置无操作用户自动退出" class="headerlink" title="5. 设置无操作用户自动退出"></a>5. 设置无操作用户自动退出</h2><ul><li>修改<code>/etc/profile</code>，添加</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export TMOUT=15   # 无操作15秒自动退出</span><br><span class="line">readonly TMOUT    # 不允许用户修改此变量</span><br></pre></td></tr></table></figure><h2 id="6-系统时间和硬件时间同步"><a href="#6-系统时间和硬件时间同步" class="headerlink" title="6. 系统时间和硬件时间同步"></a>6. 系统时间和硬件时间同步</h2><ul><li>使用hwclock命令</li><li>下面是几种基本用法</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">显示硬件时间，启动就会读取的时间，和系统不一致就是每次重启时间都不对</span></span><br><span class="line">=&gt; sudo hwclock --show</span><br><span class="line">2022-12-09 17:35:28.288827+08:00</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">硬件时间同步到系统时间，开机会自动执行</span></span><br><span class="line">=&gt; sudo hwclock --hctosys</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">系统时间同步到硬件时间，可以在同步系统时间后进行执行，保证重启后和当前一致</span></span><br><span class="line">=&gt; sudo hwclock --systohc</span><br></pre></td></tr></table></figure><h2 id="7-设置时区"><a href="#7-设置时区" class="headerlink" title="7. 设置时区"></a>7. 设置时区</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -sf /usr/share/zoneinfo/Asia/Beijing /etc/localtime</span><br></pre></td></tr></table></figure><h2 id="8-添加一个用户"><a href="#8-添加一个用户" class="headerlink" title="8. 添加一个用户"></a>8. 添加一个用户</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加用户</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-d 设置home目录</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">-s 设置shell</span></span><br><span class="line">useradd test -d /home/test -s /bin/zsh</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">设置密码</span></span><br><span class="line">passwd test</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">添加目录</span></span><br><span class="line">mkdir /home/test</span><br><span class="line">chown test:test /home/test</span><br></pre></td></tr></table></figure><h3 id="8-1-给用户执行sudo的权力"><a href="#8-1-给用户执行sudo的权力" class="headerlink" title="8.1. 给用户执行sudo的权力"></a>8.1. 给用户执行sudo的权力</h3><ul><li>需要安装sudo包，然后执行<code>visudo</code></li><li>在打开的sudoers文件中，找到以下行：<code>root ALL=(ALL) ALL</code>。</li><li>在该行下面添加以下内容：<code>username ALL=(ALL) ALL</code>，其中username是你要授予管理员权限的用户名。</li><li>保存并关闭sudoers文件。</li></ul><h2 id="9-journalctl-检查服务日志"><a href="#9-journalctl-检查服务日志" class="headerlink" title="9. journalctl 检查服务日志"></a>9. journalctl 检查服务日志</h2><h3 id="9-1-选项"><a href="#9-1-选项" class="headerlink" title="9.1. 选项"></a>9.1. 选项</h3><ul><li><code>-u &lt;unit&gt;</code>: 显示具体服务当前的日志</li></ul><h2 id="10-命令行配置socks5代理"><a href="#10-命令行配置socks5代理" class="headerlink" title="10. 命令行配置socks5代理"></a>10. 命令行配置socks5代理</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export http_proxy=&quot;socks5://127.0.0.1:1080&quot;</span><br><span class="line">export https_proxy=&quot;socks5://127.0.0.1:1080&quot;</span><br></pre></td></tr></table></figure><h1 id="三、c-c-编程"><a href="#三、c-c-编程" class="headerlink" title="三、c&#x2F;c++编程"></a>三、c&#x2F;c++编程</h1><h2 id="1-获取系统信息"><a href="#1-获取系统信息" class="headerlink" title="1. 获取系统信息"></a>1. 获取系统信息</h2><ul><li>sysinfo结构体定义</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// sysinfo.h</span></span><br><span class="line"><span class="keyword">struct</span> <span class="title class_">sysinfo</span> &#123;</span><br><span class="line">	<span class="type">__kernel_long_t</span> uptime;		<span class="comment">/* Seconds since boot */</span></span><br><span class="line">	<span class="type">__kernel_ulong_t</span> loads[<span class="number">3</span>];	<span class="comment">/* 1, 5, and 15 minute load averages */</span></span><br><span class="line">	<span class="type">__kernel_ulong_t</span> totalram;	<span class="comment">/* Total usable main memory size */</span></span><br><span class="line">	<span class="type">__kernel_ulong_t</span> freeram;	<span class="comment">/* Available memory size */</span></span><br><span class="line">	<span class="type">__kernel_ulong_t</span> sharedram;	<span class="comment">/* Amount of shared memory */</span></span><br><span class="line">	<span class="type">__kernel_ulong_t</span> bufferram;	<span class="comment">/* Memory used by buffers */</span></span><br><span class="line">	<span class="type">__kernel_ulong_t</span> totalswap;	<span class="comment">/* Total swap space size */</span></span><br><span class="line">	<span class="type">__kernel_ulong_t</span> freeswap;	<span class="comment">/* swap space still available */</span></span><br><span class="line">	__u16 procs;		   	<span class="comment">/* Number of current processes */</span></span><br><span class="line">	__u16 pad;		   	<span class="comment">/* Explicit padding for m68k */</span></span><br><span class="line">	<span class="type">__kernel_ulong_t</span> totalhigh;	<span class="comment">/* Total high memory size */</span></span><br><span class="line">	<span class="type">__kernel_ulong_t</span> freehigh;	<span class="comment">/* Available high memory size */</span></span><br><span class="line">	__u32 mem_unit;			<span class="comment">/* Memory unit size in bytes */</span></span><br><span class="line">	<span class="type">char</span> _f[<span class="number">20</span><span class="number">-2</span>*<span class="built_in">sizeof</span>(<span class="type">__kernel_ulong_t</span>)-<span class="built_in">sizeof</span>(__u32)];	<span class="comment">/* Padding: libc5 uses this.. */</span></span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><ul><li>获取系统信息</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;sys/sysinfo.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;errno.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;string.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">main</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">sysinfo</span> info;</span><br><span class="line">	<span class="comment">// 操作成功返回0，失败返回-1</span></span><br><span class="line">    <span class="keyword">if</span> (<span class="built_in">sysinfo</span>(&amp;info)) &#123;</span><br><span class="line">        <span class="built_in">printf</span>(<span class="string">&quot;failed to get sysinfo, errno: %u, reason: %s\n&quot;</span>, errno, <span class="built_in">strerror</span>(errno));</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// do something</span></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-获取进程id"><a href="#2-获取进程id" class="headerlink" title="2. 获取进程id"></a>2. 获取进程id</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// unistd.h</span></span><br><span class="line"><span class="function"><span class="type">__pid_t</span> <span class="title">getpid</span> <span class="params">(<span class="type">void</span>)</span> __THROW</span>;</span><br></pre></td></tr></table></figure><h2 id="3-获取系统时间"><a href="#3-获取系统时间" class="headerlink" title="3. 获取系统时间"></a>3. 获取系统时间</h2><ul><li>一般获取系统时间有两个函数<code>gettimeofday</code>和<code>clock_gettime</code></li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// /usr/include/time.h</span></span><br><span class="line"><span class="comment">/* Get current value of clock CLOCK_ID and store it in TP.  */</span></span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="type">int</span> <span class="title">clock_gettime</span> <span class="params">(<span class="type">clockid_t</span> __clock_id, <span class="keyword">struct</span> timespec *__tp)</span></span></span><br><span class="line"><span class="function">     __THROW __<span class="title">nonnull</span><span class="params">((<span class="number">2</span>))</span></span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// /usr/include/time.h</span></span><br><span class="line"><span class="comment">/* Get the current time of day, putting it into *TV.</span></span><br><span class="line"><span class="comment">   If TZ is not null, *TZ must be a struct timezone, and both fields</span></span><br><span class="line"><span class="comment">   will be set to zero.</span></span><br><span class="line"><span class="comment">   Calling this function with a non-null TZ is obsolete;</span></span><br><span class="line"><span class="comment">   use localtime etc. instead.</span></span><br><span class="line"><span class="comment">   This function itself is semi-obsolete;</span></span><br><span class="line"><span class="comment">   most callers should use time or clock_gettime instead. */</span></span><br><span class="line"><span class="meta">#<span class="keyword">ifndef</span> __USE_TIME_BITS64</span></span><br><span class="line"><span class="function"><span class="keyword">extern</span> <span class="type">int</span> <span class="title">gettimeofday</span> <span class="params">(<span class="keyword">struct</span> timeval *__restrict __tv,</span></span></span><br><span class="line"><span class="params"><span class="function">			 <span class="type">void</span> *__restrict __tz)</span> __THROW __<span class="title">nonnull</span> <span class="params">((<span class="number">1</span>))</span></span>;</span><br><span class="line"><span class="meta">#<span class="keyword">else</span></span></span><br><span class="line"><span class="meta"># <span class="keyword">ifdef</span> __REDIRECT_NTH</span></span><br><span class="line"><span class="keyword">extern</span> <span class="type">int</span> __REDIRECT_NTH (gettimeofday, (<span class="keyword">struct</span> timeval *__restrict __tv,</span><br><span class="line">                                          <span class="type">void</span> *__restrict __tz),</span><br><span class="line">                           __gettimeofday64) __nonnull ((<span class="number">1</span>));</span><br><span class="line"><span class="meta"># <span class="keyword">else</span></span></span><br><span class="line"><span class="meta">#  <span class="keyword">define</span> gettimeofday __gettimeofday64</span></span><br><span class="line"><span class="meta"># <span class="keyword">endif</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">endif</span></span></span><br></pre></td></tr></table></figure><ul><li><code>clock_gettime</code>有下面几种类型</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// /usr/include/bits/time.h</span></span><br><span class="line"><span class="comment">/* Identifier for system-wide realtime clock.  */</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> CLOCK_REALTIME			0       <span class="comment">// 从1970.01.01到现在的时间</span></span></span><br><span class="line"><span class="comment">/* Monotonic system-wide clock.  */</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> CLOCK_MONOTONIC		1       <span class="comment">// 系统启动到现在的时间</span></span></span><br><span class="line"><span class="comment">/* High-resolution timer from the CPU.  */</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> CLOCK_PROCESS_CPUTIME_ID	2   <span class="comment">// 进程所消耗的时间，sleep不再计时</span></span></span><br><span class="line"><span class="comment">/* Thread-specific CPU-time clock.  */</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> CLOCK_THREAD_CPUTIME_ID	3   <span class="comment">// 线程消耗时间，sleep不再计时</span></span></span><br><span class="line"><span class="comment">/* Monotonic system-wide clock, not adjusted for frequency scaling.  */</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> CLOCK_MONOTONIC_RAW		4   <span class="comment">// 硬件时间</span></span></span><br><span class="line"><span class="comment">/* Identifier for system-wide realtime clock, updated only on ticks.  */</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> CLOCK_REALTIME_COARSE		5   <span class="comment">// 不精确的realtime，速度更快精度更低</span></span></span><br><span class="line"><span class="comment">/* Monotonic system-wide clock, updated only on ticks.  */</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> CLOCK_MONOTONIC_COARSE		6   <span class="comment">// 不精确的MONOTONIC，速度更快精度更低</span></span></span><br><span class="line"><span class="comment">/* Monotonic system-wide clock that includes time spent in suspension.  */</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> CLOCK_BOOTTIME			7</span></span><br><span class="line"><span class="comment">/* Like CLOCK_REALTIME but also wakes suspended system.  */</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> CLOCK_REALTIME_ALARM		8</span></span><br><span class="line"><span class="comment">/* Like CLOCK_BOOTTIME but also wakes suspended system.  */</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> CLOCK_BOOTTIME_ALARM		9</span></span><br><span class="line"><span class="comment">/* Like CLOCK_REALTIME but in International Atomic Time.  */</span></span><br><span class="line"><span class="meta"># <span class="keyword">define</span> CLOCK_TAI			11      <span class="comment">// 原子钟的时间，与CLOCK_REALTIME类似，不可被更改，没有闰秒</span></span></span><br></pre></td></tr></table></figure><h2 id="4-errno"><a href="#4-errno" class="headerlink" title="4. errno"></a>4. errno</h2><ul><li>errno线程唯一，不用担心多线程问题</li><li>errno在头文件<code>unistd.h</code></li><li><code>strerror()</code>在头文件<code>string.h</code></li></ul><h1 id="四、虚拟内存"><a href="#四、虚拟内存" class="headerlink" title="四、虚拟内存"></a>四、虚拟内存</h1><h2 id="1-基础知识"><a href="#1-基础知识" class="headerlink" title="1. 基础知识"></a>1. 基础知识</h2><ul><li>虚拟内存是每个进程有自己的虚拟地址空间，不同的进程之间的虚拟地址空间一样，但是对应的物理地址空间不一样</li><li>32位下，每个进程拥有4G虚拟地址空间，其中1G为内核空间，3G为用户空间</li><li>每个进程有一个页表，存放在进程的信息中，mmu处理每个进程的虚拟地址到物理地址映射时要读取不同进程的页表，通过页表寄存器指定页表地址</li></ul><h1 id="五、进程"><a href="#五、进程" class="headerlink" title="五、进程"></a>五、进程</h1><h2 id="1-进程间通信"><a href="#1-进程间通信" class="headerlink" title="1. 进程间通信"></a>1. 进程间通信</h2><ul><li>进程间通信有管道、命名管道、信号、信号量、消息队列、共享内存、套接字</li></ul><h3 id="1-1-管道"><a href="#1-1-管道" class="headerlink" title="1.1. 管道"></a>1.1. 管道</h3><h4 id="1-特点"><a href="#1-特点" class="headerlink" title="1) 特点"></a>1) 特点</h4><ul><li>数据只能向一个方向流动</li><li>只能用于父子进程或兄弟进程</li><li>fifo的读出和写入</li><li>缓冲区有限，本身存在于内存中，分配了一个page大小</li></ul><h4 id="2-创建"><a href="#2-创建" class="headerlink" title="2) 创建"></a>2) 创建</h4><ul><li>通过shell的<code>|</code>创建</li><li>通过代码的创建</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">pipe</span><span class="params">(<span class="type">int</span> fd[<span class="number">2</span>])</span></span>;</span><br></pre></td></tr></table></figure><ul><li>管道的创建需要在父进程，然后再fork出子进程使用，或给两个兄弟子进程使用</li></ul><h3 id="1-2-命名管道"><a href="#1-2-命名管道" class="headerlink" title="1.2. 命名管道"></a>1.2. 命名管道</h3><h4 id="1-特点-1"><a href="#1-特点-1" class="headerlink" title="1) 特点"></a>1) 特点</h4><ul><li>需要提供一个文件路径，两个进程通过路径进行联系，所以可以没有亲缘关系的进程通信</li><li>内部没有fifo，读写会阻塞</li><li>其他和管道一致</li></ul><h4 id="2-创建-1"><a href="#2-创建-1" class="headerlink" title="2) 创建"></a>2) 创建</h4><ul><li>shell通过<code>mkfifo xxx</code>创建管道，使用<code>&gt;</code>和<code>&lt;</code>进行读取写入</li><li>通过代码创建，正常按照文件一样打开和读写即可</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">mkfifo</span><span class="params">(<span class="type">const</span> <span class="type">char</span> *pathname, <span class="type">mode_t</span> mode)</span></span>;</span><br></pre></td></tr></table></figure><h3 id="1-3-信号"><a href="#1-3-信号" class="headerlink" title="1.3. 信号"></a>1.3. 信号</h3><h4 id="1-特点-2"><a href="#1-特点-2" class="headerlink" title="1) 特点"></a>1) 特点</h4><ul><li>进程不知道信号什么时候来，类似于中断</li><li>信号通俗讲就是系统定义的信号，也就是kill可以发出的信号</li></ul><h4 id="2-使用"><a href="#2-使用" class="headerlink" title="2) 使用"></a>2) 使用</h4><ul><li>代码注册信号</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment"> * 函数名：BR_SignalRegister</span></span><br><span class="line"><span class="comment"> * 功 能：BugReport信号注册函数</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"><span class="function"><span class="type">static</span> <span class="type">int</span> <span class="title">BR_SignalRegister</span><span class="params">(<span class="type">int</span> sig)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">struct</span> <span class="title class_">sigaction</span> act;</span><br><span class="line">    <span class="built_in">memset</span>(&amp;act, <span class="number">0</span>, <span class="built_in">sizeof</span>(act));</span><br><span class="line">    act.sa_handler = (<span class="type">__sighandler_t</span>)BR_SignalHandler;</span><br><span class="line">    act.sa_flags = <span class="number">0</span>;</span><br><span class="line">    (<span class="type">void</span>)<span class="built_in">sigemptyset</span>(&amp;act.sa_mask);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (<span class="built_in">sigaction</span>(sig, &amp;act, <span class="literal">NULL</span>) &lt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="keyword">if</span> (errno != EINTR) &#123;</span><br><span class="line">            (<span class="type">void</span>)<span class="built_in">fprintf</span>(stderr, <span class="string">&quot;[BugReport]sigaction %s failed: %s\n&quot;</span>,</span><br><span class="line">                          BR_signals[sig], <span class="built_in">strerror</span>(errno));</span><br><span class="line">            <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="1-4-信号量"><a href="#1-4-信号量" class="headerlink" title="1.4. 信号量"></a>1.4. 信号量</h3><h4 id="1-特点-3"><a href="#1-特点-3" class="headerlink" title="1) 特点"></a>1) 特点</h4><ul><li>主要用于进程间共享资源访问控制机制</li><li>两种类型<ul><li>二值信号量：只能0和1</li><li>计算信号量：非负值</li></ul></li></ul><h4 id="2-使用-1"><a href="#2-使用-1" class="headerlink" title="2) 使用"></a>2) 使用</h4><ul><li>创建使用</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">semget</span><span class="params">(<span class="type">key_t</span> key, <span class="type">int</span> num_sems, <span class="type">int</span> sem_flags)</span></span></span><br></pre></td></tr></table></figure><ul><li>操作函数</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 改变信号量</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">semop</span><span class="params">(<span class="type">int</span> sem_id, <span class="keyword">struct</span> sembuf *sem_opa, <span class="type">size_t</span> num_sem_ops)</span></span>;</span><br><span class="line"><span class="comment">// 控制信号量</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">semctl</span><span class="params">(<span class="type">int</span> sem_id, <span class="type">int</span> sem_num, <span class="type">int</span> command, ...)</span></span>;</span><br></pre></td></tr></table></figure><h3 id="1-5-消息队列"><a href="#1-5-消息队列" class="headerlink" title="1.5. 消息队列"></a>1.5. 消息队列</h3><h4 id="1-特点-4"><a href="#1-特点-4" class="headerlink" title="1) 特点"></a>1) 特点</h4><ul><li>就是在命名管道上加了个fifo，避免阻塞</li><li>可以通过消息类型有选择的接收数据</li></ul><h4 id="2-使用-2"><a href="#2-使用-2" class="headerlink" title="2) 使用"></a>2) 使用</h4><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 创建或获取已存在的消息队列</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">msgget</span><span class="params">(<span class="type">key_t</span> key, <span class="type">int</span> msgflg)</span></span>;</span><br><span class="line"><span class="comment">// 发送</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">msgsnd</span><span class="params">(<span class="type">int</span> msqid, <span class="type">void</span> *msgp, <span class="type">int</span> msgsz, <span class="type">int</span> msgflg)</span></span>;</span><br><span class="line"><span class="comment">// 接收</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">msgrcv</span><span class="params">(<span class="type">int</span> msgid, <span class="type">void</span> *msgp, <span class="type">int</span> msgsz, <span class="type">long</span> msgtyp, <span class="type">int</span> msgflg)</span></span>;</span><br></pre></td></tr></table></figure><h3 id="1-6-共享内存"><a href="#1-6-共享内存" class="headerlink" title="1.6. 共享内存"></a>1.6. 共享内存</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">shmget</span><span class="params">(<span class="type">key_t</span> key, <span class="type">size_t</span> size, <span class="type">int</span> shmflg)</span></span>;</span><br></pre></td></tr></table></figure><h3 id="1-7-套接字"><a href="#1-7-套接字" class="headerlink" title="1.7. 套接字"></a>1.7. 套接字</h3><h1 id="六、nss-Name-Service-Switch"><a href="#六、nss-Name-Service-Switch" class="headerlink" title="六、nss: Name Service Switch"></a>六、nss: Name Service Switch</h1><p>Name Service Switch（NSS）是一个在Linux和其他类Unix操作系统中使用的系统组件，它提供了一种机制来管理系统中各种名称服务的配置。名称服务包括用户帐户、组、主机名、网络协议、服务和其他系统信息。NSS允许系统管理员配置系统以使用不同的名称服务，例如本地文件、NIS、LDAP等。NSS还提供了一种机制来缓存名称服务数据，以提高系统性能。在Linux系统中，NSS通常由glibc库实现。</p><h2 id="1-配置文件"><a href="#1-配置文件" class="headerlink" title="1. 配置文件"></a>1. 配置文件</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">=&gt; cat /etc/nsswitch.conf</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">Name Service Switch configuration file.</span></span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">See nsswitch.conf(5) <span class="keyword">for</span> details.</span></span><br><span class="line"></span><br><span class="line">passwd: files systemd</span><br><span class="line">group: files [SUCCESS=merge] systemd</span><br><span class="line">shadow: files systemd</span><br><span class="line">gshadow: files systemd</span><br><span class="line"></span><br><span class="line">publickey: files</span><br><span class="line"></span><br><span class="line">hosts: mymachines resolve [!UNAVAIL=return] files myhostname dns</span><br><span class="line">networks: files</span><br><span class="line"></span><br><span class="line">protocols: files</span><br><span class="line">services: files</span><br><span class="line">ethers: files</span><br><span class="line">rpc: files</span><br><span class="line"></span><br><span class="line">netgroup: files</span><br></pre></td></tr></table></figure><ul><li>上面配置的files等对应一个个插件，对应命名<code>libnss_xxx.so</code></li><li>修改了之后，从<code>glibc 2.33</code>后，会自动重新加载此文件，之前的版本只在进程起来的时候加载一次</li></ul><h2 id="2-插件位置"><a href="#2-插件位置" class="headerlink" title="2. 插件位置"></a>2. 插件位置</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">=&gt; ls /usr/lib/libnss_*</span><br><span class="line">/usr/lib/libnss_compat.so    /usr/lib/libnss_db.so.2     /usr/lib/libnss_hesiod.so           /usr/lib/libnss_libvirt.so.2     /usr/lib/libnss_resolve.so.2  /usr/lib/libnss_wins.so.2</span><br><span class="line">/usr/lib/libnss_compat.so.2  /usr/lib/libnss_dns.so.2    /usr/lib/libnss_hesiod.so.2         /usr/lib/libnss_myhostname.so.2  /usr/lib/libnss_systemd.so.2</span><br><span class="line">/usr/lib/libnss_db.so        /usr/lib/libnss_files.so.2  /usr/lib/libnss_libvirt_guest.so.2  /usr/lib/libnss_mymachines.so.2  /usr/lib/libnss_winbind.so.2</span><br></pre></td></tr></table></figure><h2 id="3-自定义插件"><a href="#3-自定义插件" class="headerlink" title="3. 自定义插件"></a>3. 自定义插件</h2><ul><li>可以自定义so库，满足此命名，然后放到系统库路径后，添加到配置文件中</li><li>需要满足nss对应的库的符号要求</li></ul><h3 id="3-1-自定义dns解析库"><a href="#3-1-自定义dns解析库" class="headerlink" title="3.1. 自定义dns解析库"></a>3.1. 自定义dns解析库</h3><ul><li>dns解析由hosts处理</li></ul><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stddef.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;nss.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;netdb.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;arpa/inet.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;syslog.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;zconf.h&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;stdio.h&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">nss_status</span> _nss_hs_gethostbyname4_r(</span><br><span class="line">        <span class="type">const</span> <span class="type">char</span> *name,</span><br><span class="line">        <span class="keyword">struct</span> gaih_addrtuple **pat,</span><br><span class="line">        <span class="type">char</span> *buffer, <span class="type">size_t</span> buflen,</span><br><span class="line">        <span class="type">int</span> *errnop, <span class="type">int</span> *h_errnop,</span><br><span class="line">        <span class="type">int32_t</span> *ttlp) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(stdout, <span class="string">&quot;_nss_hs_gethostbyname4_r ns hook domain:%s  pid:%d\n&quot;</span>, name, <span class="built_in">getpid</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> NSS_STATUS_NOTFOUND;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">nss_status</span> _nss_hs_gethostbyname3_r(</span><br><span class="line">        <span class="type">const</span> <span class="type">char</span> *name,</span><br><span class="line">        <span class="type">int</span> af,</span><br><span class="line">        <span class="keyword">struct</span> hostent *host,</span><br><span class="line">        <span class="type">char</span> *buffer, <span class="type">size_t</span> buflen,</span><br><span class="line">        <span class="type">int</span> *errnop, <span class="type">int</span> *h_errnop,</span><br><span class="line">        <span class="type">int32_t</span> *ttlp,</span><br><span class="line">        <span class="type">char</span> **canonp) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">fprintf</span>(stdout, <span class="string">&quot;_nss_hs_gethostbyname3_r ns hook domain:%s  pid:%d\n&quot;</span>, name, <span class="built_in">getpid</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> NSS_STATUS_NOTFOUND;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">nss_status</span> _nss_hs_gethostbyname2_r(</span><br><span class="line">        <span class="type">const</span> <span class="type">char</span> *name,</span><br><span class="line">        <span class="type">int</span> af,</span><br><span class="line">        <span class="keyword">struct</span> hostent *host,</span><br><span class="line">        <span class="type">char</span> *buffer, <span class="type">size_t</span> buflen,</span><br><span class="line">        <span class="type">int</span> *errnop, <span class="type">int</span> *h_errnop) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> _nss_hs_gethostbyname3_r(</span><br><span class="line">            name,</span><br><span class="line">            af,</span><br><span class="line">            host,</span><br><span class="line">            buffer, buflen,</span><br><span class="line">            errnop, h_errnop,</span><br><span class="line">            <span class="literal">NULL</span>,</span><br><span class="line">            <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">enum</span> <span class="title class_">nss_status</span> _nss_hs_gethostbyname_r(</span><br><span class="line">        <span class="type">const</span> <span class="type">char</span> *name,</span><br><span class="line">        <span class="keyword">struct</span> hostent *host,</span><br><span class="line">        <span class="type">char</span> *buffer, <span class="type">size_t</span> buflen,</span><br><span class="line">        <span class="type">int</span> *errnop, <span class="type">int</span> *h_errnop) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> _nss_hs_gethostbyname3_r(</span><br><span class="line">            name,</span><br><span class="line">            AF_UNSPEC,</span><br><span class="line">            host,</span><br><span class="line">            buffer, buflen,</span><br><span class="line">            errnop, h_errnop,</span><br><span class="line">            <span class="literal">NULL</span>,</span><br><span class="line">            <span class="literal">NULL</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="type">void</span> _nss_hs_init(<span class="built_in">void</span> (*cb)(<span class="type">size_t</span>, <span class="keyword">struct</span> traced_file*)) &#123;</span><br><span class="line">    <span class="built_in">fprintf</span>(stdout, <span class="string">&quot;_nss_hs_init...&quot;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ul><li>编译</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gcc -shared -fPIC -o libnss_test.so.2 -Wl,-soname,libnss_test.so.2 test_nss.c</span><br></pre></td></tr></table></figure><ul><li>放到<code>/usr/lib</code>下后，重启要使用<code>gethostbyname</code>的进程就好了</li></ul><h2 id="4-hosts-dns解析服务"><a href="#4-hosts-dns解析服务" class="headerlink" title="4. hosts dns解析服务"></a>4. hosts dns解析服务</h2><ul><li><code>mymachines</code>: 由systemd提供，应该是处理容器类型的dns解析</li><li><code>resolve</code>: 由systemd提供，是<code>systemd-resolved.service</code>的处理服务</li><li><code>files</code>: 由glibc提供，处理<code>/etc/hosts</code></li><li><code>myhostname</code>: 由systemd提供，处理<code>localhost</code>、<code>_gateway</code>、<code>_outbound</code>等域名使用，主要是查本地网卡的一些信息</li><li><code>dns</code>: 由glibc提供，处理dns的网络请求使用</li></ul><h1 id="七、二进制文件格式"><a href="#七、二进制文件格式" class="headerlink" title="七、二进制文件格式"></a>七、二进制文件格式</h1><p>参考 <a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/286088470">ELF文件格式</a></p><img src="2024-03-03-01.png"><h2 id="1-链接视图和执行视图"><a href="#1-链接视图和执行视图" class="headerlink" title="1. 链接视图和执行视图"></a>1. 链接视图和执行视图</h2><ul><li>链接视图是以节（section）为单位，用于在链接时使用，可以是静态库、编译过程文件、动态库等</li><li>执行视图是以段（segment）为单位，是在执行时用到的视图。</li><li>目标文件.o里的代码段.text 是section（汇编中.text同理），当多个可重定向文件最终要整合成一个可执行的文件的时候（链接过程），链接器把目标文件中相同的 section 整合成一个segment，在程序运行的时候，方便加载器的加载</li></ul><h2 id="2-elf文件"><a href="#2-elf文件" class="headerlink" title="2. elf文件"></a>2. elf文件</h2><h1 id="小技巧和踩坑记"><a href="#小技巧和踩坑记" class="headerlink" title="小技巧和踩坑记"></a>小技巧和踩坑记</h1><h2 id="1-报错-xxxx-pcieport-0000-00-1c-5-xxxx刷屏，无法关机"><a href="#1-报错-xxxx-pcieport-0000-00-1c-5-xxxx刷屏，无法关机" class="headerlink" title="1. 报错[xxxx] pcieport 0000:00:1c.5 xxxx刷屏，无法关机"></a>1. 报错<code>[xxxx] pcieport 0000:00:1c.5 xxxx</code>刷屏，无法关机</h2><ol><li>在<code>/etc/defaults/grub</code>里面修改，在<code>GRUB_CMDLINE_LINUX_DEFAULT=</code>后面追加<code>splash pci=nomsi</code></li></ol><h2 id="2-报错perl-warning-Falling-back-to-the-standard-locale-C"><a href="#2-报错perl-warning-Falling-back-to-the-standard-locale-C" class="headerlink" title="2. 报错perl: warning: Falling back to the standard locale (&quot;C&quot;)."></a>2. 报错<code>perl: warning: Falling back to the standard locale (&quot;C&quot;).</code></h2><ul><li>由于系统设置的语言包，系统不识别，需要安装</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">这个可以解决不识别 zh_CN.UTF-8</span></span><br><span class="line">sudo apt get install language-pack-zh-hans</span><br></pre></td></tr></table></figure><h2 id="3-分辨率怎么调都不行，总是达不到1080"><a href="#3-分辨率怎么调都不行，总是达不到1080" class="headerlink" title="3. 分辨率怎么调都不行，总是达不到1080"></a>3. 分辨率怎么调都不行，总是达不到1080</h2><ul><li>可以考虑下是线的问题，被一根VGA线坑了一年的人真诚提醒</li></ul><h2 id="4-中文乱码"><a href="#4-中文乱码" class="headerlink" title="4. 中文乱码"></a>4. 中文乱码</h2><ul><li>部分中文出现乱码很有可能时中文字体没有安装，一般安装<code>wqy-microhei</code>就可以解决</li></ul><h2 id="5-vmware在linux下偶现虚拟机卡死"><a href="#5-vmware在linux下偶现虚拟机卡死" class="headerlink" title="5. vmware在linux下偶现虚拟机卡死"></a>5. vmware在linux下偶现虚拟机卡死</h2><ul><li>可能是内核选项<code>vm.compaction_proactiveness</code>的问题，此参数决定了内核在后台应该压缩内存的力度</li><li>参考 <a target="_blank" rel="noopener" href="https://communities.vmware.com/t5/VMware-Workstation-Pro/kcompacd0-using-100-CPU-with-VMware-Workstation-16/td-p/2896972">kcompacd0-using-100-CPU-with-VMware-Workstation-16</a> 可以设置<code>sudo sysctl -w vm.compaction_proactiveness=1</code>解决</li></ul><h2 id="6-调整分区大小导致无法mount分区"><a href="#6-调整分区大小导致无法mount分区" class="headerlink" title="6. 调整分区大小导致无法mount分区"></a>6. 调整分区大小导致无法mount分区</h2><ul><li>使用分区管理器调整大小的时候，如果连续调整同时生效，很有可能出现调整失败，原分区也无法mount的情况</li><li>报错提示超级块里面的大小和分区表的大小不一致</li></ul><h3 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h3><ul><li>使用parted命令处理分区，使用resizepart将分区大小调整到原来的大小，和报错里面的一致就基本可以了</li></ul><h2 id="7-查看机器内存情况"><a href="#7-查看机器内存情况" class="headerlink" title="7. 查看机器内存情况"></a>7. 查看机器内存情况</h2><ul><li>下面命令查看几个插槽插了几个内存条</li><li>可以看到四个插槽，插了两个DDR4的16G内存，速度<code>3200 MT/s</code></li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line">=&gt; sudo dmidecode | grep -A16 &quot;Memory Device$&quot;</span><br><span class="line">Memory Device</span><br><span class="line">        Array Handle: 0x003B</span><br><span class="line">        Error Information Handle: Not Provided</span><br><span class="line">        Total Width: Unknown</span><br><span class="line">        Data Width: Unknown</span><br><span class="line">        Size: No Module Installed</span><br><span class="line">        Form Factor: Unknown</span><br><span class="line">        Set: None</span><br><span class="line">        Locator: Controller0-ChannelB-DIMM0</span><br><span class="line">        Bank Locator: BANK 1</span><br><span class="line">        Type: Unknown</span><br><span class="line">        Type Detail: None</span><br><span class="line">--</span><br><span class="line">Memory Device</span><br><span class="line">        Array Handle: 0x003B</span><br><span class="line">        Error Information Handle: Not Provided</span><br><span class="line">        Total Width: 64 bits</span><br><span class="line">        Data Width: 64 bits</span><br><span class="line">        Size: 16 GB</span><br><span class="line">        Form Factor: DIMM</span><br><span class="line">        Set: None</span><br><span class="line">        Locator: Controller0-ChannelA-DIMM1</span><br><span class="line">        Bank Locator: BANK 0</span><br><span class="line">        Type: DDR4</span><br><span class="line">        Type Detail: Synchronous</span><br><span class="line">        Speed: 3200 MT/s</span><br><span class="line">--</span><br><span class="line">Memory Device</span><br><span class="line">        Array Handle: 0x003B</span><br><span class="line">        Error Information Handle: Not Provided</span><br><span class="line">        Total Width: Unknown</span><br><span class="line">        Data Width: Unknown</span><br><span class="line">        Size: No Module Installed</span><br><span class="line">        Form Factor: Unknown</span><br><span class="line">        Set: None</span><br><span class="line">        Locator: Controller0-ChannelB-DIMM0</span><br><span class="line">        Bank Locator: BANK 1</span><br><span class="line">        Type: Unknown</span><br><span class="line">        Type Detail: None</span><br><span class="line">--</span><br><span class="line">Memory Device</span><br><span class="line">        Array Handle: 0x003B</span><br><span class="line">        Error Information Handle: Not Provided</span><br><span class="line">        Total Width: 64 bits</span><br><span class="line">        Data Width: 64 bits</span><br><span class="line">        Size: 16 GB</span><br><span class="line">        Form Factor: DIMM</span><br><span class="line">        Set: None</span><br><span class="line">        Locator: Controller0-ChannelB-DIMM1</span><br><span class="line">        Bank Locator: BANK 1</span><br><span class="line">        Type: DDR4</span><br><span class="line">        Type Detail: Synchronous</span><br><span class="line">        Speed: 3200 MT/s</span><br></pre></td></tr></table></figure></div><div class="reward-container"><div></div><button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'>打赏</button><div id="qr" style="display:none"><div style="display:inline-block"><img src="/images/wechatpay.png" alt="王钰博 微信支付"><p>微信支付</p></div><div style="display:inline-block"><img src="/images/alipay.jpg" alt="王钰博 支付宝"><p>支付宝</p></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/Linux/" rel="tag"># Linux</a></div><div class="post-nav"><div class="post-nav-item"><a href="/blogs/2021-02-26-linuxDeploy/" rel="prev" title="linux deploy搭建笔记"><i class="fa fa-chevron-left"></i> linux deploy搭建笔记</a></div><div class="post-nav-item"><a href="/blogs/2021-03-05-shadowsocks/" rel="next" title="linux下shadowsocks代理配置（服务端+客户端）">linux下shadowsocks代理配置（服务端+客户端） <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>window.addEventListener("tabs:register",()=>{let{activeClass:t}=CONFIG.comments;if(CONFIG.comments.storage&&(t=localStorage.getItem("comments_active")||t),t){let e=document.querySelector(`a[href="#comment-${t}"]`);e&&e.click()}}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{if(!t.target.matches(".tabs-comment .tab-content .tab-pane"))return;let e=t.target.classList[1];localStorage.setItem("comments_active",e)})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E7%B3%BB%E7%BB%9F%E7%9F%A5%E8%AF%86"><span class="nav-text">一、系统知识</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-profile%E3%80%81bashrc%E3%80%81bash-profile%E4%B9%8B%E9%97%B4%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="nav-text">1. profile、bashrc、bash_profile之间的关系</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-service%E7%9A%84%E5%87%A0%E4%B8%AA%E7%9F%A5%E8%AF%86"><span class="nav-text">2. service的几个知识</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-service-linux%E6%9C%8D%E5%8A%A1%E7%AE%A1%E7%90%86"><span class="nav-text">2.1. service linux服务管理</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E6%9F%A5%E7%9C%8B%E6%9C%8D%E5%8A%A1%E5%90%AF%E5%8A%A8%E6%97%A5%E5%BF%97"><span class="nav-text">2.2. 查看服务启动日志</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%BC%80%E6%9C%BA%E5%90%AF%E5%8A%A8%E8%84%9A%E6%9C%AC"><span class="nav-text">3. 开机启动脚本</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E8%AE%BE%E5%A4%87event%E4%BA%8B%E4%BB%B6%E6%9F%A5%E7%9C%8B"><span class="nav-text">4. 设备event事件查看</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E7%94%A8%E6%88%B7%E7%BB%84"><span class="nav-text">5. 用户组</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#5-1-%E5%87%A0%E4%B8%AA%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95"><span class="nav-text">5.1. 几个基本用法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E6%9F%A5%E7%9C%8B%E7%B3%BB%E7%BB%9F%E5%90%AF%E5%8A%A8%E6%97%B6%E9%97%B4"><span class="nav-text">6. 查看系统启动时间</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-%E5%AE%9A%E6%97%B6%E4%BB%BB%E5%8A%A1"><span class="nav-text">7. 定时任务</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#7-1-cron%E6%A0%BC%E5%BC%8F%E8%AF%B4%E6%98%8E"><span class="nav-text">7.1. cron格式说明</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-%E8%BF%9B%E7%A8%8B%E7%9A%84%E5%87%A0%E7%A7%8D%E7%8A%B6%E6%80%81"><span class="nav-text">8. 进程的几种状态</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-dev-%E4%BB%8B%E7%BB%8D"><span class="nav-text">9. &#x2F;dev 介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#9-1-dev-random%E5%92%8C-dev-urandom"><span class="nav-text">9.1. &#x2F;dev&#x2F;random和&#x2F;dev&#x2F;urandom</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-proc%E4%BB%8B%E7%BB%8D"><span class="nav-text">10. &#x2F;proc介绍</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#10-2-proc-pid-%E8%BF%9B%E7%A8%8B%E4%BF%A1%E6%81%AF"><span class="nav-text">10.2. &#x2F;proc&#x2F;[pid] 进程信息</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-fd-%E4%BF%9D%E5%AD%98%E5%BD%93%E5%89%8D%E8%BF%9B%E7%A8%8B%E6%89%93%E5%BC%80%E7%9A%84%E5%8F%A5%E6%9F%84"><span class="nav-text">1) fd 保存当前进程打开的句柄</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-maps-%E8%BF%9B%E7%A8%8B%E5%86%85%E5%AD%98%E7%A9%BA%E9%97%B4%E4%BF%A1%E6%81%AF"><span class="nav-text">2) maps 进程内存空间信息</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-limits-%E6%98%BE%E7%A4%BA%E8%BF%9B%E7%A8%8B%E7%9A%84%E4%B8%80%E4%BA%9B%E9%99%90%E5%88%B6"><span class="nav-text">3) limits 显示进程的一些限制</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#4-cwd-%E5%BD%93%E5%89%8D%E5%B7%A5%E4%BD%9C%E7%9B%AE%E5%BD%95"><span class="nav-text">4) cwd 当前工作目录</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#10-3-proc-sys-%E4%BF%9D%E5%AD%98%E5%86%85%E6%A0%B8%E7%9A%84%E5%8F%82%E6%95%B0"><span class="nav-text">10.3. &#x2F;proc&#x2F;sys 保存内核的参数</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E5%88%97%E4%B8%BE%E5%87%A0%E4%B8%AA%E5%86%85%E6%A0%B8%E5%8F%82%E6%95%B0%E5%90%AB%E4%B9%89"><span class="nav-text">1) 列举几个内核参数含义</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-proc-sys-net-ipv4-conf-interface-rp-filter"><span class="nav-text">2) &#x2F;proc&#x2F;sys&#x2F;net&#x2F;ipv4&#x2F;conf&#x2F;interface&#x2F;rp_filter</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#11-%E7%AE%A1%E9%81%93"><span class="nav-text">11. 管道</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#11-1-%E7%A4%BA%E4%BE%8B"><span class="nav-text">11.1. 示例</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#12-%E6%96%87%E4%BB%B6%E7%B1%BB%E5%9E%8B"><span class="nav-text">12. 文件类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#13-%E8%BF%9B%E7%A8%8B"><span class="nav-text">13. 进程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#13-1-%E6%9C%80%E5%A4%9A%E8%83%BD%E5%88%9B%E5%BB%BA%E5%A4%9A%E5%B0%91%E7%BA%BF%E7%A8%8B"><span class="nav-text">13.1. 最多能创建多少线程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#13-2-%E6%9C%80%E5%A4%A7%E8%83%BD%E6%89%93%E5%BC%80%E7%9A%84%E6%96%87%E4%BB%B6%E5%8F%A5%E6%9F%84%E6%95%B0"><span class="nav-text">13.2. 最大能打开的文件句柄数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#14-%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%E7%9A%84%E7%BB%93%E6%9E%84"><span class="nav-text">14. 可执行文件的结构</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#14-1-%E6%9F%A5%E7%9C%8B%E5%8F%AF%E6%89%A7%E8%A1%8C%E6%96%87%E4%BB%B6%E7%9A%84%E5%A4%A7%E5%B0%8F"><span class="nav-text">14.1. 查看可执行文件的大小</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#14-2-%E8%A7%A3%E6%9E%90"><span class="nav-text">14.2. 解析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-bss-%E6%9C%AA%E5%88%9D%E5%A7%8B%E5%8C%96%E6%95%B0%E6%8D%AE%E5%8C%BA"><span class="nav-text">1) bss 未初始化数据区</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-data-%E9%9D%99%E6%80%81%E6%95%B0%E6%8D%AE%E5%92%8C%E5%85%A8%E5%B1%80%E5%88%9D%E5%A7%8B%E5%8C%96%E7%9A%84%E6%95%B0%E6%8D%AE%E5%8C%BA"><span class="nav-text">2) data 静态数据和全局初始化的数据区</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#3-text-%E4%BB%A3%E7%A0%81%E6%AE%B5%EF%BC%8C%E5%AD%98%E6%94%BE%E4%BB%A3%E7%A0%81%E6%8C%87%E4%BB%A4"><span class="nav-text">3) text 代码段，存放代码指令</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E6%9C%89%E7%94%A8%E7%9A%84%E5%87%A0%E4%B8%AA%E6%8A%80%E5%B7%A7"><span class="nav-text">二、有用的几个技巧</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-linux%E5%90%AF%E5%8A%A8%E5%88%B0%E6%96%87%E6%9C%AC%E7%95%8C%E9%9D%A2%E5%92%8C%E5%88%B0%E5%9B%BE%E5%BD%A2%E7%95%8C%E9%9D%A2"><span class="nav-text">1. linux启动到文本界面和到图形界面</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E4%BF%AE%E6%94%B9%E7%A1%AC%E7%9B%98%E7%9A%84uuid"><span class="nav-text">2. 修改硬盘的uuid</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-hostname%E7%AB%8B%E5%8D%B3%E7%94%9F%E6%95%88"><span class="nav-text">3. hostname立即生效</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-bpf-%E4%B8%BB%E8%A6%81%E7%94%A8%E4%BA%8E%E7%BD%91%E7%BB%9C%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90"><span class="nav-text">4. bpf 主要用于网络数据分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E8%AE%BE%E7%BD%AE%E6%97%A0%E6%93%8D%E4%BD%9C%E7%94%A8%E6%88%B7%E8%87%AA%E5%8A%A8%E9%80%80%E5%87%BA"><span class="nav-text">5. 设置无操作用户自动退出</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4%E5%92%8C%E7%A1%AC%E4%BB%B6%E6%97%B6%E9%97%B4%E5%90%8C%E6%AD%A5"><span class="nav-text">6. 系统时间和硬件时间同步</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-%E8%AE%BE%E7%BD%AE%E6%97%B6%E5%8C%BA"><span class="nav-text">7. 设置时区</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-%E6%B7%BB%E5%8A%A0%E4%B8%80%E4%B8%AA%E7%94%A8%E6%88%B7"><span class="nav-text">8. 添加一个用户</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#8-1-%E7%BB%99%E7%94%A8%E6%88%B7%E6%89%A7%E8%A1%8Csudo%E7%9A%84%E6%9D%83%E5%8A%9B"><span class="nav-text">8.1. 给用户执行sudo的权力</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-journalctl-%E6%A3%80%E6%9F%A5%E6%9C%8D%E5%8A%A1%E6%97%A5%E5%BF%97"><span class="nav-text">9. journalctl 检查服务日志</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#9-1-%E9%80%89%E9%A1%B9"><span class="nav-text">9.1. 选项</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-%E5%91%BD%E4%BB%A4%E8%A1%8C%E9%85%8D%E7%BD%AEsocks5%E4%BB%A3%E7%90%86"><span class="nav-text">10. 命令行配置socks5代理</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81c-c-%E7%BC%96%E7%A8%8B"><span class="nav-text">三、c&#x2F;c++编程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E4%BF%A1%E6%81%AF"><span class="nav-text">1. 获取系统信息</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E8%8E%B7%E5%8F%96%E8%BF%9B%E7%A8%8Bid"><span class="nav-text">2. 获取进程id</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E8%8E%B7%E5%8F%96%E7%B3%BB%E7%BB%9F%E6%97%B6%E9%97%B4"><span class="nav-text">3. 获取系统时间</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-errno"><span class="nav-text">4. errno</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98"><span class="nav-text">四、虚拟内存</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86"><span class="nav-text">1. 基础知识</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E8%BF%9B%E7%A8%8B"><span class="nav-text">五、进程</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E8%BF%9B%E7%A8%8B%E9%97%B4%E9%80%9A%E4%BF%A1"><span class="nav-text">1. 进程间通信</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E7%AE%A1%E9%81%93"><span class="nav-text">1.1. 管道</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E7%89%B9%E7%82%B9"><span class="nav-text">1) 特点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%88%9B%E5%BB%BA"><span class="nav-text">2) 创建</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E5%91%BD%E5%90%8D%E7%AE%A1%E9%81%93"><span class="nav-text">1.2. 命名管道</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E7%89%B9%E7%82%B9-1"><span class="nav-text">1) 特点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E5%88%9B%E5%BB%BA-1"><span class="nav-text">2) 创建</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-%E4%BF%A1%E5%8F%B7"><span class="nav-text">1.3. 信号</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E7%89%B9%E7%82%B9-2"><span class="nav-text">1) 特点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E4%BD%BF%E7%94%A8"><span class="nav-text">2) 使用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-4-%E4%BF%A1%E5%8F%B7%E9%87%8F"><span class="nav-text">1.4. 信号量</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E7%89%B9%E7%82%B9-3"><span class="nav-text">1) 特点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E4%BD%BF%E7%94%A8-1"><span class="nav-text">2) 使用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-5-%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97"><span class="nav-text">1.5. 消息队列</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E7%89%B9%E7%82%B9-4"><span class="nav-text">1) 特点</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E4%BD%BF%E7%94%A8-2"><span class="nav-text">2) 使用</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-6-%E5%85%B1%E4%BA%AB%E5%86%85%E5%AD%98"><span class="nav-text">1.6. 共享内存</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-7-%E5%A5%97%E6%8E%A5%E5%AD%97"><span class="nav-text">1.7. 套接字</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%AD%E3%80%81nss-Name-Service-Switch"><span class="nav-text">六、nss: Name Service Switch</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">1. 配置文件</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E6%8F%92%E4%BB%B6%E4%BD%8D%E7%BD%AE"><span class="nav-text">2. 插件位置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8F%92%E4%BB%B6"><span class="nav-text">3. 自定义插件</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-%E8%87%AA%E5%AE%9A%E4%B9%89dns%E8%A7%A3%E6%9E%90%E5%BA%93"><span class="nav-text">3.1. 自定义dns解析库</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-hosts-dns%E8%A7%A3%E6%9E%90%E6%9C%8D%E5%8A%A1"><span class="nav-text">4. hosts dns解析服务</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%83%E3%80%81%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%96%87%E4%BB%B6%E6%A0%BC%E5%BC%8F"><span class="nav-text">七、二进制文件格式</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E9%93%BE%E6%8E%A5%E8%A7%86%E5%9B%BE%E5%92%8C%E6%89%A7%E8%A1%8C%E8%A7%86%E5%9B%BE"><span class="nav-text">1. 链接视图和执行视图</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-elf%E6%96%87%E4%BB%B6"><span class="nav-text">2. elf文件</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B0%8F%E6%8A%80%E5%B7%A7%E5%92%8C%E8%B8%A9%E5%9D%91%E8%AE%B0"><span class="nav-text">小技巧和踩坑记</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E6%8A%A5%E9%94%99-xxxx-pcieport-0000-00-1c-5-xxxx%E5%88%B7%E5%B1%8F%EF%BC%8C%E6%97%A0%E6%B3%95%E5%85%B3%E6%9C%BA"><span class="nav-text">1. 报错[xxxx] pcieport 0000:00:1c.5 xxxx刷屏，无法关机</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E6%8A%A5%E9%94%99perl-warning-Falling-back-to-the-standard-locale-C"><span class="nav-text">2. 报错perl: warning: Falling back to the standard locale (&quot;C&quot;).</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%88%86%E8%BE%A8%E7%8E%87%E6%80%8E%E4%B9%88%E8%B0%83%E9%83%BD%E4%B8%8D%E8%A1%8C%EF%BC%8C%E6%80%BB%E6%98%AF%E8%BE%BE%E4%B8%8D%E5%88%B01080"><span class="nav-text">3. 分辨率怎么调都不行，总是达不到1080</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E4%B8%AD%E6%96%87%E4%B9%B1%E7%A0%81"><span class="nav-text">4. 中文乱码</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-vmware%E5%9C%A8linux%E4%B8%8B%E5%81%B6%E7%8E%B0%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%8D%A1%E6%AD%BB"><span class="nav-text">5. vmware在linux下偶现虚拟机卡死</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E8%B0%83%E6%95%B4%E5%88%86%E5%8C%BA%E5%A4%A7%E5%B0%8F%E5%AF%BC%E8%87%B4%E6%97%A0%E6%B3%95mount%E5%88%86%E5%8C%BA"><span class="nav-text">6. 调整分区大小导致无法mount分区</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A7%A3%E5%86%B3"><span class="nav-text">解决</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-%E6%9F%A5%E7%9C%8B%E6%9C%BA%E5%99%A8%E5%86%85%E5%AD%98%E6%83%85%E5%86%B5"><span class="nav-text">7. 查看机器内存情况</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="王钰博" src="/images/12.jpg"><p class="site-author-name" itemprop="name">王钰博</p><div class="site-description" itemprop="description">个人博客</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">122</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">21</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">14</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/Githubwyb" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Githubwyb" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:1061322005@qq.com" title="E-Mail → mailto:1061322005@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://githubwyb.github.io/bookPages/" title="https:&#x2F;&#x2F;githubwyb.github.io&#x2F;bookPages&#x2F;">markdown books</a></li></ul></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">豫ICP备16023189号 </a><img src="/images/beian.png" style="display:inline-block"></div><div class="copyright">&copy; <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">王钰博</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span title="站点总字数">1.2m</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">17:54</span></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动</div><div class="addthis_inline_share_toolbox"><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e1986d4e4e2d132" async></script></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/medium-zoom.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script src="/js/local-search.js"></script><script>document.querySelectorAll(".pdfobject-container").forEach(e=>{let t=e.dataset.target,a="#"+Object.entries({navpanes:0,toolbar:0,statusbar:0,pagemode:"thumbs",view:"FitH"}).map(([e,t])=>`${e}=${encodeURIComponent(t)}`).join("&"),i=`/lib/pdf/web/viewer.html?file=${encodeURIComponent(t)}${a}`;NexT.utils.supportsPDFs()?e.innerHTML=`<embed class="pdfobject" src="${t+a}" type="application/pdf" style="height: ${e.dataset.height};">`:e.innerHTML=`<iframe src="${i}" style="height: ${e.dataset.height};" frameborder="0"></iframe>`})</script><script>"undefined"==typeof MathJax?(window.MathJax={loader:{source:{"[tex]/amsCd":"[tex]/amscd","[tex]/AMScd":"[tex]/amscd"}},tex:{inlineMath:{"[+]":[["$","$"]]},tags:"ams"},options:{renderActions:{findScript:[10,e=>{document.querySelectorAll('script[type^="math/tex"]').forEach(t=>{const a=!!t.type.match(/; *mode=display/),n=new e.options.MathItem(t.textContent,e.inputJax[0],a),d=document.createTextNode("");t.parentNode.replaceChild(d,t),n.start={node:d,delim:"",n:0},n.end={node:d,delim:"",n:0},e.math.push(n)})},"",!1],insertedScript:[200,()=>{document.querySelectorAll("mjx-container").forEach(e=>{let t=e.parentNode;"li"===t.nodeName.toLowerCase()&&t.parentNode.classList.add("has-jax")})},"",!1]}}},function(){var e=document.createElement("script");e.src="/lib/mathjax/tex-mml-chtml.js",e.defer=!0,document.head.appendChild(e)}()):(MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset())</script><script>NexT.utils.loadComments(document.querySelector("#valine-comments"),()=>{NexT.utils.getScript("//unpkg.com/valine/dist/Valine.min.js",()=>{var e=["nick","mail","link"],a="nick,mail";a=a.split(",").filter(a=>e.includes(a)),new Valine({el:"#valine-comments",verify:!1,notify:!1,appId:"qmLbUHV1HOr841BOYkl84riu-gzGzoHsz",appKey:"j4fgTcf1yHRDD5X3HUH5EH95",placeholder:"^_^ happy everyday!",avatar:"wavatar",meta:a,pageSize:"10",visitor:!1,lang:"zh-cn",path:location.pathname,recordIP:!1,serverURLs:""})},window.Valine)})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":true,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"bottom":-30,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body><script type="text/javascript" src="/lib/jquery-3.4.1.min.js"></script><script type="text/javascript" src="/js/src/love.js"></script></html>