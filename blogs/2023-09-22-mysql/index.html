<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 7.0.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-diy.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-diy.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-diy.png"><link rel="mask-icon" href="/images/logo-diy.svg" color="#222"><meta name="baidu-site-verification" content="y1cfESbTt9nd3LsA"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="/lib/font-awesome/css/font-awesome.min.css"><link rel="stylesheet" href="/lib/pace/pace-theme-flash.min.css"><script src="/lib/pace/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"githubwyb.github.io",root:"/",scheme:"Pisces",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1},copycode:{enable:!0,show_result:!0,style:null},back2top:{enable:!0,sidebar:!1,scrollpercent:!0},bookmark:{enable:!0,color:"#ff0000",save:"auto"},fancybox:!1,mediumzoom:!0,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="一、安装下载地址: https:&#x2F;&#x2F;dev.mysql.com&#x2F;downloads&#x2F; 1. windows 下载msi安装包 按照提示安装  1.1. mysqld的一些操作12345678:: 初始化配置，会创建data目录mysqld --initialize-insecure:::::::::: 服务相关 :::::::::::: 安装服务mysqld --install:: 卸载服务mys"><meta property="og:type" content="article"><meta property="og:title" content="mysql相关"><meta property="og:url" content="https://githubwyb.github.io/blogs/2023-09-22-mysql/index.html"><meta property="og:site_name" content="技术的路上奔跑"><meta property="og:description" content="一、安装下载地址: https:&#x2F;&#x2F;dev.mysql.com&#x2F;downloads&#x2F; 1. windows 下载msi安装包 按照提示安装  1.1. mysqld的一些操作12345678:: 初始化配置，会创建data目录mysqld --initialize-insecure:::::::::: 服务相关 :::::::::::: 安装服务mysqld --install:: 卸载服务mys"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2023-09-22T03:28:23.000Z"><meta property="article:modified_time" content="2023-11-14T03:56:50.000Z"><meta property="article:author" content="王钰博"><meta property="article:tag" content="wyb"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://githubwyb.github.io/blogs/2023-09-22-mysql/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>mysql相关 | 技术的路上奔跑</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">技术的路上奔跑</h1><span class="logo-line-after"><i></i></span></a><p class="site-subtitle" itemprop="description">入门</p></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-fw fa-home"></i>首页</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-fw fa-user"></i>关于</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-fw fa-tags"></i>标签</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-fw fa-th"></i>分类</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-fw fa-archive"></i>归档</a></li><li class="menu-item menu-item-sitemap"><a href="/sitemap.xml" rel="section"><i class="fa fa-fw fa-sitemap"></i>站点地图</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><div class="back-to-top"><i class="fa fa-arrow-up"></i> <span>0%</span></div><div class="reading-progress-bar"></div><a role="button" class="book-mark-link book-mark-link-fixed"></a> <a href="https://github.com/Githubwyb" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://githubwyb.github.io/blogs/2023-09-22-mysql/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/12.jpg"><meta itemprop="name" content="王钰博"><meta itemprop="description" content="个人博客"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="技术的路上奔跑"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">mysql相关</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-o"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2023-09-22 11:28:23" itemprop="dateCreated datePublished" datetime="2023-09-22T11:28:23+08:00">2023-09-22</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-calendar-check-o"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2023-11-14 11:56:50" itemprop="dateModified" datetime="2023-11-14T11:56:50+08:00">2023-11-14</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-folder-o"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Program/" itemprop="url" rel="index"><span itemprop="name">Program</span></a> </span>， <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/Program/Web/" itemprop="url" rel="index"><span itemprop="name">Web</span></a> </span></span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span id="busuanzi_value_page_pv"></span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="fa fa-comment-o"></i> </span><span class="post-meta-item-text">Valine：</span> <a title="valine" href="/blogs/2023-09-22-mysql/#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/blogs/2023-09-22-mysql/" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="fa fa-file-word-o"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>16k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="fa fa-clock-o"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>15 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><h1 id="一、安装"><a href="#一、安装" class="headerlink" title="一、安装"></a>一、安装</h1><p>下载地址: <a target="_blank" rel="noopener" href="https://dev.mysql.com/downloads/">https://dev.mysql.com/downloads/</a></p><h2 id="1-windows"><a href="#1-windows" class="headerlink" title="1. windows"></a>1. windows</h2><ul><li>下载msi安装包</li><li>按照提示安装</li></ul><h3 id="1-1-mysqld的一些操作"><a href="#1-1-mysqld的一些操作" class="headerlink" title="1.1. mysqld的一些操作"></a>1.1. mysqld的一些操作</h3><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">:: 初始化配置，会创建data目录</span><br><span class="line">mysqld --initialize-insecure</span><br><span class="line"></span><br><span class="line">:::::::::: 服务相关 ::::::::::</span><br><span class="line">:: 安装服务</span><br><span class="line">mysqld --install</span><br><span class="line">:: 卸载服务</span><br><span class="line">mysqld --remove mysql</span><br></pre></td></tr></table></figure><h3 id="踩坑记"><a href="#踩坑记" class="headerlink" title="踩坑记"></a>踩坑记</h3><h4 id="1-MYSQL报错-Failed-to-find-valid-data-directory"><a href="#1-MYSQL报错-Failed-to-find-valid-data-directory" class="headerlink" title="1) MYSQL报错 Failed to find valid data directory."></a>1) MYSQL报错 Failed to find valid data directory.</h4><ul><li>先删除自己建立的data目录</li><li>管理员使用cmd</li></ul><figure class="highlight bat"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">:: 看服务中mysql注册的是什么服务，可能叫mysql80</span><br><span class="line"><span class="built_in">net</span> stop mysql</span><br><span class="line">mysqld --remove mysql</span><br><span class="line"></span><br><span class="line">:: 重新初始化配置</span><br><span class="line">mysqld --initialize-insecure</span><br><span class="line">:: 安装服务</span><br><span class="line">mysqld --install</span><br><span class="line"></span><br><span class="line">:: 启动服务</span><br><span class="line"><span class="built_in">net</span> <span class="built_in">start</span> mysqld</span><br></pre></td></tr></table></figure><h1 id="二、配置"><a href="#二、配置" class="headerlink" title="二、配置"></a>二、配置</h1><ul><li>推荐的一套配置</li></ul><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="comment">## my.cnf for 8.0版本</span></span><br><span class="line"><span class="comment">## author: yejr(yejinrong@zhishutang.com, http://imysql.com, QQ: 4700963)</span></span><br><span class="line"><span class="comment">##</span></span><br><span class="line"><span class="comment">## 叶金荣(yejr)</span></span><br><span class="line"><span class="comment">## 国内知名MySQL专家，MySQL布道师，Oracle MySQL ACE Director，腾讯云TVP成员。</span></span><br><span class="line"><span class="comment">## 微信公众：老叶茶馆(imysql_wx), 博客：https://imysql.com</span></span><br><span class="line"><span class="comment">## QQ群: 125572178</span></span><br><span class="line"><span class="comment">## 注意：个别建议可能需要根据实际情况作调整，请自行判断或联系我，本人不对这些建议结果负相应责任</span></span><br><span class="line"><span class="comment">## 本配置文件主要适用于MySQL 8.0版本</span></span><br><span class="line"><span class="comment">#</span></span><br><span class="line"><span class="section">[client]</span></span><br><span class="line"><span class="attr">port</span>	= <span class="number">3306</span></span><br><span class="line"><span class="attr">socket</span>	= /data/mysql/mysql.sock</span><br><span class="line"></span><br><span class="line"><span class="section">[mysql]</span></span><br><span class="line"><span class="attr">prompt</span> = <span class="string">&quot;\u@mysqldb \R:\m:\s [\d]&gt; &quot;</span></span><br><span class="line">no_auto_rehash</span><br><span class="line"></span><br><span class="line"><span class="section">[mysqld]</span></span><br><span class="line"><span class="attr">user</span>	= mysql</span><br><span class="line"><span class="attr">port</span>	= <span class="number">3306</span></span><br><span class="line"><span class="comment">#主从复制或MGR集群中，server_id记得要不同</span></span><br><span class="line"><span class="comment">#另外，实例启动时会生成 auto.cnf，里面的 server_uuid 值也要不同</span></span><br><span class="line"><span class="comment">#server_uuid的值还可以自己手动指定，只要符合uuid的格式标准就可以</span></span><br><span class="line"><span class="attr">server_id</span> = <span class="number">3306</span></span><br><span class="line"><span class="attr">basedir</span>	= /usr/local/mysql</span><br><span class="line"><span class="attr">datadir</span>	= /data/mysql</span><br><span class="line"><span class="attr">socket</span>	= /data/mysql/mysql.sock</span><br><span class="line"><span class="attr">pid_file</span> = mysqldb.pid</span><br><span class="line"><span class="attr">character_set_server</span> = UTF8MB4</span><br><span class="line"><span class="attr">skip_name_resolve</span> = <span class="number">1</span></span><br><span class="line"><span class="comment">#若你的MySQL数据库主要运行在境外，请务必根据实际情况调整本参数</span></span><br><span class="line"><span class="attr">default_time_zone</span> = <span class="string">&quot;+8:00&quot;</span></span><br><span class="line"><span class="comment">#启用admin_port，连接数爆满等紧急情况下给管理员留个后门</span></span><br><span class="line"><span class="attr">admin_address</span> = <span class="string">&#x27;127.0.0.1&#x27;</span></span><br><span class="line"><span class="attr">admin_port</span> = <span class="number">33062</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#performance setttings</span></span><br><span class="line"><span class="attr">lock_wait_timeout</span> = <span class="number">3600</span></span><br><span class="line"><span class="attr">open_files_limit</span>    = <span class="number">65535</span></span><br><span class="line"><span class="attr">back_log</span> = <span class="number">1024</span></span><br><span class="line"><span class="attr">max_connections</span> = <span class="number">512</span></span><br><span class="line"><span class="attr">max_connect_errors</span> = <span class="number">1000000</span></span><br><span class="line"><span class="attr">table_open_cache</span> = <span class="number">1024</span></span><br><span class="line"><span class="attr">table_definition_cache</span> = <span class="number">1024</span></span><br><span class="line"><span class="attr">thread_stack</span> = <span class="number">512</span>K</span><br><span class="line"><span class="attr">sort_buffer_size</span> = <span class="number">4</span>M</span><br><span class="line"><span class="attr">join_buffer_size</span> = <span class="number">4</span>M</span><br><span class="line"><span class="attr">read_buffer_size</span> = <span class="number">8</span>M</span><br><span class="line"><span class="attr">read_rnd_buffer_size</span> = <span class="number">4</span>M</span><br><span class="line"><span class="attr">bulk_insert_buffer_size</span> = <span class="number">64</span>M</span><br><span class="line"><span class="attr">thread_cache_size</span> = <span class="number">768</span></span><br><span class="line"><span class="attr">interactive_timeout</span> = <span class="number">600</span></span><br><span class="line"><span class="attr">wait_timeout</span> = <span class="number">600</span></span><br><span class="line"><span class="attr">tmp_table_size</span> = <span class="number">32</span>M</span><br><span class="line"><span class="attr">max_heap_table_size</span> = <span class="number">32</span>M</span><br><span class="line"></span><br><span class="line"><span class="comment">#log settings</span></span><br><span class="line"><span class="attr">log_timestamps</span> = SYSTEM</span><br><span class="line"><span class="attr">log_error</span> = /data/mysql/error.log</span><br><span class="line"><span class="attr">log_error_verbosity</span> = <span class="number">3</span></span><br><span class="line"><span class="attr">slow_query_log</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">log_slow_extra</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">slow_query_log_file</span> = /data/mysql/slow.log</span><br><span class="line"><span class="attr">long_query_time</span> = <span class="number">0.1</span></span><br><span class="line"><span class="attr">log_queries_not_using_indexes</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">log_throttle_queries_not_using_indexes</span> = <span class="number">60</span></span><br><span class="line"><span class="attr">min_examined_row_limit</span> = <span class="number">100</span></span><br><span class="line"><span class="attr">log_slow_admin_statements</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">log_slow_slave_statements</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">log_bin</span> = /data/mysql/mybinlog</span><br><span class="line"><span class="attr">binlog_format</span> = ROW</span><br><span class="line"><span class="attr">sync_binlog</span> = <span class="number">1</span> <span class="comment">#MGR环境中由其他节点提供容错性，可不设置双1以提高本地节点性能</span></span><br><span class="line"><span class="attr">binlog_cache_size</span> = <span class="number">4</span>M</span><br><span class="line"><span class="attr">max_binlog_cache_size</span> = <span class="number">2</span>G</span><br><span class="line"><span class="attr">max_binlog_size</span> = <span class="number">1</span>G</span><br><span class="line"><span class="attr">binlog_rows_query_log_events</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">binlog_expire_logs_seconds</span> = <span class="number">604800</span></span><br><span class="line"><span class="comment">#MySQL 8.0.22前，想启用MGR的话，需要设置binlog_checksum=NONE才行</span></span><br><span class="line"><span class="attr">binlog_checksum</span> = CRC32</span><br><span class="line"><span class="attr">gtid_mode</span> = <span class="literal">ON</span></span><br><span class="line"><span class="attr">enforce_gtid_consistency</span> = <span class="literal">TRUE</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#myisam settings</span></span><br><span class="line"><span class="attr">key_buffer_size</span> = <span class="number">32</span>M</span><br><span class="line"><span class="attr">myisam_sort_buffer_size</span> = <span class="number">128</span>M</span><br><span class="line"></span><br><span class="line"><span class="comment">#replication settings</span></span><br><span class="line"><span class="attr">relay_log_recovery</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">slave_parallel_type</span> = LOGICAL_CLOCK</span><br><span class="line"><span class="attr">slave_parallel_workers</span> = <span class="number">64</span> <span class="comment">#可以设置为逻辑CPU数量的2倍</span></span><br><span class="line"><span class="attr">binlog_transaction_dependency_tracking</span> = WRITESET</span><br><span class="line"><span class="attr">slave_preserve_commit_order</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">slave_checkpoint_period</span> = <span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#mgr settings</span></span><br><span class="line"><span class="attr">loose-plugin_load_add</span> = <span class="string">&#x27;mysql_clone.so&#x27;</span></span><br><span class="line"><span class="attr">loose-plugin_load_add</span> = <span class="string">&#x27;group_replication.so&#x27;</span></span><br><span class="line"><span class="attr">loose-group_replication_group_name</span> = <span class="string">&quot;aaaaaaaa-aaaa-aaaa-aaaa-aaaaaaaaaaa1&quot;</span></span><br><span class="line"><span class="comment">#MGR本地节点IP:PORT，请自行替换</span></span><br><span class="line"><span class="attr">loose-group_replication_local_address</span> = <span class="string">&quot;172.16.16.10:33061&quot;</span></span><br><span class="line"><span class="comment">#MGR集群所有节点IP:PORT，请自行替换</span></span><br><span class="line"><span class="attr">loose-group_replication_group_seeds</span> = <span class="string">&quot;172.16.16.10:33061,172.16.16.11:33061,172.16.16.12:33061&quot;</span></span><br><span class="line"><span class="attr">loose-group_replication_start_on_boot</span> = <span class="literal">OFF</span></span><br><span class="line"><span class="attr">loose-group_replication_bootstrap_group</span> = <span class="literal">OFF</span></span><br><span class="line"><span class="attr">loose-group_replication_exit_state_action</span> = READ_ONLY</span><br><span class="line"><span class="attr">loose-group_replication_flow_control_mode</span> = <span class="string">&quot;DISABLED&quot;</span></span><br><span class="line"><span class="attr">loose-group_replication_single_primary_mode</span> = <span class="literal">ON</span></span><br><span class="line"><span class="attr">loose-group_replication_communication_max_message_size</span> = <span class="number">10</span>M</span><br><span class="line"><span class="attr">loose-group_replication_unreachable_majority_timeout</span> = <span class="number">30</span></span><br><span class="line"><span class="attr">loose-group_replication_member_expel_timeout</span> = <span class="number">5</span></span><br><span class="line"><span class="attr">loose-group_replication_autorejoin_tries</span> = <span class="number">288</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb settings</span></span><br><span class="line"><span class="attr">transaction_isolation</span> = REPEATABLE-READ</span><br><span class="line"><span class="attr">innodb_buffer_pool_size</span> = <span class="number">45875</span>M</span><br><span class="line"><span class="attr">innodb_buffer_pool_instances</span> = <span class="number">4</span></span><br><span class="line"><span class="attr">innodb_data_file_path</span> = ibdata1:<span class="number">12</span>M:autoextend</span><br><span class="line"><span class="attr">innodb_flush_log_at_trx_commit</span> = <span class="number">1</span> <span class="comment">#MGR环境中由其他节点提供容错性，可不设置双1以提高本地节点性能</span></span><br><span class="line"><span class="attr">innodb_log_buffer_size</span> = <span class="number">32</span>M</span><br><span class="line"><span class="attr">innodb_log_file_size</span> = <span class="number">1</span>G <span class="comment">#如果线上环境的TPS较高，建议加大至1G以上，如果压力不大可以调小</span></span><br><span class="line"><span class="attr">innodb_log_files_in_group</span> = <span class="number">3</span></span><br><span class="line"><span class="attr">innodb_max_undo_log_size</span> = <span class="number">4</span>G</span><br><span class="line"><span class="comment"># 根据您的服务器IOPS能力适当调整</span></span><br><span class="line"><span class="comment"># 一般配普通SSD盘的话，可以调整到 10000 - 20000</span></span><br><span class="line"><span class="comment"># 配置高端PCIe SSD卡的话，则可以调整的更高，比如 50000 - 80000</span></span><br><span class="line"><span class="attr">innodb_io_capacity</span> = <span class="number">4000</span></span><br><span class="line"><span class="attr">innodb_io_capacity_max</span> = <span class="number">8000</span></span><br><span class="line"><span class="attr">innodb_open_files</span> = <span class="number">65535</span></span><br><span class="line"><span class="attr">innodb_flush_method</span> = O_DIRECT</span><br><span class="line"><span class="attr">innodb_lru_scan_depth</span> = <span class="number">4000</span></span><br><span class="line"><span class="attr">innodb_lock_wait_timeout</span> = <span class="number">10</span></span><br><span class="line"><span class="attr">innodb_rollback_on_timeout</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">innodb_print_all_deadlocks</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">innodb_online_alter_log_max_size</span> = <span class="number">4</span>G</span><br><span class="line"><span class="attr">innodb_print_ddl_logs</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">innodb_status_file</span> = <span class="number">1</span></span><br><span class="line"><span class="comment">#注意: 开启 innodb_status_output &amp; innodb_status_output_locks 后, 可能会导致log_error文件增长较快</span></span><br><span class="line"><span class="attr">innodb_status_output</span> = <span class="number">0</span></span><br><span class="line"><span class="attr">innodb_status_output_locks</span> = <span class="number">1</span></span><br><span class="line"><span class="attr">innodb_sort_buffer_size</span> = <span class="number">67108864</span></span><br><span class="line"><span class="attr">innodb_adaptive_hash_index</span> = <span class="literal">OFF</span></span><br><span class="line"><span class="comment">#提高索引统计信息精确度</span></span><br><span class="line"><span class="attr">innodb_stats_persistent_sample_pages</span> = <span class="number">500</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#innodb monitor settings</span></span><br><span class="line"><span class="attr">innodb_monitor_enable</span> = <span class="string">&quot;module_innodb&quot;</span></span><br><span class="line"><span class="attr">innodb_monitor_enable</span> = <span class="string">&quot;module_server&quot;</span></span><br><span class="line"><span class="attr">innodb_monitor_enable</span> = <span class="string">&quot;module_dml&quot;</span></span><br><span class="line"><span class="attr">innodb_monitor_enable</span> = <span class="string">&quot;module_ddl&quot;</span></span><br><span class="line"><span class="attr">innodb_monitor_enable</span> = <span class="string">&quot;module_trx&quot;</span></span><br><span class="line"><span class="attr">innodb_monitor_enable</span> = <span class="string">&quot;module_os&quot;</span></span><br><span class="line"><span class="attr">innodb_monitor_enable</span> = <span class="string">&quot;module_purge&quot;</span></span><br><span class="line"><span class="attr">innodb_monitor_enable</span> = <span class="string">&quot;module_log&quot;</span></span><br><span class="line"><span class="attr">innodb_monitor_enable</span> = <span class="string">&quot;module_lock&quot;</span></span><br><span class="line"><span class="attr">innodb_monitor_enable</span> = <span class="string">&quot;module_buffer&quot;</span></span><br><span class="line"><span class="attr">innodb_monitor_enable</span> = <span class="string">&quot;module_index&quot;</span></span><br><span class="line"><span class="attr">innodb_monitor_enable</span> = <span class="string">&quot;module_ibuf_system&quot;</span></span><br><span class="line"><span class="attr">innodb_monitor_enable</span> = <span class="string">&quot;module_buffer_page&quot;</span></span><br><span class="line"><span class="comment">#innodb_monitor_enable = &quot;module_adaptive_hash&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#pfs settings</span></span><br><span class="line"><span class="attr">performance_schema</span> = <span class="number">1</span></span><br><span class="line"><span class="comment">#performance_schema_instrument = &#x27;%memory%=on&#x27;</span></span><br><span class="line"><span class="attr">performance_schema_instrument</span> = <span class="string">&#x27;%lock%=on&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[mysqldump]</span></span><br><span class="line">quick</span><br></pre></td></tr></table></figure><h2 id="1-配置查看"><a href="#1-配置查看" class="headerlink" title="1. 配置查看"></a>1. 配置查看</h2><ul><li>mysql默认配置在<code>/etc/my.cnf</code></li><li>查看当前mysql的配置使用命令</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">show variables like <span class="string">&#x27;%sort_buffer_size&#x27;</span>;</span></span><br><span class="line">+-------------------------+---------+</span><br><span class="line">| Variable_name           | Value   |</span><br><span class="line">+-------------------------+---------+</span><br><span class="line">| innodb_sort_buffer_size | 1048576 |</span><br><span class="line">| myisam_sort_buffer_size | 8388608 |</span><br><span class="line">| sort_buffer_size        | 524288  |</span><br><span class="line">+-------------------------+---------+</span><br><span class="line">3 rows in set (0.00 sec)</span><br></pre></td></tr></table></figure><h2 id="2-配置说明"><a href="#2-配置说明" class="headerlink" title="2. 配置说明"></a>2. 配置说明</h2><h3 id="2-1-mysqld配置"><a href="#2-1-mysqld配置" class="headerlink" title="2.1. mysqld配置"></a>2.1. mysqld配置</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line"># 写入数据库时innodb引擎的大小，调大可以加快写入引擎的速度</span><br><span class="line">innodb_sort_buffer_size = 512K</span><br><span class="line"># 单条sql语句的排序使用内存，跟引擎无关，只对查询生效</span><br><span class="line">sort_buffer_size = 512K</span><br><span class="line"></span><br><span class="line">########## innodb相关配置 ##########</span><br><span class="line"># 死锁检测，会自动检测死锁并执行回滚，不开启会等待超时，如果超时也没开就卡死</span><br><span class="line">innodb_deadlock_detect = ON</span><br><span class="line"># 启动标准监控，会打印日志到log_error变量指定的文件中，监视活动事务持有的表锁、行锁；事务锁等待；线程信号量等待；文件IO请求；buffer pool统计信息；InnoDB主线程purge和change buffer merge活动。</span><br><span class="line">innodb_status_output = ON</span><br><span class="line"># 同上添加额外的锁信息</span><br><span class="line">innodb_status_output_locks = ON</span><br><span class="line"># 将每一次死锁的信息都输出到日志中，仅输出 LATEST DETECTED DEADLOCK 部分</span><br><span class="line">innodb_print_all_deadlocks = ON</span><br></pre></td></tr></table></figure><h1 id="三、命令"><a href="#三、命令" class="headerlink" title="三、命令"></a>三、命令</h1><h2 id="1-查看相关"><a href="#1-查看相关" class="headerlink" title="1. 查看相关"></a>1. 查看相关</h2><h3 id="1-1-查看历史执行的sql语句记录"><a href="#1-1-查看历史执行的sql语句记录" class="headerlink" title="1.1. 查看历史执行的sql语句记录"></a>1.1. 查看历史执行的sql语句记录</h3><p><strong>查看当前日志配置</strong></p><ul><li><code>log_output</code>是FILE，会记录在<code>general_log_file</code>里面</li><li><code>log_output</code>是TABLE，会记录在<code>mysql.geral_log</code>表里面</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%general_log%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+---------------------------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name    <span class="operator">|</span> <span class="keyword">Value</span>                     <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+---------------------------+</span></span><br><span class="line"><span class="operator">|</span> general_log      <span class="operator">|</span> OFF                       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> general_log_file <span class="operator">|</span> <span class="operator">/</span>var<span class="operator">/</span>lib<span class="operator">/</span>mysql<span class="operator">/</span>sql.log <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------------------+---------------------------+</span></span><br><span class="line"><span class="number">2</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> variables <span class="keyword">like</span> <span class="string">&#x27;%log_output%&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+-------+</span></span><br><span class="line"><span class="operator">|</span> Variable_name <span class="operator">|</span> <span class="keyword">Value</span> <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+-------+</span></span><br><span class="line"><span class="operator">|</span> log_output    <span class="operator">|</span> FILE  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">---------------+-------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br></pre></td></tr></table></figure><p><strong>打开日志</strong></p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">set</span> <span class="keyword">global</span> log_output <span class="operator">=</span> <span class="string">&#x27;FILE,TABLE&#x27;</span>;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">set</span> <span class="keyword">global</span> general_log <span class="operator">=</span> <span class="string">&#x27;ON&#x27;</span>;</span><br><span class="line">Query OK, <span class="number">0</span> <span class="keyword">rows</span> affected (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>查看文件</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">=&gt; tail -f /path/to/log</span><br><span class="line">2022-02-19T03:15:02.002365Z     941903 Prepare  SELECT * FROM `uem_app_wp` WHERE (`app_type`=?) AND (updated_at &lt; ?) AND (`state` IN (?,?))</span><br><span class="line">2022-02-19T03:15:02.002444Z     941903 Execute  SELECT * FROM `uem_app_wp` WHERE (`app_type`=1) AND (updated_at &lt; &#x27;2022-02-19 11:14:02&#x27;) AND (`state` IN (&#x27;2&#x27;,&#x27;3&#x27;))</span><br><span class="line">2022-02-19T03:15:02.003244Z     941903 Close stmt</span><br><span class="line">2022-02-19T03:15:02.286509Z     941910 Connect  sdpSys@localhost on sdp using SSL/TLS</span><br><span class="line">2022-02-19T03:15:02.287029Z     941910 Query    select @@version_comment limit 1</span><br><span class="line">2022-02-19T03:15:02.287341Z     941910 Query    select count(distinct name, domain) from user_online_status_v2</span><br><span class="line">2022-02-19T03:15:02.288005Z     941910 Quit</span><br></pre></td></tr></table></figure><p>查看数据库</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> mysql.general_log <span class="keyword">order</span> <span class="keyword">by</span> event_time <span class="keyword">desc</span> limit <span class="number">5</span>\G;</span><br><span class="line">...</span><br></pre></td></tr></table></figure><h3 id="1-2-查看建表语句"><a href="#1-2-查看建表语句" class="headerlink" title="1.2. 查看建表语句"></a>1.2. 查看建表语句</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> <span class="keyword">create</span> <span class="keyword">table</span> test_table;</span><br></pre></td></tr></table></figure><h3 id="1-3-查看数据库表都有哪些索引"><a href="#1-3-查看数据库表都有哪些索引" class="headerlink" title="1.3. 查看数据库表都有哪些索引"></a>1.3. 查看数据库表都有哪些索引</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">show</span> index <span class="keyword">from</span> resource;</span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+-------------------+--------------+-----------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">Table</span>    <span class="operator">|</span> Non_unique <span class="operator">|</span> Key_name          <span class="operator">|</span> Seq_in_index <span class="operator">|</span> Column_name     <span class="operator">|</span> <span class="keyword">Collation</span> <span class="operator">|</span> <span class="keyword">Cardinality</span> <span class="operator">|</span> Sub_part <span class="operator">|</span> Packed <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Index_type <span class="operator">|</span> Comment <span class="operator">|</span> Index_comment <span class="operator">|</span> Visible <span class="operator">|</span> Expression <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+-------------------+--------------+-----------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+</span></span><br><span class="line"><span class="operator">|</span> resource <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> <span class="keyword">PRIMARY</span>           <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> id              <span class="operator">|</span> A         <span class="operator">|</span>          <span class="number">24</span> <span class="operator">|</span>     <span class="keyword">NULL</span> <span class="operator">|</span>   <span class="keyword">NULL</span> <span class="operator">|</span>      <span class="operator">|</span> BTREE      <span class="operator">|</span>         <span class="operator">|</span>               <span class="operator">|</span> YES     <span class="operator">|</span> <span class="keyword">NULL</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> resource <span class="operator">|</span>          <span class="number">0</span> <span class="operator">|</span> resource_name     <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> name            <span class="operator">|</span> A         <span class="operator">|</span>          <span class="number">24</span> <span class="operator">|</span>     <span class="keyword">NULL</span> <span class="operator">|</span>   <span class="keyword">NULL</span> <span class="operator">|</span> YES  <span class="operator">|</span> BTREE      <span class="operator">|</span>         <span class="operator">|</span>               <span class="operator">|</span> YES     <span class="operator">|</span> <span class="keyword">NULL</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">|</span> resource <span class="operator">|</span>          <span class="number">1</span> <span class="operator">|</span> resource_group_id <span class="operator">|</span>            <span class="number">1</span> <span class="operator">|</span> group_id        <span class="operator">|</span> A         <span class="operator">|</span>           <span class="number">3</span> <span class="operator">|</span>     <span class="keyword">NULL</span> <span class="operator">|</span>   <span class="keyword">NULL</span> <span class="operator">|</span> YES  <span class="operator">|</span> BTREE      <span class="operator">|</span>         <span class="operator">|</span>               <span class="operator">|</span> YES     <span class="operator">|</span> <span class="keyword">NULL</span>       <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">----------+------------+-------------------+--------------+-----------------+-----------+-------------+----------+--------+------+------------+---------+---------------+---------+------------+</span></span><br><span class="line"><span class="number">15</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.29</span> sec)</span><br></pre></td></tr></table></figure><h2 id="2-json操作"><a href="#2-json操作" class="headerlink" title="2. json操作"></a>2. json操作</h2><h3 id="2-1-查询"><a href="#2-1-查询" class="headerlink" title="2.1. 查询"></a>2.1. 查询</h3><ul><li><code>-&gt;</code>使用双引号包裹</li><li><code>-&gt;&gt;</code>不使用双引号</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> id, config <span class="operator">-</span><span class="operator">&gt;</span> <span class="string">&#x27;$.config.url&#x27;</span> <span class="keyword">as</span> requestUrl, config <span class="operator">-</span><span class="operator">&gt;&gt;</span> <span class="string">&#x27;$.config.url&#x27;</span> <span class="keyword">as</span> requestUrl1 <span class="keyword">from</span> auth_plugin_template <span class="keyword">where</span> id<span class="operator">=</span><span class="string">&#x27;8d5cdeb4-e2db-11ea-9a8c-fefcfead2706&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------+-------------------------------+-----------------------------+</span></span><br><span class="line"><span class="operator">|</span> id                                   <span class="operator">|</span> requestUrl                    <span class="operator">|</span> requestUrl1                 <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------+-------------------------------+-----------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="number">8</span>d5cdeb4<span class="operator">-</span>e2db<span class="number">-11</span>ea<span class="number">-9</span>a8c<span class="operator">-</span>fefcfead2706 <span class="operator">|</span> &quot;https://qyapi.weixin.qq.com&quot; <span class="operator">|</span> https:<span class="operator">/</span><span class="operator">/</span>qyapi.weixin.qq.com <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">--------------------------------------+-------------------------------+-----------------------------+</span></span><br></pre></td></tr></table></figure><h3 id="2-2-更新"><a href="#2-2-更新" class="headerlink" title="2.2. 更新"></a>2.2. 更新</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">update</span> tab_json <span class="keyword">set</span> data <span class="operator">=</span> json_set(data, &quot;$.passcode&quot;, &quot;654567&quot;) <span class="keyword">where</span> id <span class="operator">=</span> <span class="number">1</span>;</span><br></pre></td></tr></table></figure><h2 id="3-内置数据库"><a href="#3-内置数据库" class="headerlink" title="3. 内置数据库"></a>3. 内置数据库</h2><h3 id="3-1-information-schema"><a href="#3-1-information-schema" class="headerlink" title="3.1. information_schema"></a>3.1. information_schema</h3><h4 id="1-tables表"><a href="#1-tables表" class="headerlink" title="1) tables表"></a>1) tables表</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="operator">*</span> <span class="keyword">from</span> information_schema.tables\G;</span><br><span class="line"><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span> <span class="number">1.</span> <span class="type">row</span> <span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span><span class="operator">*</span></span><br><span class="line">  TABLE_CATALOG: def</span><br><span class="line">   TABLE_SCHEMA: sdp                <span class="comment">-- 数据库名</span></span><br><span class="line">     TABLE_NAME: device_approval    <span class="comment">-- 数据表名</span></span><br><span class="line">     TABLE_TYPE: BASE <span class="keyword">TABLE</span></span><br><span class="line">         ENGINE: InnoDB</span><br><span class="line">        VERSION: <span class="number">10</span></span><br><span class="line">     ROW_FORMAT: <span class="keyword">Dynamic</span></span><br><span class="line">     TABLE_ROWS: <span class="number">0</span></span><br><span class="line"> AVG_ROW_LENGTH: <span class="number">0</span></span><br><span class="line">    DATA_LENGTH: <span class="number">16384</span></span><br><span class="line">MAX_DATA_LENGTH: <span class="number">0</span></span><br><span class="line">   INDEX_LENGTH: <span class="number">65536</span></span><br><span class="line">      DATA_FREE: <span class="number">0</span></span><br><span class="line"> AUTO_INCREMENT: <span class="keyword">NULL</span></span><br><span class="line">    CREATE_TIME: <span class="number">2022</span><span class="number">-03</span><span class="number">-04</span> <span class="number">15</span>:<span class="number">50</span>:<span class="number">48</span></span><br><span class="line">    UPDATE_TIME: <span class="keyword">NULL</span></span><br><span class="line">     CHECK_TIME: <span class="keyword">NULL</span></span><br><span class="line">TABLE_COLLATION: utf8mb4_bin</span><br><span class="line">       CHECKSUM: <span class="keyword">NULL</span></span><br><span class="line"> CREATE_OPTIONS:</span><br><span class="line">  TABLE_COMMENT: 授信终端用户申请表</span><br><span class="line"><span class="number">1</span> <span class="keyword">rows</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.02</span> sec)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="4-基本操作"><a href="#4-基本操作" class="headerlink" title="4. 基本操作"></a>4. 基本操作</h2><h3 id="4-1-数据库操作"><a href="#4-1-数据库操作" class="headerlink" title="4.1. 数据库操作"></a>4.1. 数据库操作</h3><ul><li>语法</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> DATABASE [IF <span class="keyword">NOT</span> <span class="keyword">EXISTS</span>] <span class="operator">&lt;</span>数据库名<span class="operator">&gt;</span></span><br><span class="line">[[<span class="keyword">DEFAULT</span>] <span class="type">CHARACTER</span> <span class="keyword">SET</span> <span class="operator">&lt;</span>字符集名<span class="operator">&gt;</span>]</span><br><span class="line">[[<span class="keyword">DEFAULT</span>] <span class="keyword">COLLATE</span> <span class="operator">&lt;</span>校对规则名<span class="operator">&gt;</span>];</span><br></pre></td></tr></table></figure><h3 id="4-2-数据表操作"><a href="#4-2-数据表操作" class="headerlink" title="4.2. 数据表操作"></a>4.2. 数据表操作</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建数据表</span></span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> `emm_data` (</span><br><span class="line">  `id` <span class="type">int</span> unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span> AUTO_INCREMENT,</span><br><span class="line">  `path` <span class="type">varchar</span>(<span class="number">512</span>) <span class="keyword">COLLATE</span> utf8mb4_bin <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `size` <span class="type">int</span> unsigned <span class="keyword">NOT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  `modify` <span class="type">date</span> <span class="keyword">DEFAULT</span> <span class="keyword">NULL</span>,</span><br><span class="line">  <span class="keyword">PRIMARY</span> KEY (`id`),</span><br><span class="line">  <span class="keyword">UNIQUE</span> KEY `emm_data_path` (`path`)</span><br><span class="line">) ENGINE<span class="operator">=</span>InnoDB <span class="keyword">DEFAULT</span> CHARSET<span class="operator">=</span>utf8mb4 <span class="keyword">COLLATE</span><span class="operator">=</span>utf8mb4_bin</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 删除数据表</span></span><br><span class="line"><span class="keyword">drop</span> <span class="keyword">table</span> emm_data</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 对某个表加一列</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">table</span> log <span class="keyword">add</span> <span class="keyword">column</span> logDate datetime <span class="keyword">default</span> <span class="keyword">NULL</span> comment <span class="string">&#x27;日志时间&#x27;</span> after id;</span><br><span class="line"></span><br><span class="line"><span class="comment">---------- 事务操作 ----------</span></span><br><span class="line"><span class="comment">-- 启动事务</span></span><br><span class="line"><span class="keyword">start</span> transaction;</span><br><span class="line"><span class="comment">-- 回滚事务</span></span><br><span class="line"><span class="keyword">rollback</span> work;</span><br><span class="line"><span class="comment">-- 提交事务</span></span><br><span class="line"><span class="keyword">commit</span> work;</span><br></pre></td></tr></table></figure><h4 id="1-索引"><a href="#1-索引" class="headerlink" title="1) 索引"></a>1) 索引</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 创建索引，多个列就是联合索引</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">ADD</span> INDEX index_name(column_name,...)</span><br><span class="line"><span class="comment">-- 删除索引</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">ALTER</span> <span class="keyword">TABLE</span> table_name <span class="keyword">DROP</span> INDEX index_name;</span><br></pre></td></tr></table></figure><h4 id="2-查看列详细信息"><a href="#2-查看列详细信息" class="headerlink" title="2) 查看列详细信息"></a>2) 查看列详细信息</h4><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> <span class="keyword">FULL</span> COLUMNS <span class="keyword">FROM</span> table_name <span class="keyword">WHERE</span> Field<span class="operator">=</span><span class="string">&#x27;column_name&#x27;</span>;</span><br></pre></td></tr></table></figure><p>示例</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">SHOW</span> <span class="keyword">FULL</span> COLUMNS <span class="keyword">FROM</span> resource <span class="keyword">WHERE</span> Field<span class="operator">=</span><span class="string">&#x27;name&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-----------+----------------+------+-----+---------+-------+---------------------------------+---------+</span></span><br><span class="line"><span class="operator">|</span> Field <span class="operator">|</span> Type      <span class="operator">|</span> <span class="keyword">Collation</span>      <span class="operator">|</span> <span class="keyword">Null</span> <span class="operator">|</span> Key <span class="operator">|</span> <span class="keyword">Default</span> <span class="operator">|</span> Extra <span class="operator">|</span> Privileges                      <span class="operator">|</span> Comment <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-----------+----------------+------+-----+---------+-------+---------------------------------+---------+</span></span><br><span class="line"><span class="operator">|</span> name  <span class="operator">|</span> <span class="type">char</span>(<span class="number">255</span>) <span class="operator">|</span> gbk_chinese_ci <span class="operator">|</span> YES  <span class="operator">|</span>     <span class="operator">|</span> <span class="keyword">NULL</span>    <span class="operator">|</span>       <span class="operator">|</span> <span class="keyword">select</span>,<span class="keyword">insert</span>,<span class="keyword">update</span>,<span class="keyword">references</span> <span class="operator">|</span>         <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">-------+-----------+----------------+------+-----+---------+-------+---------------------------------+---------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.01</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="5-数据库基本类型"><a href="#5-数据库基本类型" class="headerlink" title="5. 数据库基本类型"></a>5. 数据库基本类型</h2><table><thead><tr><th>类型</th><th>描述</th></tr></thead><tbody><tr><td>date</td><td>日期，精确到天</td></tr><tr><td>datetime</td><td>日期，精确到秒</td></tr><tr><td>text</td><td>纯文本数据，无需限制长度，最大65535，不能设置默认值</td></tr><tr><td>char</td><td>定长，不足会补空格</td></tr><tr><td>varchar</td><td>起始位结束位占3个字节，可以存放65532字节的数据，变长，不需要不会申请空间</td></tr></tbody></table><h2 id="6-列求和"><a href="#6-列求和" class="headerlink" title="6. 列求和"></a>6. 列求和</h2><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="built_in">sum</span>(size) <span class="keyword">from</span> emm_data <span class="keyword">where</span> id <span class="operator">&gt;</span> <span class="string">&#x27;5&#x27;</span>;</span><br></pre></td></tr></table></figure><h2 id="7-添加函数索引"><a href="#7-添加函数索引" class="headerlink" title="7. 添加函数索引"></a>7. 添加函数索引</h2><ul><li>可以对数据库的列添加函数索引，注意函数外面的括号不能少</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">CREATE</span> INDEX gbk_name_idx <span class="keyword">ON</span> resource ((<span class="keyword">CONVERT</span>(name <span class="keyword">USING</span> gbk)));</span><br></pre></td></tr></table></figure><h2 id="8-添加计算列"><a href="#8-添加计算列" class="headerlink" title="8. 添加计算列"></a>8. 添加计算列</h2><ul><li>添加某一列的数据跟随另一列进行计算得到，计算式放as后面</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">table</span> resource <span class="keyword">add</span> <span class="keyword">column</span> name_gbk <span class="type">varchar</span>(<span class="number">128</span>) <span class="type">character</span> <span class="keyword">set</span> gbk <span class="keyword">as</span> (<span class="keyword">convert</span>(name <span class="keyword">using</span> gbk));</span><br></pre></td></tr></table></figure><h2 id="9-管理操作"><a href="#9-管理操作" class="headerlink" title="9. 管理操作"></a>9. 管理操作</h2><h3 id="9-1-设置用户密码"><a href="#9-1-设置用户密码" class="headerlink" title="9.1. 设置用户密码"></a>9.1. 设置用户密码</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">alter</span> <span class="keyword">user</span> <span class="string">&#x27;root&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;123456&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="9-2-创建用户"><a href="#9-2-创建用户" class="headerlink" title="9.2. 创建用户"></a>9.2. 创建用户</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 创建允许所有地址登陆的用户</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">user</span> <span class="string">&#x27;test&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;123456&#x27;</span>;</span><br><span class="line"># 创建仅允许本机登陆的用户</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">create</span> <span class="keyword">user</span> <span class="string">&#x27;test&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span> identified <span class="keyword">by</span> <span class="string">&#x27;123456&#x27;</span>;</span><br></pre></td></tr></table></figure><h3 id="9-3-赋予用户权限"><a href="#9-3-赋予用户权限" class="headerlink" title="9.3. 赋予用户权限"></a>9.3. 赋予用户权限</h3><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"># 授予某个表的查询和删除权限</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">GRANT</span> <span class="keyword">SELECT</span>, <span class="keyword">DELETE</span> <span class="keyword">ON</span> database_name.table_name <span class="keyword">TO</span> <span class="string">&#x27;test&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br><span class="line"># 授予所有表的所有权限</span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">GRANT</span> <span class="keyword">ALL</span> PRIVILEGES <span class="keyword">ON</span> <span class="operator">*</span>.<span class="operator">*</span> <span class="keyword">TO</span> <span class="string">&#x27;test&#x27;</span>@<span class="string">&#x27;localhost&#x27;</span>;</span><br></pre></td></tr></table></figure><h2 id="10-mysql本身的命令"><a href="#10-mysql本身的命令" class="headerlink" title="10. mysql本身的命令"></a>10. mysql本身的命令</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -h &lt;远程服务器IP地址&gt; -P &lt;端口号&gt; -u &lt;用户名&gt; -p</span><br></pre></td></tr></table></figure><h1 id="四、慢查询"><a href="#四、慢查询" class="headerlink" title="四、慢查询"></a>四、慢查询</h1><p><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_39390545/article/details/116139445">MySQL慢查询，一口从天而降的锅！</a></p><p>慢查询就是执行很慢的查询语句，超过配置的时间。一条慢查询可能导致阻塞其他查询语句，造成cpu猛增，影响系统的正常运行</p><h2 id="1-配置"><a href="#1-配置" class="headerlink" title="1. 配置"></a>1. 配置</h2><h3 id="1-1-查看当前配置"><a href="#1-1-查看当前配置" class="headerlink" title="1.1. 查看当前配置"></a>1.1. 查看当前配置</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_"># </span><span class="language-bash">慢查询日志记录开关和位置</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">show variables like <span class="string">&quot;%slow_query%&quot;</span>;</span></span><br><span class="line">+-----------------------------+-----------------------------------+</span><br><span class="line">| Variable_name               | Value                             |</span><br><span class="line">+-----------------------------+-----------------------------------+</span><br><span class="line">| slow_query_log              | ON                                |</span><br><span class="line">| slow_query_log_file         | /hislog/log/mysql/mysqld_slow.log |</span><br><span class="line">+-----------------------------+-----------------------------------+</span><br><span class="line">7 rows in set (0.00 sec)</span><br><span class="line"><span class="meta prompt_"># </span><span class="language-bash">慢查询时间阈值</span></span><br><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">show variables like <span class="string">&quot;%long_query%&quot;</span>;</span></span><br><span class="line">+-----------------+----------+</span><br><span class="line">| Variable_name   | Value    |</span><br><span class="line">+-----------------+----------+</span><br><span class="line">| long_query_time | 5.000000 |</span><br><span class="line">+-----------------+----------+</span><br><span class="line">1 row in set (0.00 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="1-2-配置文件"><a href="#1-2-配置文件" class="headerlink" title="1.2. 配置文件"></a>1.2. 配置文件</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[mysqld]</span><br><span class="line">slow_query_log=ON</span><br><span class="line">slow_query_log_file=/hislog/log/mysql/mysqld_slow.log</span><br><span class="line">long_query_time=5</span><br></pre></td></tr></table></figure><h2 id="2-慢查询日志解读"><a href="#2-慢查询日志解读" class="headerlink" title="2. 慢查询日志解读"></a>2. 慢查询日志解读</h2><ul><li>一条慢查询语句的格式</li></ul><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"># Time: 2023-09-22T02:45:24.805459Z</span><br><span class="line"># User@Host: controller[controller] @ localhost [127.0.0.1]  Id: 563817</span><br><span class="line"># Query_time: 5.969860  Lock_time: 0.000514 Rows_sent: 99967  Rows_examined: 199934</span><br><span class="line">SET timestamp=1695350718;</span><br><span class="line">SELECT resource.id AS id,</span><br><span class="line">                UNIX_TIMESTAMP(resource.created_at) AS created_at,</span><br><span class="line">                UNIX_TIMESTAMP(resource.updated_at) AS updated_at,</span><br><span class="line">                IFNULL(baseline_permission_resource.status, 0) AS baseline_status</span><br><span class="line">                FROM resource</span><br><span class="line">                LEFT JOIN</span><br><span class="line">                baseline_permission_resource ON resource.id = baseline_permission_resource.resource_id</span><br><span class="line">                WHERE resource.status = 1</span><br><span class="line">                ORDER BY CONVERT(resource.name USING gbk) ASC;</span><br></pre></td></tr></table></figure><ul><li><code>Query_time</code>: 查询时间</li><li><code>Lock_time</code>: 锁定时间</li><li><code>Rows_sent</code>: 发送的行数</li><li><code>Rows_examined</code>: 检查的行数</li></ul><h2 id="3-分析sql语句"><a href="#3-分析sql语句" class="headerlink" title="3. 分析sql语句"></a>3. 分析sql语句</h2><ul><li>在sql语句前面加上<code>explain</code>，查看执行计划</li></ul><h1 id="五、性能和配置调优"><a href="#五、性能和配置调优" class="headerlink" title="五、性能和配置调优"></a>五、性能和配置调优</h1><h2 id="1-explain-分析sql语句"><a href="#1-explain-分析sql语句" class="headerlink" title="1. explain 分析sql语句"></a>1. explain 分析sql语句</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta prompt_">mysql&gt; </span><span class="language-bash">explain <span class="keyword">select</span> * from resource order by <span class="built_in">id</span> asc;</span></span><br><span class="line">+----+-------------+----------+------------+-------+---------------+---------+---------+------+-------+----------+-------+</span><br><span class="line">| id | select_type | table    | partitions | type  | possible_keys | key     | key_len | ref  | rows  | filtered | Extra |</span><br><span class="line">+----+-------------+----------+------------+-------+---------------+---------+---------+------+-------+----------+-------+</span><br><span class="line">|  1 | SIMPLE      | resource | NULL       | index | NULL          | PRIMARY | 144     | NULL | 76807 |   100.00 | NULL  |</span><br><span class="line">+----+-------------+----------+------------+-------+---------------+---------+---------+------+-------+----------+-------+</span><br><span class="line">1 row in set, 1 warning (0.00 sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="1-1-各字段分析"><a href="#1-1-各字段分析" class="headerlink" title="1.1. 各字段分析"></a>1.1. 各字段分析</h3><ul><li><code>id</code>: 查询序列号，体现优先级，id越大优先级越高，越先被执行</li><li><code>select_type</code>: 查询类型</li><li><code>table</code>: 表名</li><li><code>partitions</code>: 分配到的分区</li><li><code>type</code>: 访问类型</li><li><code>possible_keys</code>: 可能使用到的索引</li><li><code>key</code>: 实际使用到的索引</li><li><code>key_len</code>: 索引字段长度</li><li><code>ref</code>: 列和索引的比较</li><li><code>rows</code>: 扫描的行数</li><li><code>filtered</code>: 过滤的比例</li><li><code>Extra</code>: 执行情况描述和说明</li></ul><h4 id="1-type-访问类型"><a href="#1-type-访问类型" class="headerlink" title="1) type 访问类型"></a>1) type 访问类型</h4><ul><li><code>ALL</code>: 全表扫描</li><li><code>index</code>: 只遍历索引树</li><li><code>range</code>: 只检索给定范围的行，使用一个索引来遍历行</li><li><code>ref</code>: 遍历索引树时，对一个或多个列进行引用</li><li><code>eq_ref</code>: 对于每个索引键，表中只有一条记录与之匹配</li><li><code>const</code>: 表示常量，一般做为查询条件</li><li><code>system</code>: 表示系统表</li></ul><h4 id="2-Extra-执行情况描述和说明"><a href="#2-Extra-执行情况描述和说明" class="headerlink" title="2) Extra 执行情况描述和说明"></a>2) Extra 执行情况描述和说明</h4><ul><li><code>Using index</code>: 查询的数据被索引覆盖，并且where筛选的是前导列，使用索引查找就可以直接找到符合条件的数据，无需回表</li><li><code>Using where</code>: 说明mysql将在存储引擎检索行后再进行过滤，没有用到索引，回表查询</li><li><code>Using temporary</code>: 对查询结果排序时使用了一个临时表</li><li><code>Using filesort</code>: 对结果使用一个外部索引排序，而不是按照索引次序从表中读取行，一般是order by用了其他数据</li><li><code>Using index condition</code>: 查询的列不全在索引中，where条件是一个前导列范围</li><li><code>Using where;Using index</code>: 查询的列被索引覆盖，where筛选条件也是索引列之一，但不是索引的前导列或出现其他影响了使用索引的情况（如存在范围筛选条件）。此情况下意味着无法直接通过索引查找来查询到符合条件的数据，影响并不大</li></ul><h2 id="2-死锁"><a href="#2-死锁" class="headerlink" title="2. 死锁"></a>2. 死锁</h2><h1 id="六、攻防"><a href="#六、攻防" class="headerlink" title="六、攻防"></a>六、攻防</h1><h2 id="1-无密码登陆数据库"><a href="#1-无密码登陆数据库" class="headerlink" title="1. 无密码登陆数据库"></a>1. 无密码登陆数据库</h2><ul><li>先使用管理员打开cmd，停止mysql服务</li><li>执行命令</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysqld --skip-grant-tables --skip-networking</span><br></pre></td></tr></table></figure><ul><li>窗口不关，打开新的窗口输入命令</li></ul><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mysql -uroot -p</span><br></pre></td></tr></table></figure><ul><li>直接回车即可进入mysql</li></ul><h2 id="2-查看其他用户密码"><a href="#2-查看其他用户密码" class="headerlink" title="2. 查看其他用户密码"></a>2. 查看其他用户密码</h2><ul><li>先使用root登陆mysql</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 进入到mysql表</span></span><br><span class="line">mysql<span class="operator">&gt;</span> use mysql</span><br><span class="line"><span class="comment">-- 查看用户表</span></span><br><span class="line">mysql<span class="operator">&gt;</span> <span class="keyword">select</span> <span class="keyword">User</span>,authentication_string <span class="keyword">from</span> <span class="keyword">user</span> <span class="keyword">where</span> <span class="keyword">user</span><span class="operator">=</span><span class="string">&#x27;mysql.sys&#x27;</span>;</span><br><span class="line"><span class="operator">+</span><span class="comment">------+------------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> <span class="keyword">User</span> <span class="operator">|</span> authentication_string                                                  <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------------------------------------------------------------------------+</span></span><br><span class="line"><span class="operator">|</span> root <span class="operator">|</span> $A$<span class="number">005</span>$THISISACOMBINATIONOFINVALIDSALTANDPASSWORDTHATMUSTNEVERBRBEUSED <span class="operator">|</span></span><br><span class="line"><span class="operator">+</span><span class="comment">------+------------------------------------------------------------------------+</span></span><br><span class="line"><span class="number">1</span> <span class="type">row</span> <span class="keyword">in</span> <span class="keyword">set</span> (<span class="number">0.00</span> sec)</span><br><span class="line"></span><br></pre></td></tr></table></figure><h1 id="小技巧和踩坑记"><a href="#小技巧和踩坑记" class="headerlink" title="小技巧和踩坑记"></a>小技巧和踩坑记</h1><h2 id="1-表情符号导致无法插入数据库"><a href="#1-表情符号导致无法插入数据库" class="headerlink" title="1. 表情符号导致无法插入数据库"></a>1. 表情符号导致无法插入数据库</h2><ul><li>utf8无法支持表情符号，需要将数据库转到utf8mb4</li></ul><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">ALTER</span> <span class="keyword">TABLE</span> mirror_user CHANGE name name <span class="type">varchar</span>(<span class="number">128</span>) <span class="type">CHARACTER</span> <span class="keyword">SET</span> utf8mb4 <span class="keyword">COLLATE</span> utf8mb4_bin;</span><br></pre></td></tr></table></figure></div><div class="reward-container"><div></div><button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'>打赏</button><div id="qr" style="display:none"><div style="display:inline-block"><img src="/images/wechatpay.png" alt="王钰博 微信支付"><p>微信支付</p></div><div style="display:inline-block"><img src="/images/alipay.jpg" alt="王钰博 支付宝"><p>支付宝</p></div></div></div><footer class="post-footer"><div class="post-nav"><div class="post-nav-item"><a href="/blogs/2023-06-05-go-for-windows/" rel="prev" title="windows上的go开发"><i class="fa fa-chevron-left"></i> windows上的go开发</a></div><div class="post-nav-item"><a href="/blogs/2023-10-31-lua/" rel="next" title="lua和openrestry">lua和openrestry <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>window.addEventListener("tabs:register",()=>{let{activeClass:t}=CONFIG.comments;if(CONFIG.comments.storage&&(t=localStorage.getItem("comments_active")||t),t){let e=document.querySelector(`a[href="#comment-${t}"]`);e&&e.click()}}),CONFIG.comments.storage&&window.addEventListener("tabs:click",t=>{if(!t.target.matches(".tabs-comment .tab-content .tab-pane"))return;let e=t.target.classList[1];localStorage.setItem("comments_active",e)})</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%80%E3%80%81%E5%AE%89%E8%A3%85"><span class="nav-text">一、安装</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-windows"><span class="nav-text">1. windows</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-mysqld%E7%9A%84%E4%B8%80%E4%BA%9B%E6%93%8D%E4%BD%9C"><span class="nav-text">1.1. mysqld的一些操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B8%A9%E5%9D%91%E8%AE%B0"><span class="nav-text">踩坑记</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-MYSQL%E6%8A%A5%E9%94%99-Failed-to-find-valid-data-directory"><span class="nav-text">1) MYSQL报错 Failed to find valid data directory.</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%8C%E3%80%81%E9%85%8D%E7%BD%AE"><span class="nav-text">二、配置</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E9%85%8D%E7%BD%AE%E6%9F%A5%E7%9C%8B"><span class="nav-text">1. 配置查看</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E9%85%8D%E7%BD%AE%E8%AF%B4%E6%98%8E"><span class="nav-text">2. 配置说明</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-mysqld%E9%85%8D%E7%BD%AE"><span class="nav-text">2.1. mysqld配置</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%B8%89%E3%80%81%E5%91%BD%E4%BB%A4"><span class="nav-text">三、命令</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E6%9F%A5%E7%9C%8B%E7%9B%B8%E5%85%B3"><span class="nav-text">1. 查看相关</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E6%9F%A5%E7%9C%8B%E5%8E%86%E5%8F%B2%E6%89%A7%E8%A1%8C%E7%9A%84sql%E8%AF%AD%E5%8F%A5%E8%AE%B0%E5%BD%95"><span class="nav-text">1.1. 查看历史执行的sql语句记录</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E6%9F%A5%E7%9C%8B%E5%BB%BA%E8%A1%A8%E8%AF%AD%E5%8F%A5"><span class="nav-text">1.2. 查看建表语句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-3-%E6%9F%A5%E7%9C%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E8%A1%A8%E9%83%BD%E6%9C%89%E5%93%AA%E4%BA%9B%E7%B4%A2%E5%BC%95"><span class="nav-text">1.3. 查看数据库表都有哪些索引</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-json%E6%93%8D%E4%BD%9C"><span class="nav-text">2. json操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#2-1-%E6%9F%A5%E8%AF%A2"><span class="nav-text">2.1. 查询</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#2-2-%E6%9B%B4%E6%96%B0"><span class="nav-text">2.2. 更新</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%86%85%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">3. 内置数据库</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#3-1-information-schema"><span class="nav-text">3.1. information_schema</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-tables%E8%A1%A8"><span class="nav-text">1) tables表</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-%E5%9F%BA%E6%9C%AC%E6%93%8D%E4%BD%9C"><span class="nav-text">4. 基本操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#4-1-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="nav-text">4.1. 数据库操作</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#4-2-%E6%95%B0%E6%8D%AE%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="nav-text">4.2. 数据表操作</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-%E7%B4%A2%E5%BC%95"><span class="nav-text">1) 索引</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-%E6%9F%A5%E7%9C%8B%E5%88%97%E8%AF%A6%E7%BB%86%E4%BF%A1%E6%81%AF"><span class="nav-text">2) 查看列详细信息</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E6%9C%AC%E7%B1%BB%E5%9E%8B"><span class="nav-text">5. 数据库基本类型</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-%E5%88%97%E6%B1%82%E5%92%8C"><span class="nav-text">6. 列求和</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-%E6%B7%BB%E5%8A%A0%E5%87%BD%E6%95%B0%E7%B4%A2%E5%BC%95"><span class="nav-text">7. 添加函数索引</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-%E6%B7%BB%E5%8A%A0%E8%AE%A1%E7%AE%97%E5%88%97"><span class="nav-text">8. 添加计算列</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-%E7%AE%A1%E7%90%86%E6%93%8D%E4%BD%9C"><span class="nav-text">9. 管理操作</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#9-1-%E8%AE%BE%E7%BD%AE%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81"><span class="nav-text">9.1. 设置用户密码</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-2-%E5%88%9B%E5%BB%BA%E7%94%A8%E6%88%B7"><span class="nav-text">9.2. 创建用户</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#9-3-%E8%B5%8B%E4%BA%88%E7%94%A8%E6%88%B7%E6%9D%83%E9%99%90"><span class="nav-text">9.3. 赋予用户权限</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-mysql%E6%9C%AC%E8%BA%AB%E7%9A%84%E5%91%BD%E4%BB%A4"><span class="nav-text">10. mysql本身的命令</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%9B%9B%E3%80%81%E6%85%A2%E6%9F%A5%E8%AF%A2"><span class="nav-text">四、慢查询</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E9%85%8D%E7%BD%AE"><span class="nav-text">1. 配置</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E6%9F%A5%E7%9C%8B%E5%BD%93%E5%89%8D%E9%85%8D%E7%BD%AE"><span class="nav-text">1.1. 查看当前配置</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#1-2-%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="nav-text">1.2. 配置文件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97%E8%A7%A3%E8%AF%BB"><span class="nav-text">2. 慢查询日志解读</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-%E5%88%86%E6%9E%90sql%E8%AF%AD%E5%8F%A5"><span class="nav-text">3. 分析sql语句</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BA%94%E3%80%81%E6%80%A7%E8%83%BD%E5%92%8C%E9%85%8D%E7%BD%AE%E8%B0%83%E4%BC%98"><span class="nav-text">五、性能和配置调优</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-explain-%E5%88%86%E6%9E%90sql%E8%AF%AD%E5%8F%A5"><span class="nav-text">1. explain 分析sql语句</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#1-1-%E5%90%84%E5%AD%97%E6%AE%B5%E5%88%86%E6%9E%90"><span class="nav-text">1.1. 各字段分析</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#1-type-%E8%AE%BF%E9%97%AE%E7%B1%BB%E5%9E%8B"><span class="nav-text">1) type 访问类型</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#2-Extra-%E6%89%A7%E8%A1%8C%E6%83%85%E5%86%B5%E6%8F%8F%E8%BF%B0%E5%92%8C%E8%AF%B4%E6%98%8E"><span class="nav-text">2) Extra 执行情况描述和说明</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E6%AD%BB%E9%94%81"><span class="nav-text">2. 死锁</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%85%AD%E3%80%81%E6%94%BB%E9%98%B2"><span class="nav-text">六、攻防</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E6%97%A0%E5%AF%86%E7%A0%81%E7%99%BB%E9%99%86%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">1. 无密码登陆数据库</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-%E6%9F%A5%E7%9C%8B%E5%85%B6%E4%BB%96%E7%94%A8%E6%88%B7%E5%AF%86%E7%A0%81"><span class="nav-text">2. 查看其他用户密码</span></a></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%B0%8F%E6%8A%80%E5%B7%A7%E5%92%8C%E8%B8%A9%E5%9D%91%E8%AE%B0"><span class="nav-text">小技巧和踩坑记</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#1-%E8%A1%A8%E6%83%85%E7%AC%A6%E5%8F%B7%E5%AF%BC%E8%87%B4%E6%97%A0%E6%B3%95%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-text">1. 表情符号导致无法插入数据库</span></a></li></ol></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="王钰博" src="/images/12.jpg"><p class="site-author-name" itemprop="name">王钰博</p><div class="site-description" itemprop="description">个人博客</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">122</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">22</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">14</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/Githubwyb" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;Githubwyb" rel="noopener" target="_blank"><i class="fa fa-fw fa-github"></i>GitHub</a> </span><span class="links-of-author-item"><a href="mailto:1061322005@qq.com" title="E-Mail → mailto:1061322005@qq.com" rel="noopener" target="_blank"><i class="fa fa-fw fa-envelope"></i>E-Mail</a></span></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-fw fa-link"></i> 友情链接</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="https://githubwyb.github.io/bookPages/" title="https:&#x2F;&#x2F;githubwyb.github.io&#x2F;bookPages&#x2F;">markdown books</a></li></ul></div></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="beian"><a href="http://www.beian.miit.gov.cn/" rel="noopener" target="_blank">豫ICP备16023189号 </a><img src="/images/beian.png" style="display:inline-block"></div><div class="copyright">&copy; <span itemprop="copyrightYear">2024</span> <span class="with-love"><i class="fa fa-user"></i> </span><span class="author" itemprop="copyrightHolder">王钰博</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-area-chart"></i> </span><span title="站点总字数">919k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span title="站点阅读时长">13:56</span></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动</div><div class="addthis_inline_share_toolbox"><script src="//s7.addthis.com/js/300/addthis_widget.js#pubid=ra-5e1986d4e4e2d132" async></script></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/medium-zoom.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/bookmark.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(t,s)}()</script><script src="/js/local-search.js"></script><script>document.querySelectorAll(".pdfobject-container").forEach(e=>{let t=e.dataset.target,a="#"+Object.entries({navpanes:0,toolbar:0,statusbar:0,pagemode:"thumbs",view:"FitH"}).map(([e,t])=>`${e}=${encodeURIComponent(t)}`).join("&"),i=`/lib/pdf/web/viewer.html?file=${encodeURIComponent(t)}${a}`;NexT.utils.supportsPDFs()?e.innerHTML=`<embed class="pdfobject" src="${t+a}" type="application/pdf" style="height: ${e.dataset.height};">`:e.innerHTML=`<iframe src="${i}" style="height: ${e.dataset.height};" frameborder="0"></iframe>`})</script><script>"undefined"==typeof MathJax?(window.MathJax={loader:{source:{"[tex]/amsCd":"[tex]/amscd","[tex]/AMScd":"[tex]/amscd"}},tex:{inlineMath:{"[+]":[["$","$"]]},tags:"ams"},options:{renderActions:{findScript:[10,e=>{document.querySelectorAll('script[type^="math/tex"]').forEach(t=>{const a=!!t.type.match(/; *mode=display/),n=new e.options.MathItem(t.textContent,e.inputJax[0],a),d=document.createTextNode("");t.parentNode.replaceChild(d,t),n.start={node:d,delim:"",n:0},n.end={node:d,delim:"",n:0},e.math.push(n)})},"",!1],insertedScript:[200,()=>{document.querySelectorAll("mjx-container").forEach(e=>{let t=e.parentNode;"li"===t.nodeName.toLowerCase()&&t.parentNode.classList.add("has-jax")})},"",!1]}}},function(){var e=document.createElement("script");e.src="/lib/mathjax/tex-mml-chtml.js",e.defer=!0,document.head.appendChild(e)}()):(MathJax.startup.document.state(0),MathJax.texReset(),MathJax.typeset())</script><script>NexT.utils.loadComments(document.querySelector("#valine-comments"),()=>{NexT.utils.getScript("//unpkg.com/valine/dist/Valine.min.js",()=>{var e=["nick","mail","link"],a="nick,mail";a=a.split(",").filter(a=>e.includes(a)),new Valine({el:"#valine-comments",verify:!1,notify:!1,appId:"qmLbUHV1HOr841BOYkl84riu-gzGzoHsz",appKey:"j4fgTcf1yHRDD5X3HUH5EH95",placeholder:"^_^ happy everyday!",avatar:"wavatar",meta:a,pageSize:"10",visitor:!1,lang:"zh-cn",path:location.pathname,recordIP:!1,serverURLs:""})},window.Valine)})</script><script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"log":true,"model":{"jsonPath":"/live2dw/assets/shizuku.model.json"},"bottom":-30,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body><script type="text/javascript" src="/lib/jquery-3.4.1.min.js"></script><script type="text/javascript" src="/js/src/love.js"></script></html>